---
title: '[Pandas] 02. DataFrame(test)'
date: 22-12-19 20:11:11 +0800
categories: ['Python', 'Pandas']
tags: [python, pandas]     # TAG names should always be lowercase
---

<b style='font-size:2em'>DataFrame(데이터프레임)</b>

# DataFrame 개요
- <b>표(table-행렬)</b>를 다루는 Pandas의 타입.
    - Database의 Table이나 Excel의 표와 동일한 역할을 한다.
- 분석할 데이터를 가지는 판다스의 가장 핵심적인 클래스이다.
- <b>행(row)와 열(column)</b>으로 구성되 있다.
- 각 행과 각 열은 식별자를 가지며 Series와 같이 두가지 종류가 있다.
    - **순번**
        - 양수, 음수 index 두가지를 가진다.
        - 컬럼도 내부적으로는 순번으고 관리되지만 우리가 조회할 때 사용할 수는 없다.
    - **이름**
        - 명시적으로 지정한 행과 열의 이름을 말한다.
        - 행의 이름은 **index name**이라고 하고 열의 이름은 **column name**이라고 한다.
        - index name과 column name은 **중복될 수 있다.**
        - 명시적으로 지정하지 않으면 양수 순번이 index, column 이름으로 설정된다.
- 하나의 행과 하나의 열은 Series로 구성된다.
- DataFrame 객체는 직접 데이터를 넣어 생성하거나 데이터 셋을 파일(csv, 엑셀, DB 등)로 부터 읽어와 생성한다.

# DataFrame 생성
##  직접 생성
- `pd.DataFrame(data [, index=None, columns=None])`
    - data 
        - DataFrame을 구성할 값을 설정
            - Series, List, ndarray를 담은 2차원 배열
            - 열이름을 key로 컬럼의 값 value로 하는 dictionary(사전)
    - index
        - index명으로 사용할 값 배열로 설정
    - columns
        - 컬럼명으로 사용할 값 배열로 설정


```python
import numpy as np
import pandas as pd
```


```python
# 딕셔너리를 이용해 생성.
# key: 컬럼명, value: 그 컬럼의 값들을 1차원 자료구조로 설정.
# value의 리스트 크기는 같아야 한다.
dic = {
    'id':['id-1', 'id-2', 'id-3', 'id-4', 'id-5'],
    'korean':[100, 50, 70, 60, 90],
    'english':[90, 80, 100, 60, 40]
}
grade = pd.DataFrame(dic)
print(grade)
grade
```

         id  korean  english
    0  id-1     100       90
    1  id-2      50       80
    2  id-3      70      100
    3  id-4      60       60
    4  id-5      90       40
    




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>korean</th>
      <th>english</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>id-1</td>
      <td>100</td>
      <td>90</td>
    </tr>
    <tr>
      <th>1</th>
      <td>id-2</td>
      <td>50</td>
      <td>80</td>
    </tr>
    <tr>
      <th>2</th>
      <td>id-3</td>
      <td>70</td>
      <td>100</td>
    </tr>
    <tr>
      <th>3</th>
      <td>id-4</td>
      <td>60</td>
      <td>60</td>
    </tr>
    <tr>
      <th>4</th>
      <td>id-5</td>
      <td>90</td>
      <td>40</td>
    </tr>
  </tbody>
</table>
</div>




```python
# 2차원 자료구조를 이용해서 생성
np.random.seed(0)  # 항상 실행하면 언제나 동일한 난수가 발생 괄호안에 넣는 숫자가 달라지면 값도 달라짐
data = np.random.randint(10, size=(5,3)) # 0 ~ 10 - 1 사이의 난수로 5행, 3열의 행렬 생성
# data
# data_df = pd.DataFrame(data, columns=['국어', '수학', '영어'])
data_df = pd.DataFrame(data, columns=['국어', '수학', '영어'], index=['A', 'B', 'C', 'D', 'F'])
data_df
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>국어</th>
      <th>수학</th>
      <th>영어</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>A</th>
      <td>5</td>
      <td>0</td>
      <td>3</td>
    </tr>
    <tr>
      <th>B</th>
      <td>3</td>
      <td>7</td>
      <td>9</td>
    </tr>
    <tr>
      <th>C</th>
      <td>3</td>
      <td>5</td>
      <td>2</td>
    </tr>
    <tr>
      <th>D</th>
      <td>4</td>
      <td>7</td>
      <td>6</td>
    </tr>
    <tr>
      <th>F</th>
      <td>8</td>
      <td>8</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div>



## DataFrame의 객체를 파일에 저장

- DataFrame객체는 다양한 형식의 파일로 저장할 수 있다.
- 기본구문
    - **`DataFrame객체.to_파일타입()`**

### CSV 파일로 저장
- `DataFrame객체.to_csv(파일경로,sep=',', index=True, header=True, encoding)`
    - 텍스트 파일로 저장
    - 파일경로: 저장할 파일경로(경로/파일명)
    - sep : 데이터 구분자
    - index, header: 인덱스/헤더 저장 여부 -> 명시적으로 저장하지 않는 한 csv파일에서 인덱스와 헤더를 확인 할 수 없다
    - encoding: 기본-utf-8


```python
grade.to_csv?
```


```python
import os
# dataframe을 저장할 디렉토리 생성
os.makedirs('saved_data', exist_ok=True)
```


```python
grade.to_csv('saved_data/grade1.csv')
```


```python
grade.to_csv('saved_data/grade2.csv', index=False)  # index 이름은 저장안함.
```


```python
grade.to_csv('saved_data/grade3.csv', index=False, header=False)  # index와 column 이름 저장안함
```


```python
grade.to_csv('saved_data/grade4.csv', index=False, encoding='cp949')
```


```python
grade.to_csv('saved_data/grade5.csv', sep='\t', index=False)  # 값 구분자로 tab 사용
```

### 엑셀로 저장
- `DataFrame객체.to_excel(파일경로, index=True, header=True)`


```python
grade.to_excel('saved_data/grade1.xlsx') # ModuleNotFoundError 발생시 마지막 줄에 추천 모듈이 나온다.
```


    ---------------------------------------------------------------------------

    ModuleNotFoundError                       Traceback (most recent call last)

    Cell In[27], line 1
    ----> 1 grade.to_excel('saved_data/grade1.xlsx')
    

    File ~\anaconda3\envs\ml\lib\site-packages\pandas\util\_decorators.py:211, in deprecate_kwarg.<locals>._deprecate_kwarg.<locals>.wrapper(*args, **kwargs)
        209     else:
        210         kwargs[new_arg_name] = new_arg_value
    --> 211 return func(*args, **kwargs)
    

    File ~\anaconda3\envs\ml\lib\site-packages\pandas\util\_decorators.py:211, in deprecate_kwarg.<locals>._deprecate_kwarg.<locals>.wrapper(*args, **kwargs)
        209     else:
        210         kwargs[new_arg_name] = new_arg_value
    --> 211 return func(*args, **kwargs)
    

    File ~\anaconda3\envs\ml\lib\site-packages\pandas\core\generic.py:2374, in NDFrame.to_excel(self, excel_writer, sheet_name, na_rep, float_format, columns, header, index, index_label, startrow, startcol, engine, merge_cells, encoding, inf_rep, verbose, freeze_panes, storage_options)
       2361 from pandas.io.formats.excel import ExcelFormatter
       2363 formatter = ExcelFormatter(
       2364     df,
       2365     na_rep=na_rep,
       (...)
       2372     inf_rep=inf_rep,
       2373 )
    -> 2374 formatter.write(
       2375     excel_writer,
       2376     sheet_name=sheet_name,
       2377     startrow=startrow,
       2378     startcol=startcol,
       2379     freeze_panes=freeze_panes,
       2380     engine=engine,
       2381     storage_options=storage_options,
       2382 )
    

    File ~\anaconda3\envs\ml\lib\site-packages\pandas\io\formats\excel.py:918, in ExcelFormatter.write(self, writer, sheet_name, startrow, startcol, freeze_panes, engine, storage_options)
        914     need_save = False
        915 else:
        916     # error: Cannot instantiate abstract class 'ExcelWriter' with abstract
        917     # attributes 'engine', 'save', 'supported_extensions' and 'write_cells'
    --> 918     writer = ExcelWriter(  # type: ignore[abstract]
        919         writer, engine=engine, storage_options=storage_options
        920     )
        921     need_save = True
        923 try:
    

    File ~\anaconda3\envs\ml\lib\site-packages\pandas\io\excel\_openpyxl.py:56, in OpenpyxlWriter.__init__(self, path, engine, date_format, datetime_format, mode, storage_options, if_sheet_exists, engine_kwargs, **kwargs)
         43 def __init__(
         44     self,
         45     path: FilePath | WriteExcelBuffer | ExcelWriter,
       (...)
         54 ) -> None:
         55     # Use the openpyxl module as the Excel writer.
    ---> 56     from openpyxl.workbook import Workbook
         58     engine_kwargs = combine_kwargs(engine_kwargs, kwargs)
         60     super().__init__(
         61         path,
         62         mode=mode,
       (...)
         65         engine_kwargs=engine_kwargs,
         66     )
    

    ModuleNotFoundError: No module named 'openpyxl'


- `!터미널 명령어 실행`


```python
# 엑셀 xlsx 확장자 쓰고 읽을 때 사용하는 모듈
!pip install openpyxl
```

    Collecting openpyxl
      Downloading openpyxl-3.0.10-py2.py3-none-any.whl (242 kB)
         -------------------------------------- 242.1/242.1 kB 7.5 MB/s eta 0:00:00
    Collecting et-xmlfile
      Downloading et_xmlfile-1.1.0-py3-none-any.whl (4.7 kB)
    Installing collected packages: et-xmlfile, openpyxl
    Successfully installed et-xmlfile-1.1.0 openpyxl-3.0.10
    


```python
grade.to_excel('saved_data/grade1.xlsx')
```


```python
grade.to_excel('saved_data/grade2.xls', index=False)
```

    C:\Users\jeonj\AppData\Local\Temp\ipykernel_3012\4113661981.py:1: FutureWarning: As the xlwt package is no longer maintained, the xlwt engine will be removed in a future version of pandas. This is the only engine in pandas that supports writing in the xls format. Install openpyxl and write to an xlsx file instead. You can set the option io.excel.xls.writer to 'xlwt' to silence this warning. While this option is deprecated and will also raise a warning, it can be globally set and the warning suppressed.
      grade.to_excel('saved_data/grade2.xls', index=False)
    


    ---------------------------------------------------------------------------

    ModuleNotFoundError                       Traceback (most recent call last)

    Cell In[31], line 1
    ----> 1 grade.to_excel('saved_data/grade2.xls', index=False)
    

    File ~\anaconda3\envs\ml\lib\site-packages\pandas\util\_decorators.py:211, in deprecate_kwarg.<locals>._deprecate_kwarg.<locals>.wrapper(*args, **kwargs)
        209     else:
        210         kwargs[new_arg_name] = new_arg_value
    --> 211 return func(*args, **kwargs)
    

    File ~\anaconda3\envs\ml\lib\site-packages\pandas\util\_decorators.py:211, in deprecate_kwarg.<locals>._deprecate_kwarg.<locals>.wrapper(*args, **kwargs)
        209     else:
        210         kwargs[new_arg_name] = new_arg_value
    --> 211 return func(*args, **kwargs)
    

    File ~\anaconda3\envs\ml\lib\site-packages\pandas\core\generic.py:2374, in NDFrame.to_excel(self, excel_writer, sheet_name, na_rep, float_format, columns, header, index, index_label, startrow, startcol, engine, merge_cells, encoding, inf_rep, verbose, freeze_panes, storage_options)
       2361 from pandas.io.formats.excel import ExcelFormatter
       2363 formatter = ExcelFormatter(
       2364     df,
       2365     na_rep=na_rep,
       (...)
       2372     inf_rep=inf_rep,
       2373 )
    -> 2374 formatter.write(
       2375     excel_writer,
       2376     sheet_name=sheet_name,
       2377     startrow=startrow,
       2378     startcol=startcol,
       2379     freeze_panes=freeze_panes,
       2380     engine=engine,
       2381     storage_options=storage_options,
       2382 )
    

    File ~\anaconda3\envs\ml\lib\site-packages\pandas\io\formats\excel.py:918, in ExcelFormatter.write(self, writer, sheet_name, startrow, startcol, freeze_panes, engine, storage_options)
        914     need_save = False
        915 else:
        916     # error: Cannot instantiate abstract class 'ExcelWriter' with abstract
        917     # attributes 'engine', 'save', 'supported_extensions' and 'write_cells'
    --> 918     writer = ExcelWriter(  # type: ignore[abstract]
        919         writer, engine=engine, storage_options=storage_options
        920     )
        921     need_save = True
        923 try:
    

    File ~\anaconda3\envs\ml\lib\site-packages\pandas\io\excel\_xlwt.py:48, in XlwtWriter.__init__(self, path, engine, date_format, datetime_format, encoding, mode, storage_options, if_sheet_exists, engine_kwargs, **kwargs)
         34 def __init__(
         35     self,
         36     path: FilePath | WriteExcelBuffer | ExcelWriter,
       (...)
         46 ) -> None:
         47     # Use the xlwt module as the Excel writer.
    ---> 48     import xlwt
         50     engine_kwargs = combine_kwargs(engine_kwargs, kwargs)
         52     if mode == "a":
    

    ModuleNotFoundError: No module named 'xlwt'



```python
# 엑셀 xls 확장자 쓰고 읽을 때 사용하는 모듈: xlwt-> 쓰는 것 xlrd -> 읽는 것
!pip install xlwt xlrd
```

    Requirement already satisfied: xlwt in c:\users\jeonj\anaconda3\envs\ml\lib\site-packages (1.3.0)
    Collecting xlrd
      Downloading xlrd-2.0.1-py2.py3-none-any.whl (96 kB)
         ---------------------------------------- 96.5/96.5 kB 5.4 MB/s eta 0:00:00
    Installing collected packages: xlrd
    Successfully installed xlrd-2.0.1
    


```python
grade.to_excel('saved_data/grade2.xls', index=False)  # 엑셀 옛날 버전
```

    C:\Users\jeonj\AppData\Local\Temp\ipykernel_3012\4113661981.py:1: FutureWarning: As the xlwt package is no longer maintained, the xlwt engine will be removed in a future version of pandas. This is the only engine in pandas that supports writing in the xls format. Install openpyxl and write to an xlsx file instead. You can set the option io.excel.xls.writer to 'xlwt' to silence this warning. While this option is deprecated and will also raise a warning, it can be globally set and the warning suppressed.
      grade.to_excel('saved_data/grade2.xls', index=False)
    

### 기타 형식


```python
# pickle => binary(bytes)로 저장
grade.to_pickle('saved_data/grade.pkl')
```


```python
# html의 테이블로 저장
grade.to_html('saved_data/grade.html', index=False)
```


## 파일로 부터 데이터셋을 읽어와 생성하기

### csv 파일 등 텍스트 파일로 부터 읽어와 생성
- `pd.read_csv(파일경로, sep=',', header, index_col, na_values, encoding)`
    - **파일경로** 
        - 읽어올 파일의 경로
    - **sep**=","
        - 데이터 구분자. 
        - 기본값: 쉼표
    - **header**=정수
        - 열이름(컬럼이름)으로 사용할 행 지정
        - 기본값: 첫번째 행
        - None을 설정하면 Header는 없다는 것으로 파일의 첫번째 행부터 값으로 사용하고 컬럼명은 0부터 자동증가하는 값을 붙인다.
    - **index_col**=정수,컬럼명
        - index 명으로 사용할 열이름(문자열)이나 열의 순번(정수)을 지정.
        - 생략시 0부터 자동증가하는 값을 붙인다.
    - **na_values**
        - 읽어올 데이터셋의 값 중 결측치로 처리할 문자열 지정. 


```python
# grade1.csv (index, header 모두 저장된 파일)
grade1 = pd.read_csv('saved_data/grade1.csv')
grade1
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Unnamed: 0</th>
      <th>id</th>
      <th>korean</th>
      <th>english</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>id-1</td>
      <td>100</td>
      <td>90</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>id-2</td>
      <td>50</td>
      <td>80</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>id-3</td>
      <td>70</td>
      <td>100</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>id-4</td>
      <td>60</td>
      <td>60</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
      <td>id-5</td>
      <td>90</td>
      <td>40</td>
    </tr>
  </tbody>
</table>
</div>




```python
grade1_2 = pd.read_csv('saved_data/grade1.csv', index_col=0)
grade1_2
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>korean</th>
      <th>english</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>id-1</td>
      <td>100</td>
      <td>90</td>
    </tr>
    <tr>
      <th>1</th>
      <td>id-2</td>
      <td>50</td>
      <td>80</td>
    </tr>
    <tr>
      <th>2</th>
      <td>id-3</td>
      <td>70</td>
      <td>100</td>
    </tr>
    <tr>
      <th>3</th>
      <td>id-4</td>
      <td>60</td>
      <td>60</td>
    </tr>
    <tr>
      <th>4</th>
      <td>id-5</td>
      <td>90</td>
      <td>40</td>
    </tr>
  </tbody>
</table>
</div>




```python
# index가 없이 저장한 csv파일
grade2 = pd.read_csv('saved_data/grade2.csv', index_col='id')  # id의 경우에는 모든 값이 다 다르기 때문에 보통 다른 값을 식별하기 위해 쓴다 -> index로 빠진다.
grade2
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>korean</th>
      <th>english</th>
    </tr>
    <tr>
      <th>id</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>id-1</th>
      <td>100</td>
      <td>90</td>
    </tr>
    <tr>
      <th>id-2</th>
      <td>50</td>
      <td>80</td>
    </tr>
    <tr>
      <th>id-3</th>
      <td>70</td>
      <td>100</td>
    </tr>
    <tr>
      <th>id-4</th>
      <td>60</td>
      <td>60</td>
    </tr>
    <tr>
      <th>id-5</th>
      <td>90</td>
      <td>40</td>
    </tr>
  </tbody>
</table>
</div>




```python
# index 명, column 명 둘 다 저장이 안된 파일
# grade3 = pd.read_csv('saved_data/grade3.csv', header=None)
grade3 = pd.read_csv('saved_data/grade3.csv', header=None, names=['아이디', '국어', '영어'])
grade3
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>국어</th>
      <th>영어</th>
    </tr>
    <tr>
      <th>아이디</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>id-1</th>
      <td>100</td>
      <td>90</td>
    </tr>
    <tr>
      <th>id-2</th>
      <td>50</td>
      <td>80</td>
    </tr>
    <tr>
      <th>id-3</th>
      <td>70</td>
      <td>100</td>
    </tr>
    <tr>
      <th>id-4</th>
      <td>60</td>
      <td>60</td>
    </tr>
    <tr>
      <th>id-5</th>
      <td>90</td>
      <td>40</td>
    </tr>
  </tbody>
</table>
</div>




```python
# sep='\t'로 저장한 파일
grade5 = pd.read_csv('saved_data/grade5.csv', sep='\t') # default 구분자: ,
grade5
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>korean</th>
      <th>english</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>id-1</td>
      <td>100</td>
      <td>90</td>
    </tr>
    <tr>
      <th>1</th>
      <td>id-2</td>
      <td>50</td>
      <td>80</td>
    </tr>
    <tr>
      <th>2</th>
      <td>id-3</td>
      <td>70</td>
      <td>100</td>
    </tr>
    <tr>
      <th>3</th>
      <td>id-4</td>
      <td>60</td>
      <td>60</td>
    </tr>
    <tr>
      <th>4</th>
      <td>id-5</td>
      <td>90</td>
      <td>40</td>
    </tr>
  </tbody>
</table>
</div>




```python
# 결측치가 저장된 파일
grade_na = pd.read_csv('saved_data/grade_na.csv')
grade_na
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>korean</th>
      <th>english</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>id-1</td>
      <td>100.0</td>
      <td>90.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>id-2</td>
      <td>50.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>id-3</td>
      <td>NaN</td>
      <td>100.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>id-4</td>
      <td>60.0</td>
      <td>60.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>id-5</td>
      <td>90.0</td>
      <td>40.0</td>
    </tr>
  </tbody>
</table>
</div>




```python
grade_na.isnull()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>korean</th>
      <th>english</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>1</th>
      <td>False</td>
      <td>False</td>
      <td>True</td>
    </tr>
    <tr>
      <th>2</th>
      <td>False</td>
      <td>True</td>
      <td>False</td>
    </tr>
    <tr>
      <th>3</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>4</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
  </tbody>
</table>
</div>




```python
# 결측치가 ? 형식으로 저장된 파일
grade_qu = pd.read_csv('saved_data/grade_qu.csv', na_values=("?"))
grade_qu
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>korean</th>
      <th>english</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>id-1</td>
      <td>100.0</td>
      <td>90.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>id-2</td>
      <td>50.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>id-3</td>
      <td>NaN</td>
      <td>100.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>id-4</td>
      <td>60.0</td>
      <td>60.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>id-5</td>
      <td>90.0</td>
      <td>40.0</td>
    </tr>
  </tbody>
</table>
</div>



- default None 값
```
na_values : scalar, str, list-like, or dict, optional
    Additional strings to recognize as NA/NaN. If dict passed, specific
    per-column NA values.  By default the following values are interpreted as
    NaN: '', '#N/A', '#N/A N/A', '#NA', '-1.#IND', '-1.#QNAN', '-NaN', '-nan',
    '1.#IND', '1.#QNAN', '<NA>', 'N/A', 'NA', 'NULL', 'NaN', 'n/a',
    'nan', 'null'.
```


```python
grade_qu.isnull()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>korean</th>
      <th>english</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>1</th>
      <td>False</td>
      <td>False</td>
      <td>True</td>
    </tr>
    <tr>
      <th>2</th>
      <td>False</td>
      <td>True</td>
      <td>False</td>
    </tr>
    <tr>
      <th>3</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>4</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
  </tbody>
</table>
</div>




```python
pd.read_csv?
```

### 엑셀파일 읽기


```python
grade_xlsx = pd.read_excel('saved_data/grade1.xlsx', index_col=0)
grade_xlsx
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>korean</th>
      <th>english</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>id-1</td>
      <td>100</td>
      <td>90</td>
    </tr>
    <tr>
      <th>1</th>
      <td>id-2</td>
      <td>50</td>
      <td>80</td>
    </tr>
    <tr>
      <th>2</th>
      <td>id-3</td>
      <td>70</td>
      <td>100</td>
    </tr>
    <tr>
      <th>3</th>
      <td>id-4</td>
      <td>60</td>
      <td>60</td>
    </tr>
    <tr>
      <th>4</th>
      <td>id-5</td>
      <td>90</td>
      <td>40</td>
    </tr>
  </tbody>
</table>
</div>




```python
grade_xls = pd.read_excel('saved_data/grade1.xls', index_col=0)
grade_xls
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>korean</th>
      <th>english</th>
    </tr>
    <tr>
      <th>id</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>id-1</th>
      <td>100</td>
      <td>90</td>
    </tr>
    <tr>
      <th>id-2</th>
      <td>50</td>
      <td>80</td>
    </tr>
    <tr>
      <th>id-3</th>
      <td>70</td>
      <td>100</td>
    </tr>
    <tr>
      <th>id-4</th>
      <td>60</td>
      <td>60</td>
    </tr>
    <tr>
      <th>id-5</th>
      <td>90</td>
      <td>40</td>
    </tr>
  </tbody>
</table>
</div>



### 기타


```python
grade_pkl = pd.read_pickle('saved_data/grade.pkl')
grade_pkl
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>korean</th>
      <th>english</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>id-1</td>
      <td>100</td>
      <td>90</td>
    </tr>
    <tr>
      <th>1</th>
      <td>id-2</td>
      <td>50</td>
      <td>80</td>
    </tr>
    <tr>
      <th>2</th>
      <td>id-3</td>
      <td>70</td>
      <td>100</td>
    </tr>
    <tr>
      <th>3</th>
      <td>id-4</td>
      <td>60</td>
      <td>60</td>
    </tr>
    <tr>
      <th>4</th>
      <td>id-5</td>
      <td>90</td>
      <td>40</td>
    </tr>
  </tbody>
</table>
</div>




```python
grade_html = pd.read_html('saved_data/grade.html')
print(type(grade_html))  # html파일 안에 있는 모든 table을 읽어서 list로 반환.
grade_html[0]
```

    <class 'list'>
    




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>korean</th>
      <th>english</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>id-1</td>
      <td>100</td>
      <td>90</td>
    </tr>
    <tr>
      <th>1</th>
      <td>id-2</td>
      <td>50</td>
      <td>80</td>
    </tr>
    <tr>
      <th>2</th>
      <td>id-3</td>
      <td>70</td>
      <td>100</td>
    </tr>
    <tr>
      <th>3</th>
      <td>id-4</td>
      <td>60</td>
      <td>60</td>
    </tr>
    <tr>
      <th>4</th>
      <td>id-5</td>
      <td>90</td>
      <td>40</td>
    </tr>
  </tbody>
</table>
</div>




```python
url = 'https://ko.wikipedia.org/wiki/FIFA_%EC%9B%94%EB%93%9C%EC%BB%B5'
world_cup = pd.read_html(url)
print(len(world_cup)) # html안에 있는 <table>태그를 모두 찾아서 반환
world_cup[0]
```

    12
    




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>FIFA 월드컵</th>
      <th>FIFA 월드컵.1</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>종목</td>
      <td>축구</td>
    </tr>
    <tr>
      <th>2</th>
      <td>국가</td>
      <td>FIFA 가맹국들</td>
    </tr>
    <tr>
      <th>3</th>
      <td>주최 기관</td>
      <td>FIFA</td>
    </tr>
    <tr>
      <th>4</th>
      <td>선수단</td>
      <td>203개국 (2014년 예선) 48개국 (본선)</td>
    </tr>
    <tr>
      <th>5</th>
      <td>역사</td>
      <td>역사</td>
    </tr>
    <tr>
      <th>6</th>
      <td>설립</td>
      <td>1930년</td>
    </tr>
    <tr>
      <th>7</th>
      <td>최다 우승</td>
      <td>브라질 (5회)</td>
    </tr>
    <tr>
      <th>8</th>
      <td>최근 우승</td>
      <td>아르헨티나 (2022년)</td>
    </tr>
  </tbody>
</table>
</div>




```python
world_cup[1]
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>대륙별 지역</th>
      <th>출전국 수</th>
      <th>본선 진출국 수</th>
      <th>본선 진출율</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>아프리카(CAF)</td>
      <td>55</td>
      <td>5</td>
      <td>9%</td>
    </tr>
    <tr>
      <th>1</th>
      <td>아시아(AFC)</td>
      <td>46</td>
      <td>4.5 1</td>
      <td>9.7%</td>
    </tr>
    <tr>
      <th>2</th>
      <td>오세아니아(OFC)</td>
      <td>16</td>
      <td>0.5 1</td>
      <td>3%</td>
    </tr>
    <tr>
      <th>3</th>
      <td>유럽(UEFA)</td>
      <td>53</td>
      <td>13</td>
      <td>24%</td>
    </tr>
    <tr>
      <th>4</th>
      <td>북중미카리브(CONCACAF)</td>
      <td>40</td>
      <td>3.5 1</td>
      <td>8.7%</td>
    </tr>
    <tr>
      <th>5</th>
      <td>남아메리카(CONMEBOL)</td>
      <td>10</td>
      <td>4.5 1</td>
      <td>45%</td>
    </tr>
    <tr>
      <th>6</th>
      <td>개최국(대륙을 불문하고 선정됨.)</td>
      <td>1</td>
      <td>1</td>
      <td>100%</td>
    </tr>
    <tr>
      <th>7</th>
      <td>총합</td>
      <td>220</td>
      <td>32</td>
      <td>14.5%</td>
    </tr>
  </tbody>
</table>
</div>



<b style='font-size:2.2em'>TODO</b>


```python
#1. data/movie.csv 를 읽어서 변수 movie에 할당.
import pandas as pd
movie = pd.read_csv("data/movie.csv")
movie.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>color</th>
      <th>director_name</th>
      <th>num_critic_for_reviews</th>
      <th>duration</th>
      <th>director_facebook_likes</th>
      <th>actor_3_facebook_likes</th>
      <th>actor_2_name</th>
      <th>actor_1_facebook_likes</th>
      <th>gross</th>
      <th>genres</th>
      <th>...</th>
      <th>num_user_for_reviews</th>
      <th>language</th>
      <th>country</th>
      <th>content_rating</th>
      <th>budget</th>
      <th>title_year</th>
      <th>actor_2_facebook_likes</th>
      <th>imdb_score</th>
      <th>aspect_ratio</th>
      <th>movie_facebook_likes</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Color</td>
      <td>James Cameron</td>
      <td>723.0</td>
      <td>178.0</td>
      <td>0.0</td>
      <td>855.0</td>
      <td>Joel David Moore</td>
      <td>1000.0</td>
      <td>760505847.0</td>
      <td>Action|Adventure|Fantasy|Sci-Fi</td>
      <td>...</td>
      <td>3054.0</td>
      <td>English</td>
      <td>USA</td>
      <td>PG-13</td>
      <td>237000000.0</td>
      <td>2009.0</td>
      <td>936.0</td>
      <td>7.9</td>
      <td>1.78</td>
      <td>33000</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Color</td>
      <td>Gore Verbinski</td>
      <td>302.0</td>
      <td>169.0</td>
      <td>563.0</td>
      <td>1000.0</td>
      <td>Orlando Bloom</td>
      <td>40000.0</td>
      <td>309404152.0</td>
      <td>Action|Adventure|Fantasy</td>
      <td>...</td>
      <td>1238.0</td>
      <td>English</td>
      <td>USA</td>
      <td>PG-13</td>
      <td>300000000.0</td>
      <td>2007.0</td>
      <td>5000.0</td>
      <td>7.1</td>
      <td>2.35</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Color</td>
      <td>Sam Mendes</td>
      <td>602.0</td>
      <td>148.0</td>
      <td>0.0</td>
      <td>161.0</td>
      <td>Rory Kinnear</td>
      <td>11000.0</td>
      <td>200074175.0</td>
      <td>Action|Adventure|Thriller</td>
      <td>...</td>
      <td>994.0</td>
      <td>English</td>
      <td>UK</td>
      <td>PG-13</td>
      <td>245000000.0</td>
      <td>2015.0</td>
      <td>393.0</td>
      <td>6.8</td>
      <td>2.35</td>
      <td>85000</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Color</td>
      <td>Christopher Nolan</td>
      <td>813.0</td>
      <td>164.0</td>
      <td>22000.0</td>
      <td>23000.0</td>
      <td>Christian Bale</td>
      <td>27000.0</td>
      <td>448130642.0</td>
      <td>Action|Thriller</td>
      <td>...</td>
      <td>2701.0</td>
      <td>English</td>
      <td>USA</td>
      <td>PG-13</td>
      <td>250000000.0</td>
      <td>2012.0</td>
      <td>23000.0</td>
      <td>8.5</td>
      <td>2.35</td>
      <td>164000</td>
    </tr>
    <tr>
      <th>4</th>
      <td>NaN</td>
      <td>Doug Walker</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>131.0</td>
      <td>NaN</td>
      <td>Rob Walker</td>
      <td>131.0</td>
      <td>NaN</td>
      <td>Documentary</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>12.0</td>
      <td>7.1</td>
      <td>NaN</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 28 columns</p>
</div>




```python
#2. 1의 데이터프레임을 csv 파일로 저장(파일명 : saved_data/movie_df.csv)
movie.to_csv("saved_data/movie_df.csv", index=False)
```


```python
#3. 1의 데이터프레임을 엑셀파일로 저장(파일명 : saved_data/movie_df.xlsx)
movie.to_excel("saved_data/movie_df.xlsx", index=False)
```


```python
#4. 3에서 저장한 movie_df1.xlsx 파일을 읽어서 m_df 변수에 할당
m_df = pd.read_excel("saved_data/movie_df.xlsx", index_col=0)
m_df.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>color</th>
      <th>director_name</th>
      <th>num_critic_for_reviews</th>
      <th>duration</th>
      <th>director_facebook_likes</th>
      <th>actor_3_facebook_likes</th>
      <th>actor_2_name</th>
      <th>actor_1_facebook_likes</th>
      <th>gross</th>
      <th>genres</th>
      <th>...</th>
      <th>num_user_for_reviews</th>
      <th>language</th>
      <th>country</th>
      <th>content_rating</th>
      <th>budget</th>
      <th>title_year</th>
      <th>actor_2_facebook_likes</th>
      <th>imdb_score</th>
      <th>aspect_ratio</th>
      <th>movie_facebook_likes</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Color</td>
      <td>James Cameron</td>
      <td>723.0</td>
      <td>178.0</td>
      <td>0.0</td>
      <td>855.0</td>
      <td>Joel David Moore</td>
      <td>1000.0</td>
      <td>760505847.0</td>
      <td>Action|Adventure|Fantasy|Sci-Fi</td>
      <td>...</td>
      <td>3054.0</td>
      <td>English</td>
      <td>USA</td>
      <td>PG-13</td>
      <td>237000000.0</td>
      <td>2009.0</td>
      <td>936.0</td>
      <td>7.9</td>
      <td>1.78</td>
      <td>33000</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Color</td>
      <td>Gore Verbinski</td>
      <td>302.0</td>
      <td>169.0</td>
      <td>563.0</td>
      <td>1000.0</td>
      <td>Orlando Bloom</td>
      <td>40000.0</td>
      <td>309404152.0</td>
      <td>Action|Adventure|Fantasy</td>
      <td>...</td>
      <td>1238.0</td>
      <td>English</td>
      <td>USA</td>
      <td>PG-13</td>
      <td>300000000.0</td>
      <td>2007.0</td>
      <td>5000.0</td>
      <td>7.1</td>
      <td>2.35</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Color</td>
      <td>Sam Mendes</td>
      <td>602.0</td>
      <td>148.0</td>
      <td>0.0</td>
      <td>161.0</td>
      <td>Rory Kinnear</td>
      <td>11000.0</td>
      <td>200074175.0</td>
      <td>Action|Adventure|Thriller</td>
      <td>...</td>
      <td>994.0</td>
      <td>English</td>
      <td>UK</td>
      <td>PG-13</td>
      <td>245000000.0</td>
      <td>2015.0</td>
      <td>393.0</td>
      <td>6.8</td>
      <td>2.35</td>
      <td>85000</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Color</td>
      <td>Christopher Nolan</td>
      <td>813.0</td>
      <td>164.0</td>
      <td>22000.0</td>
      <td>23000.0</td>
      <td>Christian Bale</td>
      <td>27000.0</td>
      <td>448130642.0</td>
      <td>Action|Thriller</td>
      <td>...</td>
      <td>2701.0</td>
      <td>English</td>
      <td>USA</td>
      <td>PG-13</td>
      <td>250000000.0</td>
      <td>2012.0</td>
      <td>23000.0</td>
      <td>8.5</td>
      <td>2.35</td>
      <td>164000</td>
    </tr>
    <tr>
      <th>4</th>
      <td>NaN</td>
      <td>Doug Walker</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>131.0</td>
      <td>NaN</td>
      <td>Rob Walker</td>
      <td>131.0</td>
      <td>NaN</td>
      <td>Documentary</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>12.0</td>
      <td>7.1</td>
      <td>NaN</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 28 columns</p>
</div>



# 주요 메소드, 속성 

![image.png](attachment:image.png)

![image.png](attachment:image.png)

## 데이터 프레임의 기본 정보 조회
- csv 파일 읽기
- shape
- info()
- head()
- tail()
- isnull().sum() 
    - 컬럼별 null 체크 (sum() 한번 더 하면 총개수)
- describe() : 숫자형-기술통계값, 범주형-총개수, 고유값들, 최빈값


```python
import pandas as pd
# csv 파일을 읽어서 DataFrame 생성
df = pd.read_csv('data/movie.csv')
df.shape # 튜플 (행수, 열수) => DataFrame의 행/열의 개수
```




    (4916, 28)




```python
df.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>color</th>
      <th>director_name</th>
      <th>num_critic_for_reviews</th>
      <th>duration</th>
      <th>director_facebook_likes</th>
      <th>actor_3_facebook_likes</th>
      <th>actor_2_name</th>
      <th>actor_1_facebook_likes</th>
      <th>gross</th>
      <th>genres</th>
      <th>...</th>
      <th>num_user_for_reviews</th>
      <th>language</th>
      <th>country</th>
      <th>content_rating</th>
      <th>budget</th>
      <th>title_year</th>
      <th>actor_2_facebook_likes</th>
      <th>imdb_score</th>
      <th>aspect_ratio</th>
      <th>movie_facebook_likes</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Color</td>
      <td>James Cameron</td>
      <td>723.0</td>
      <td>178.0</td>
      <td>0.0</td>
      <td>855.0</td>
      <td>Joel David Moore</td>
      <td>1000.0</td>
      <td>760505847.0</td>
      <td>Action|Adventure|Fantasy|Sci-Fi</td>
      <td>...</td>
      <td>3054.0</td>
      <td>English</td>
      <td>USA</td>
      <td>PG-13</td>
      <td>237000000.0</td>
      <td>2009.0</td>
      <td>936.0</td>
      <td>7.9</td>
      <td>1.78</td>
      <td>33000</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Color</td>
      <td>Gore Verbinski</td>
      <td>302.0</td>
      <td>169.0</td>
      <td>563.0</td>
      <td>1000.0</td>
      <td>Orlando Bloom</td>
      <td>40000.0</td>
      <td>309404152.0</td>
      <td>Action|Adventure|Fantasy</td>
      <td>...</td>
      <td>1238.0</td>
      <td>English</td>
      <td>USA</td>
      <td>PG-13</td>
      <td>300000000.0</td>
      <td>2007.0</td>
      <td>5000.0</td>
      <td>7.1</td>
      <td>2.35</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Color</td>
      <td>Sam Mendes</td>
      <td>602.0</td>
      <td>148.0</td>
      <td>0.0</td>
      <td>161.0</td>
      <td>Rory Kinnear</td>
      <td>11000.0</td>
      <td>200074175.0</td>
      <td>Action|Adventure|Thriller</td>
      <td>...</td>
      <td>994.0</td>
      <td>English</td>
      <td>UK</td>
      <td>PG-13</td>
      <td>245000000.0</td>
      <td>2015.0</td>
      <td>393.0</td>
      <td>6.8</td>
      <td>2.35</td>
      <td>85000</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Color</td>
      <td>Christopher Nolan</td>
      <td>813.0</td>
      <td>164.0</td>
      <td>22000.0</td>
      <td>23000.0</td>
      <td>Christian Bale</td>
      <td>27000.0</td>
      <td>448130642.0</td>
      <td>Action|Thriller</td>
      <td>...</td>
      <td>2701.0</td>
      <td>English</td>
      <td>USA</td>
      <td>PG-13</td>
      <td>250000000.0</td>
      <td>2012.0</td>
      <td>23000.0</td>
      <td>8.5</td>
      <td>2.35</td>
      <td>164000</td>
    </tr>
    <tr>
      <th>4</th>
      <td>NaN</td>
      <td>Doug Walker</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>131.0</td>
      <td>NaN</td>
      <td>Rob Walker</td>
      <td>131.0</td>
      <td>NaN</td>
      <td>Documentary</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>12.0</td>
      <td>7.1</td>
      <td>NaN</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 28 columns</p>
</div>




```python
# dataframe.head([행수]), tail([행수]) : 앞/뒤에 지정한 행수만큼만 확인, default:5행
# 데이터셋의 값들이 (열별) 구성을 확인. 칼럼값들이 어떻게 구성되있는 지를 데이터 딕셔너리와 비교해서 확인.
# 참고: 데이터 딕셔너리-데이터셋에 대한 설명서

df.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>color</th>
      <th>director_name</th>
      <th>num_critic_for_reviews</th>
      <th>duration</th>
      <th>director_facebook_likes</th>
      <th>actor_3_facebook_likes</th>
      <th>actor_2_name</th>
      <th>actor_1_facebook_likes</th>
      <th>gross</th>
      <th>genres</th>
      <th>...</th>
      <th>num_user_for_reviews</th>
      <th>language</th>
      <th>country</th>
      <th>content_rating</th>
      <th>budget</th>
      <th>title_year</th>
      <th>actor_2_facebook_likes</th>
      <th>imdb_score</th>
      <th>aspect_ratio</th>
      <th>movie_facebook_likes</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Color</td>
      <td>James Cameron</td>
      <td>723.0</td>
      <td>178.0</td>
      <td>0.0</td>
      <td>855.0</td>
      <td>Joel David Moore</td>
      <td>1000.0</td>
      <td>760505847.0</td>
      <td>Action|Adventure|Fantasy|Sci-Fi</td>
      <td>...</td>
      <td>3054.0</td>
      <td>English</td>
      <td>USA</td>
      <td>PG-13</td>
      <td>237000000.0</td>
      <td>2009.0</td>
      <td>936.0</td>
      <td>7.9</td>
      <td>1.78</td>
      <td>33000</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Color</td>
      <td>Gore Verbinski</td>
      <td>302.0</td>
      <td>169.0</td>
      <td>563.0</td>
      <td>1000.0</td>
      <td>Orlando Bloom</td>
      <td>40000.0</td>
      <td>309404152.0</td>
      <td>Action|Adventure|Fantasy</td>
      <td>...</td>
      <td>1238.0</td>
      <td>English</td>
      <td>USA</td>
      <td>PG-13</td>
      <td>300000000.0</td>
      <td>2007.0</td>
      <td>5000.0</td>
      <td>7.1</td>
      <td>2.35</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Color</td>
      <td>Sam Mendes</td>
      <td>602.0</td>
      <td>148.0</td>
      <td>0.0</td>
      <td>161.0</td>
      <td>Rory Kinnear</td>
      <td>11000.0</td>
      <td>200074175.0</td>
      <td>Action|Adventure|Thriller</td>
      <td>...</td>
      <td>994.0</td>
      <td>English</td>
      <td>UK</td>
      <td>PG-13</td>
      <td>245000000.0</td>
      <td>2015.0</td>
      <td>393.0</td>
      <td>6.8</td>
      <td>2.35</td>
      <td>85000</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Color</td>
      <td>Christopher Nolan</td>
      <td>813.0</td>
      <td>164.0</td>
      <td>22000.0</td>
      <td>23000.0</td>
      <td>Christian Bale</td>
      <td>27000.0</td>
      <td>448130642.0</td>
      <td>Action|Thriller</td>
      <td>...</td>
      <td>2701.0</td>
      <td>English</td>
      <td>USA</td>
      <td>PG-13</td>
      <td>250000000.0</td>
      <td>2012.0</td>
      <td>23000.0</td>
      <td>8.5</td>
      <td>2.35</td>
      <td>164000</td>
    </tr>
    <tr>
      <th>4</th>
      <td>NaN</td>
      <td>Doug Walker</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>131.0</td>
      <td>NaN</td>
      <td>Rob Walker</td>
      <td>131.0</td>
      <td>NaN</td>
      <td>Documentary</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>12.0</td>
      <td>7.1</td>
      <td>NaN</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 28 columns</p>
</div>




```python
s = pd.Series([1, 2, 3, 4, 5, 6, 7, 8, 9, 10])
s.tail()
```




    5     6
    6     7
    7     8
    8     9
    9    10
    dtype: int64




```python
df.tail(20)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>color</th>
      <th>director_name</th>
      <th>num_critic_for_reviews</th>
      <th>duration</th>
      <th>director_facebook_likes</th>
      <th>actor_3_facebook_likes</th>
      <th>actor_2_name</th>
      <th>actor_1_facebook_likes</th>
      <th>gross</th>
      <th>genres</th>
      <th>...</th>
      <th>num_user_for_reviews</th>
      <th>language</th>
      <th>country</th>
      <th>content_rating</th>
      <th>budget</th>
      <th>title_year</th>
      <th>actor_2_facebook_likes</th>
      <th>imdb_score</th>
      <th>aspect_ratio</th>
      <th>movie_facebook_likes</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>4896</th>
      <td>Color</td>
      <td>Daryl Wein</td>
      <td>22.0</td>
      <td>88.0</td>
      <td>38.0</td>
      <td>211.0</td>
      <td>Heather Burns</td>
      <td>331.0</td>
      <td>76382.0</td>
      <td>Romance</td>
      <td>...</td>
      <td>8.0</td>
      <td>English</td>
      <td>USA</td>
      <td>NaN</td>
      <td>15000.0</td>
      <td>2009.0</td>
      <td>212.0</td>
      <td>6.2</td>
      <td>2.35</td>
      <td>324</td>
    </tr>
    <tr>
      <th>4897</th>
      <td>Color</td>
      <td>Jason Trost</td>
      <td>42.0</td>
      <td>78.0</td>
      <td>91.0</td>
      <td>86.0</td>
      <td>Jason Trost</td>
      <td>407.0</td>
      <td>NaN</td>
      <td>Sci-Fi|Thriller</td>
      <td>...</td>
      <td>35.0</td>
      <td>English</td>
      <td>USA</td>
      <td>Unrated</td>
      <td>20000.0</td>
      <td>2011.0</td>
      <td>91.0</td>
      <td>4.0</td>
      <td>2.35</td>
      <td>835</td>
    </tr>
    <tr>
      <th>4898</th>
      <td>Color</td>
      <td>John Waters</td>
      <td>73.0</td>
      <td>108.0</td>
      <td>0.0</td>
      <td>105.0</td>
      <td>Mink Stole</td>
      <td>462.0</td>
      <td>180483.0</td>
      <td>Comedy|Crime|Horror</td>
      <td>...</td>
      <td>183.0</td>
      <td>English</td>
      <td>USA</td>
      <td>NC-17</td>
      <td>10000.0</td>
      <td>1972.0</td>
      <td>143.0</td>
      <td>6.1</td>
      <td>1.37</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4899</th>
      <td>Color</td>
      <td>Olivier Assayas</td>
      <td>81.0</td>
      <td>110.0</td>
      <td>107.0</td>
      <td>45.0</td>
      <td>Béatrice Dalle</td>
      <td>576.0</td>
      <td>136007.0</td>
      <td>Drama|Music|Romance</td>
      <td>...</td>
      <td>39.0</td>
      <td>French</td>
      <td>France</td>
      <td>R</td>
      <td>4500.0</td>
      <td>2004.0</td>
      <td>133.0</td>
      <td>6.9</td>
      <td>2.35</td>
      <td>171</td>
    </tr>
    <tr>
      <th>4900</th>
      <td>Color</td>
      <td>Jafar Panahi</td>
      <td>64.0</td>
      <td>90.0</td>
      <td>397.0</td>
      <td>0.0</td>
      <td>Nargess Mamizadeh</td>
      <td>5.0</td>
      <td>673780.0</td>
      <td>Drama</td>
      <td>...</td>
      <td>26.0</td>
      <td>Persian</td>
      <td>Iran</td>
      <td>Not Rated</td>
      <td>10000.0</td>
      <td>2000.0</td>
      <td>0.0</td>
      <td>7.5</td>
      <td>1.85</td>
      <td>697</td>
    </tr>
    <tr>
      <th>4901</th>
      <td>Black and White</td>
      <td>Ivan Kavanagh</td>
      <td>12.0</td>
      <td>83.0</td>
      <td>18.0</td>
      <td>0.0</td>
      <td>Michael Parle</td>
      <td>10.0</td>
      <td>NaN</td>
      <td>Horror</td>
      <td>...</td>
      <td>1.0</td>
      <td>English</td>
      <td>Ireland</td>
      <td>NaN</td>
      <td>10000.0</td>
      <td>2007.0</td>
      <td>5.0</td>
      <td>6.7</td>
      <td>1.33</td>
      <td>105</td>
    </tr>
    <tr>
      <th>4902</th>
      <td>Color</td>
      <td>Kiyoshi Kurosawa</td>
      <td>78.0</td>
      <td>111.0</td>
      <td>62.0</td>
      <td>6.0</td>
      <td>Anna Nakagawa</td>
      <td>89.0</td>
      <td>94596.0</td>
      <td>Crime|Horror|Mystery|Thriller</td>
      <td>...</td>
      <td>50.0</td>
      <td>Japanese</td>
      <td>Japan</td>
      <td>NaN</td>
      <td>1000000.0</td>
      <td>1997.0</td>
      <td>13.0</td>
      <td>7.4</td>
      <td>1.85</td>
      <td>817</td>
    </tr>
    <tr>
      <th>4903</th>
      <td>Color</td>
      <td>Tadeo Garcia</td>
      <td>NaN</td>
      <td>84.0</td>
      <td>5.0</td>
      <td>12.0</td>
      <td>Michael Cortez</td>
      <td>21.0</td>
      <td>NaN</td>
      <td>Drama</td>
      <td>...</td>
      <td>3.0</td>
      <td>English</td>
      <td>USA</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>2004.0</td>
      <td>20.0</td>
      <td>6.1</td>
      <td>NaN</td>
      <td>22</td>
    </tr>
    <tr>
      <th>4904</th>
      <td>Color</td>
      <td>Thomas L. Phillips</td>
      <td>13.0</td>
      <td>82.0</td>
      <td>120.0</td>
      <td>84.0</td>
      <td>Joe Coffey</td>
      <td>785.0</td>
      <td>NaN</td>
      <td>Comedy|Horror|Thriller</td>
      <td>...</td>
      <td>8.0</td>
      <td>English</td>
      <td>USA</td>
      <td>NaN</td>
      <td>200000.0</td>
      <td>2012.0</td>
      <td>98.0</td>
      <td>5.4</td>
      <td>16.00</td>
      <td>424</td>
    </tr>
    <tr>
      <th>4905</th>
      <td>Color</td>
      <td>Ash Baron-Cohen</td>
      <td>10.0</td>
      <td>98.0</td>
      <td>3.0</td>
      <td>152.0</td>
      <td>Stanley B. Herman</td>
      <td>789.0</td>
      <td>NaN</td>
      <td>Crime|Drama</td>
      <td>...</td>
      <td>14.0</td>
      <td>English</td>
      <td>USA</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1995.0</td>
      <td>194.0</td>
      <td>6.4</td>
      <td>NaN</td>
      <td>20</td>
    </tr>
    <tr>
      <th>4906</th>
      <td>Color</td>
      <td>Shane Carruth</td>
      <td>143.0</td>
      <td>77.0</td>
      <td>291.0</td>
      <td>8.0</td>
      <td>David Sullivan</td>
      <td>291.0</td>
      <td>424760.0</td>
      <td>Drama|Sci-Fi|Thriller</td>
      <td>...</td>
      <td>371.0</td>
      <td>English</td>
      <td>USA</td>
      <td>PG-13</td>
      <td>7000.0</td>
      <td>2004.0</td>
      <td>45.0</td>
      <td>7.0</td>
      <td>1.85</td>
      <td>19000</td>
    </tr>
    <tr>
      <th>4907</th>
      <td>Color</td>
      <td>Neill Dela Llana</td>
      <td>35.0</td>
      <td>80.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>Edgar Tancangco</td>
      <td>0.0</td>
      <td>70071.0</td>
      <td>Thriller</td>
      <td>...</td>
      <td>35.0</td>
      <td>English</td>
      <td>Philippines</td>
      <td>Not Rated</td>
      <td>7000.0</td>
      <td>2005.0</td>
      <td>0.0</td>
      <td>6.3</td>
      <td>NaN</td>
      <td>74</td>
    </tr>
    <tr>
      <th>4908</th>
      <td>Color</td>
      <td>Robert Rodriguez</td>
      <td>56.0</td>
      <td>81.0</td>
      <td>0.0</td>
      <td>6.0</td>
      <td>Peter Marquardt</td>
      <td>121.0</td>
      <td>2040920.0</td>
      <td>Action|Crime|Drama|Romance|Thriller</td>
      <td>...</td>
      <td>130.0</td>
      <td>Spanish</td>
      <td>USA</td>
      <td>R</td>
      <td>7000.0</td>
      <td>1992.0</td>
      <td>20.0</td>
      <td>6.9</td>
      <td>1.37</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4909</th>
      <td>Color</td>
      <td>Anthony Vallone</td>
      <td>NaN</td>
      <td>84.0</td>
      <td>2.0</td>
      <td>2.0</td>
      <td>John Considine</td>
      <td>45.0</td>
      <td>NaN</td>
      <td>Crime|Drama</td>
      <td>...</td>
      <td>1.0</td>
      <td>English</td>
      <td>USA</td>
      <td>PG-13</td>
      <td>3250.0</td>
      <td>2005.0</td>
      <td>44.0</td>
      <td>7.8</td>
      <td>NaN</td>
      <td>4</td>
    </tr>
    <tr>
      <th>4910</th>
      <td>Color</td>
      <td>Edward Burns</td>
      <td>14.0</td>
      <td>95.0</td>
      <td>0.0</td>
      <td>133.0</td>
      <td>Caitlin FitzGerald</td>
      <td>296.0</td>
      <td>4584.0</td>
      <td>Comedy|Drama</td>
      <td>...</td>
      <td>14.0</td>
      <td>English</td>
      <td>USA</td>
      <td>Not Rated</td>
      <td>9000.0</td>
      <td>2011.0</td>
      <td>205.0</td>
      <td>6.4</td>
      <td>NaN</td>
      <td>413</td>
    </tr>
    <tr>
      <th>4911</th>
      <td>Color</td>
      <td>Scott Smith</td>
      <td>1.0</td>
      <td>87.0</td>
      <td>2.0</td>
      <td>318.0</td>
      <td>Daphne Zuniga</td>
      <td>637.0</td>
      <td>NaN</td>
      <td>Comedy|Drama</td>
      <td>...</td>
      <td>6.0</td>
      <td>English</td>
      <td>Canada</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>2013.0</td>
      <td>470.0</td>
      <td>7.7</td>
      <td>NaN</td>
      <td>84</td>
    </tr>
    <tr>
      <th>4912</th>
      <td>Color</td>
      <td>NaN</td>
      <td>43.0</td>
      <td>43.0</td>
      <td>NaN</td>
      <td>319.0</td>
      <td>Valorie Curry</td>
      <td>841.0</td>
      <td>NaN</td>
      <td>Crime|Drama|Mystery|Thriller</td>
      <td>...</td>
      <td>359.0</td>
      <td>English</td>
      <td>USA</td>
      <td>TV-14</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>593.0</td>
      <td>7.5</td>
      <td>16.00</td>
      <td>32000</td>
    </tr>
    <tr>
      <th>4913</th>
      <td>Color</td>
      <td>Benjamin Roberds</td>
      <td>13.0</td>
      <td>76.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>Maxwell Moody</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>Drama|Horror|Thriller</td>
      <td>...</td>
      <td>3.0</td>
      <td>English</td>
      <td>USA</td>
      <td>NaN</td>
      <td>1400.0</td>
      <td>2013.0</td>
      <td>0.0</td>
      <td>6.3</td>
      <td>NaN</td>
      <td>16</td>
    </tr>
    <tr>
      <th>4914</th>
      <td>Color</td>
      <td>Daniel Hsia</td>
      <td>14.0</td>
      <td>100.0</td>
      <td>0.0</td>
      <td>489.0</td>
      <td>Daniel Henney</td>
      <td>946.0</td>
      <td>10443.0</td>
      <td>Comedy|Drama|Romance</td>
      <td>...</td>
      <td>9.0</td>
      <td>English</td>
      <td>USA</td>
      <td>PG-13</td>
      <td>NaN</td>
      <td>2012.0</td>
      <td>719.0</td>
      <td>6.3</td>
      <td>2.35</td>
      <td>660</td>
    </tr>
    <tr>
      <th>4915</th>
      <td>Color</td>
      <td>Jon Gunn</td>
      <td>43.0</td>
      <td>90.0</td>
      <td>16.0</td>
      <td>16.0</td>
      <td>Brian Herzlinger</td>
      <td>86.0</td>
      <td>85222.0</td>
      <td>Documentary</td>
      <td>...</td>
      <td>84.0</td>
      <td>English</td>
      <td>USA</td>
      <td>PG</td>
      <td>1100.0</td>
      <td>2004.0</td>
      <td>23.0</td>
      <td>6.6</td>
      <td>1.85</td>
      <td>456</td>
    </tr>
  </tbody>
</table>
<p>20 rows × 28 columns</p>
</div>




```python
# DataFrame 자체의 정보 -> 행/열
df.info()
```

    <class 'pandas.core.frame.DataFrame'>
    RangeIndex: 4916 entries, 0 to 4915
    Data columns (total 28 columns):
     #   Column                     Non-Null Count  Dtype  
    ---  ------                     --------------  -----  
     0   color                      4897 non-null   object 
     1   director_name              4814 non-null   object 
     2   num_critic_for_reviews     4867 non-null   float64
     3   duration                   4901 non-null   float64
     4   director_facebook_likes    4814 non-null   float64
     5   actor_3_facebook_likes     4893 non-null   float64
     6   actor_2_name               4903 non-null   object 
     7   actor_1_facebook_likes     4909 non-null   float64
     8   gross                      4054 non-null   float64
     9   genres                     4916 non-null   object 
     10  actor_1_name               4909 non-null   object 
     11  movie_title                4916 non-null   object 
     12  num_voted_users            4916 non-null   int64  
     13  cast_total_facebook_likes  4916 non-null   int64  
     14  actor_3_name               4893 non-null   object 
     15  facenumber_in_poster       4903 non-null   float64
     16  plot_keywords              4764 non-null   object 
     17  movie_imdb_link            4916 non-null   object 
     18  num_user_for_reviews       4895 non-null   float64
     19  language                   4904 non-null   object 
     20  country                    4911 non-null   object 
     21  content_rating             4616 non-null   object 
     22  budget                     4432 non-null   float64
     23  title_year                 4810 non-null   float64
     24  actor_2_facebook_likes     4903 non-null   float64
     25  imdb_score                 4916 non-null   float64
     26  aspect_ratio               4590 non-null   float64
     27  movie_facebook_likes       4916 non-null   int64  
    dtypes: float64(13), int64(3), object(12)
    memory usage: 1.1+ MB
    

```
<class 'pandas.core.frame.DataFrame'>
RangeIndex: 4916 entries, 0 to 4915  ========================> 행 정보: 행수, index 이름
Data columns (total 28 columns):  ===========================> 열 정보: 열 개수
 #   Column                     Non-Null Count  Dtype  ======> 개별 컬럼 정보: 컬럼 이름 | 결측치 제외한 데이터 개수 | 타입
---  ------                     --------------  -----  
 0   color                      4897 non-null   object ======> 결측치 개수: 4916 - 4897 = 19
 1   director_name              4814 non-null   object 
 2   num_critic_for_reviews     4867 non-null   float64
 3   duration                   4901 non-null   float64
 4   director_facebook_likes    4814 non-null   float64
 5   actor_3_facebook_likes     4893 non-null   float64
 6   actor_2_name               4903 non-null   object 
 7   actor_1_facebook_likes     4909 non-null   float64
 8   gross                      4054 non-null   float64
 9   genres                     4916 non-null   object 
 10  actor_1_name               4909 non-null   object 
 11  movie_title                4916 non-null   object 
 12  num_voted_users            4916 non-null   int64  
 13  cast_total_facebook_likes  4916 non-null   int64  
 14  actor_3_name               4893 non-null   object 
 15  facenumber_in_poster       4903 non-null   float64
 16  plot_keywords              4764 non-null   object 
 17  movie_imdb_link            4916 non-null   object 
 18  num_user_for_reviews       4895 non-null   float64
 19  language                   4904 non-null   object 
 20  country                    4911 non-null   object 
 21  content_rating             4616 non-null   object 
 22  budget                     4432 non-null   float64
 23  title_year                 4810 non-null   float64
 24  actor_2_facebook_likes     4903 non-null   float64
 25  imdb_score                 4916 non-null   float64
 26  aspect_ratio               4590 non-null   float64
 27  movie_facebook_likes       4916 non-null   int64  
dtypes: float64(13), int64(3), object(12)   ==================> 데이터 타입별 컬럼 개수
memory usage: 1.1+ MB     ====================================> 메모리 크기
```
- object: 문자열
- column별로
    1. 결측치 있는 지 여부
    2. 데이터 타입, 크기
        - 데이터 틱셔너리와 비교해서 잘못된 데잍 타입은 없는지 확인
        - 컬럼이 가지는 값에 비해 너무 큰 크기로 잡힌 것은 아닌지 확인



```python
# 결측치 개수를 확인 => 컬럼별.
# df.isnull() # 원소별로 결측치인지 여부 확인: True-결측치, False: 일반값
df.isnull().sum() # Series로 반환 = df.isna().sum()
# 1. bool 값들을 sum()-덧셈: True-1, False-0 ==> True가 몇개?
# 2. DataFrame객체.sum() - 컬럼단위로 계산

```




    color                         19
    director_name                102
    num_critic_for_reviews        49
    duration                      15
    director_facebook_likes      102
    actor_3_facebook_likes        23
    actor_2_name                  13
    actor_1_facebook_likes         7
    gross                        862
    genres                         0
    actor_1_name                   7
    movie_title                    0
    num_voted_users                0
    cast_total_facebook_likes      0
    actor_3_name                  23
    facenumber_in_poster          13
    plot_keywords                152
    movie_imdb_link                0
    num_user_for_reviews          21
    language                      12
    country                        5
    content_rating               300
    budget                       484
    title_year                   106
    actor_2_facebook_likes        13
    imdb_score                     0
    aspect_ratio                 326
    movie_facebook_likes           0
    dtype: int64




```python
df.describe()
# 1. column 단위로 통계치를 묶어서 보여준다.
# 2. 수치형 column들만 보여준다.
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>num_critic_for_reviews</th>
      <th>duration</th>
      <th>director_facebook_likes</th>
      <th>actor_3_facebook_likes</th>
      <th>actor_1_facebook_likes</th>
      <th>gross</th>
      <th>num_voted_users</th>
      <th>cast_total_facebook_likes</th>
      <th>facenumber_in_poster</th>
      <th>num_user_for_reviews</th>
      <th>budget</th>
      <th>title_year</th>
      <th>actor_2_facebook_likes</th>
      <th>imdb_score</th>
      <th>aspect_ratio</th>
      <th>movie_facebook_likes</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>4867.000000</td>
      <td>4901.000000</td>
      <td>4814.000000</td>
      <td>4893.000000</td>
      <td>4909.000000</td>
      <td>4.054000e+03</td>
      <td>4.916000e+03</td>
      <td>4916.000000</td>
      <td>4903.000000</td>
      <td>4895.000000</td>
      <td>4.432000e+03</td>
      <td>4810.000000</td>
      <td>4903.000000</td>
      <td>4916.000000</td>
      <td>4590.000000</td>
      <td>4916.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>137.988905</td>
      <td>107.090798</td>
      <td>691.014541</td>
      <td>631.276313</td>
      <td>6494.488491</td>
      <td>4.764451e+07</td>
      <td>8.264492e+04</td>
      <td>9579.815907</td>
      <td>1.377320</td>
      <td>267.668846</td>
      <td>3.654749e+07</td>
      <td>2002.447609</td>
      <td>1621.923516</td>
      <td>6.437429</td>
      <td>2.222349</td>
      <td>7348.294142</td>
    </tr>
    <tr>
      <th>std</th>
      <td>120.239379</td>
      <td>25.286015</td>
      <td>2832.954125</td>
      <td>1625.874802</td>
      <td>15106.986884</td>
      <td>6.737255e+07</td>
      <td>1.383222e+05</td>
      <td>18164.316990</td>
      <td>2.023826</td>
      <td>372.934839</td>
      <td>1.002427e+08</td>
      <td>12.453977</td>
      <td>4011.299523</td>
      <td>1.127802</td>
      <td>1.402940</td>
      <td>19206.016458</td>
    </tr>
    <tr>
      <th>min</th>
      <td>1.000000</td>
      <td>7.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>1.620000e+02</td>
      <td>5.000000e+00</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>1.000000</td>
      <td>2.180000e+02</td>
      <td>1916.000000</td>
      <td>0.000000</td>
      <td>1.600000</td>
      <td>1.180000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>49.000000</td>
      <td>93.000000</td>
      <td>7.000000</td>
      <td>132.000000</td>
      <td>607.000000</td>
      <td>5.019656e+06</td>
      <td>8.361750e+03</td>
      <td>1394.750000</td>
      <td>0.000000</td>
      <td>64.000000</td>
      <td>6.000000e+06</td>
      <td>1999.000000</td>
      <td>277.000000</td>
      <td>5.800000</td>
      <td>1.850000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>108.000000</td>
      <td>103.000000</td>
      <td>48.000000</td>
      <td>366.000000</td>
      <td>982.000000</td>
      <td>2.504396e+07</td>
      <td>3.313250e+04</td>
      <td>3049.000000</td>
      <td>1.000000</td>
      <td>153.000000</td>
      <td>1.985000e+07</td>
      <td>2005.000000</td>
      <td>593.000000</td>
      <td>6.600000</td>
      <td>2.350000</td>
      <td>159.000000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>191.000000</td>
      <td>118.000000</td>
      <td>189.750000</td>
      <td>633.000000</td>
      <td>11000.000000</td>
      <td>6.110841e+07</td>
      <td>9.377275e+04</td>
      <td>13616.750000</td>
      <td>2.000000</td>
      <td>320.500000</td>
      <td>4.300000e+07</td>
      <td>2011.000000</td>
      <td>912.000000</td>
      <td>7.200000</td>
      <td>2.350000</td>
      <td>2000.000000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>813.000000</td>
      <td>511.000000</td>
      <td>23000.000000</td>
      <td>23000.000000</td>
      <td>640000.000000</td>
      <td>7.605058e+08</td>
      <td>1.689764e+06</td>
      <td>656730.000000</td>
      <td>43.000000</td>
      <td>5060.000000</td>
      <td>4.200000e+09</td>
      <td>2016.000000</td>
      <td>137000.000000</td>
      <td>9.500000</td>
      <td>16.000000</td>
      <td>349000.000000</td>
    </tr>
  </tbody>
</table>
</div>




```python
df.describe(include=['object']) # 문자형 column 들만 보여줌
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>color</th>
      <th>director_name</th>
      <th>actor_2_name</th>
      <th>genres</th>
      <th>actor_1_name</th>
      <th>movie_title</th>
      <th>actor_3_name</th>
      <th>plot_keywords</th>
      <th>movie_imdb_link</th>
      <th>language</th>
      <th>country</th>
      <th>content_rating</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>4897</td>
      <td>4814</td>
      <td>4903</td>
      <td>4916</td>
      <td>4909</td>
      <td>4916</td>
      <td>4893</td>
      <td>4764</td>
      <td>4916</td>
      <td>4904</td>
      <td>4911</td>
      <td>4616</td>
    </tr>
    <tr>
      <th>unique</th>
      <td>2</td>
      <td>2397</td>
      <td>3030</td>
      <td>914</td>
      <td>2095</td>
      <td>4916</td>
      <td>3519</td>
      <td>4756</td>
      <td>4916</td>
      <td>47</td>
      <td>65</td>
      <td>18</td>
    </tr>
    <tr>
      <th>top</th>
      <td>Color</td>
      <td>Steven Spielberg</td>
      <td>Morgan Freeman</td>
      <td>Drama</td>
      <td>Robert De Niro</td>
      <td>Avatar</td>
      <td>Steve Coogan</td>
      <td>based on novel</td>
      <td>http://www.imdb.com/title/tt0499549/?ref_=fn_t...</td>
      <td>English</td>
      <td>USA</td>
      <td>R</td>
    </tr>
    <tr>
      <th>freq</th>
      <td>4693</td>
      <td>26</td>
      <td>18</td>
      <td>233</td>
      <td>48</td>
      <td>1</td>
      <td>8</td>
      <td>4</td>
      <td>1</td>
      <td>4582</td>
      <td>3710</td>
      <td>2067</td>
    </tr>
  </tbody>
</table>
</div>




```python
df.describe(include=['int64']) # 자세히 설정 가능
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>num_voted_users</th>
      <th>cast_total_facebook_likes</th>
      <th>movie_facebook_likes</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>4.916000e+03</td>
      <td>4916.000000</td>
      <td>4916.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>8.264492e+04</td>
      <td>9579.815907</td>
      <td>7348.294142</td>
    </tr>
    <tr>
      <th>std</th>
      <td>1.383222e+05</td>
      <td>18164.316990</td>
      <td>19206.016458</td>
    </tr>
    <tr>
      <th>min</th>
      <td>5.000000e+00</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>8.361750e+03</td>
      <td>1394.750000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>3.313250e+04</td>
      <td>3049.000000</td>
      <td>159.000000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>9.377275e+04</td>
      <td>13616.750000</td>
      <td>2000.000000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>1.689764e+06</td>
      <td>656730.000000</td>
      <td>349000.000000</td>
    </tr>
  </tbody>
</table>
</div>




```python
df.describe(exclude=['float64'])  # float64를 제외한 값들 -> 수치형와 문자형 column이 동시에 나옴
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>color</th>
      <th>director_name</th>
      <th>actor_2_name</th>
      <th>genres</th>
      <th>actor_1_name</th>
      <th>movie_title</th>
      <th>num_voted_users</th>
      <th>cast_total_facebook_likes</th>
      <th>actor_3_name</th>
      <th>plot_keywords</th>
      <th>movie_imdb_link</th>
      <th>language</th>
      <th>country</th>
      <th>content_rating</th>
      <th>movie_facebook_likes</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>4897</td>
      <td>4814</td>
      <td>4903</td>
      <td>4916</td>
      <td>4909</td>
      <td>4916</td>
      <td>4.916000e+03</td>
      <td>4916.000000</td>
      <td>4893</td>
      <td>4764</td>
      <td>4916</td>
      <td>4904</td>
      <td>4911</td>
      <td>4616</td>
      <td>4916.000000</td>
    </tr>
    <tr>
      <th>unique</th>
      <td>2</td>
      <td>2397</td>
      <td>3030</td>
      <td>914</td>
      <td>2095</td>
      <td>4916</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>3519</td>
      <td>4756</td>
      <td>4916</td>
      <td>47</td>
      <td>65</td>
      <td>18</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>top</th>
      <td>Color</td>
      <td>Steven Spielberg</td>
      <td>Morgan Freeman</td>
      <td>Drama</td>
      <td>Robert De Niro</td>
      <td>Avatar</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Steve Coogan</td>
      <td>based on novel</td>
      <td>http://www.imdb.com/title/tt0499549/?ref_=fn_t...</td>
      <td>English</td>
      <td>USA</td>
      <td>R</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>freq</th>
      <td>4693</td>
      <td>26</td>
      <td>18</td>
      <td>233</td>
      <td>48</td>
      <td>1</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>8</td>
      <td>4</td>
      <td>1</td>
      <td>4582</td>
      <td>3710</td>
      <td>2067</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>8.264492e+04</td>
      <td>9579.815907</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>7348.294142</td>
    </tr>
    <tr>
      <th>std</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.383222e+05</td>
      <td>18164.316990</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>19206.016458</td>
    </tr>
    <tr>
      <th>min</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>5.000000e+00</td>
      <td>0.000000</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>8.361750e+03</td>
      <td>1394.750000</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>3.313250e+04</td>
      <td>3049.000000</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>159.000000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>9.377275e+04</td>
      <td>13616.750000</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>2000.000000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.689764e+06</td>
      <td>656730.000000</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>349000.000000</td>
    </tr>
  </tbody>
</table>
</div>




```python
df.describe(include=['object']).T # DF.T 행과 열을 바꿈.
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>count</th>
      <th>unique</th>
      <th>top</th>
      <th>freq</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>color</th>
      <td>4897</td>
      <td>2</td>
      <td>Color</td>
      <td>4693</td>
    </tr>
    <tr>
      <th>director_name</th>
      <td>4814</td>
      <td>2397</td>
      <td>Steven Spielberg</td>
      <td>26</td>
    </tr>
    <tr>
      <th>actor_2_name</th>
      <td>4903</td>
      <td>3030</td>
      <td>Morgan Freeman</td>
      <td>18</td>
    </tr>
    <tr>
      <th>genres</th>
      <td>4916</td>
      <td>914</td>
      <td>Drama</td>
      <td>233</td>
    </tr>
    <tr>
      <th>actor_1_name</th>
      <td>4909</td>
      <td>2095</td>
      <td>Robert De Niro</td>
      <td>48</td>
    </tr>
    <tr>
      <th>movie_title</th>
      <td>4916</td>
      <td>4916</td>
      <td>Avatar</td>
      <td>1</td>
    </tr>
    <tr>
      <th>actor_3_name</th>
      <td>4893</td>
      <td>3519</td>
      <td>Steve Coogan</td>
      <td>8</td>
    </tr>
    <tr>
      <th>plot_keywords</th>
      <td>4764</td>
      <td>4756</td>
      <td>based on novel</td>
      <td>4</td>
    </tr>
    <tr>
      <th>movie_imdb_link</th>
      <td>4916</td>
      <td>4916</td>
      <td>http://www.imdb.com/title/tt0499549/?ref_=fn_t...</td>
      <td>1</td>
    </tr>
    <tr>
      <th>language</th>
      <td>4904</td>
      <td>47</td>
      <td>English</td>
      <td>4582</td>
    </tr>
    <tr>
      <th>country</th>
      <td>4911</td>
      <td>65</td>
      <td>USA</td>
      <td>3710</td>
    </tr>
    <tr>
      <th>content_rating</th>
      <td>4616</td>
      <td>18</td>
      <td>R</td>
      <td>2067</td>
    </tr>
  </tbody>
</table>
</div>




```python
df.mean()  # 수치형(정수, 실수) # 문자형은 못구함
# 에러 창에서 deprecated가 나오면 나중에 없앤다는 말 (에러 X) -> 다른 방식으로 바꿔라
```

    C:\Users\jeonj\AppData\Local\Temp\ipykernel_3012\3330105486.py:1: FutureWarning: The default value of numeric_only in DataFrame.mean is deprecated. In a future version, it will default to False. In addition, specifying 'numeric_only=None' is deprecated. Select only valid columns or specify the value of numeric_only to silence this warning.
      df.mean()  # 수치형(정수, 실수)
    




    num_critic_for_reviews       1.379889e+02
    duration                     1.070908e+02
    director_facebook_likes      6.910145e+02
    actor_3_facebook_likes       6.312763e+02
    actor_1_facebook_likes       6.494488e+03
    gross                        4.764451e+07
    num_voted_users              8.264492e+04
    cast_total_facebook_likes    9.579816e+03
    facenumber_in_poster         1.377320e+00
    num_user_for_reviews         2.676688e+02
    budget                       3.654749e+07
    title_year                   2.002448e+03
    actor_2_facebook_likes       1.621924e+03
    imdb_score                   6.437429e+00
    aspect_ratio                 2.222349e+00
    movie_facebook_likes         7.348294e+03
    dtype: float64




```python
df.mean(numeric_only=True)
```




    num_critic_for_reviews       1.379889e+02
    duration                     1.070908e+02
    director_facebook_likes      6.910145e+02
    actor_3_facebook_likes       6.312763e+02
    actor_1_facebook_likes       6.494488e+03
    gross                        4.764451e+07
    num_voted_users              8.264492e+04
    cast_total_facebook_likes    9.579816e+03
    facenumber_in_poster         1.377320e+00
    num_user_for_reviews         2.676688e+02
    budget                       3.654749e+07
    title_year                   2.002448e+03
    actor_2_facebook_likes       1.621924e+03
    imdb_score                   6.437429e+00
    aspect_ratio                 2.222349e+00
    movie_facebook_likes         7.348294e+03
    dtype: float64



# 컬럼이름/행이름 조회 및 변경
## 컬럼이름/행이름 조회
- **DataFrame객체.columns**
    - 컬럼명 조회
    - 컬럼명은 차후 조회를 위해 따로 변수에 저장하는 것이 좋다.
- **DataFrame객체.index**
    - 행명 조회


```python
movie.columns
```




    Index(['color', 'director_name', 'num_critic_for_reviews', 'duration',
           'director_facebook_likes', 'actor_3_facebook_likes', 'actor_2_name',
           'actor_1_facebook_likes', 'gross', 'genres', 'actor_1_name',
           'movie_title', 'num_voted_users', 'cast_total_facebook_likes',
           'actor_3_name', 'facenumber_in_poster', 'plot_keywords',
           'movie_imdb_link', 'num_user_for_reviews', 'language', 'country',
           'content_rating', 'budget', 'title_year', 'actor_2_facebook_likes',
           'imdb_score', 'aspect_ratio', 'movie_facebook_likes'],
          dtype='object')




```python
movie.index
```




    RangeIndex(start=0, stop=4916, step=1)




```python
movie.columns[2]
movie.columns[3:10]
```




    Index(['duration', 'director_facebook_likes', 'actor_3_facebook_likes',
           'actor_2_name', 'actor_1_facebook_likes', 'gross', 'genres'],
          dtype='object')



## 컬럼이름/행이름 변경
- columns와 index 속성으로는 통째로 바꾸는 것은 가능하나 일부만 선택해서 변경하는 것은 안된다.
    - `df.columns = ['새이름','새이름', ... , '새이름']`
    - `df.columns[1] = '새이름'` 
        - 이런식으로 개별적으로 변경은 안된다.


```python
grade = pd.read_csv('saved_data/grade2.csv')
grade
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>korean</th>
      <th>english</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>id-1</td>
      <td>100</td>
      <td>90</td>
    </tr>
    <tr>
      <th>1</th>
      <td>id-2</td>
      <td>50</td>
      <td>80</td>
    </tr>
    <tr>
      <th>2</th>
      <td>id-3</td>
      <td>70</td>
      <td>100</td>
    </tr>
    <tr>
      <th>3</th>
      <td>id-4</td>
      <td>60</td>
      <td>60</td>
    </tr>
    <tr>
      <th>4</th>
      <td>id-5</td>
      <td>90</td>
      <td>40</td>
    </tr>
  </tbody>
</table>
</div>




```python
grade.columns
```




    Index(['id', 'korean', 'english'], dtype='object')




```python
grade.columns=['ID', '국어', '영어']  # DataFrame 원본이 바뀜
grade
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ID</th>
      <th>국어</th>
      <th>영어</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>id-1</td>
      <td>100</td>
      <td>90</td>
    </tr>
    <tr>
      <th>1</th>
      <td>id-2</td>
      <td>50</td>
      <td>80</td>
    </tr>
    <tr>
      <th>2</th>
      <td>id-3</td>
      <td>70</td>
      <td>100</td>
    </tr>
    <tr>
      <th>3</th>
      <td>id-4</td>
      <td>60</td>
      <td>60</td>
    </tr>
    <tr>
      <th>4</th>
      <td>id-5</td>
      <td>90</td>
      <td>40</td>
    </tr>
  </tbody>
</table>
</div>




```python
grade.columns[1] = '수학' # 개별 column의 이름은 columns로는 못변경한다.
```


    ---------------------------------------------------------------------------

    TypeError                                 Traceback (most recent call last)

    Cell In[184], line 1
    ----> 1 grade.columns[1] = '수학' # 개별 column의 이름은 columns로는 못변경한다.
    

    File ~\anaconda3\envs\ml\lib\site-packages\pandas\core\indexes\base.py:5345, in Index.__setitem__(self, key, value)
       5343 @final
       5344 def __setitem__(self, key, value):
    -> 5345     raise TypeError("Index does not support mutable operations")
    

    TypeError: Index does not support mutable operations


### 컬럼이름/행이름 변경 관련 메소드    
- `DataFrame객체.rename(index=행이름변경설정, columns=열이름변경설정, inplace=False)`
    - **개별 컬럼이름/행이름 변경** 하는 메소드
    - 변경한 DataFrame을 반환
    - 변경설정: 딕셔너리 사용
        - {'기존이름':'새이름', ..}
        - inplace: 원본을 변경할지 여부(boolean)        


```python
# 국어 => KOREAN, 영어 => ENGLISH
new_columns = {
    "국어":"KOREAN",
    "영어":"ENGLISH"
}
new_index = {
    1:'일',
    3:'삼'
}
grade.rename(columns=new_columns, index=new_index, inplace=True)
```


```python
grade
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ID</th>
      <th>KOREAN</th>
      <th>ENGLISH</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>id-1</td>
      <td>100</td>
      <td>90</td>
    </tr>
    <tr>
      <th>일</th>
      <td>id-2</td>
      <td>50</td>
      <td>80</td>
    </tr>
    <tr>
      <th>2</th>
      <td>id-3</td>
      <td>70</td>
      <td>100</td>
    </tr>
    <tr>
      <th>삼</th>
      <td>id-4</td>
      <td>60</td>
      <td>60</td>
    </tr>
    <tr>
      <th>4</th>
      <td>id-5</td>
      <td>90</td>
      <td>40</td>
    </tr>
  </tbody>
</table>
</div>



- `DataFrame객체.set_index(컬럼이름, inplace=False)`
    - 특정 컬럼을 행의 index 명으로 사용
    - 열이 index명이 되면서 그 컬럼은 Data Set 에서 제거된다.
- `DataFrame객체.reset_index(inplace=False)`
    - index를 첫번째 컬럼으로 복원


```python
# ID 칼럼을 행 식별자(index name)으로 지정.
grade.set_index('ID', inplace=True)
grade
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>KOREAN</th>
      <th>ENGLISH</th>
    </tr>
    <tr>
      <th>ID</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>id-1</th>
      <td>100</td>
      <td>90</td>
    </tr>
    <tr>
      <th>id-2</th>
      <td>50</td>
      <td>80</td>
    </tr>
    <tr>
      <th>id-3</th>
      <td>70</td>
      <td>100</td>
    </tr>
    <tr>
      <th>id-4</th>
      <td>60</td>
      <td>60</td>
    </tr>
    <tr>
      <th>id-5</th>
      <td>90</td>
      <td>40</td>
    </tr>
  </tbody>
</table>
</div>




```python
grade.to_csv("saved_data/grade7.csv")
```


```python
grade7 = pd.read_csv("saved_data/grade7.csv", index_col='ID')
grade7
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>KOREAN</th>
      <th>ENGLISH</th>
    </tr>
    <tr>
      <th>ID</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>id-1</th>
      <td>100</td>
      <td>90</td>
    </tr>
    <tr>
      <th>id-2</th>
      <td>50</td>
      <td>80</td>
    </tr>
    <tr>
      <th>id-3</th>
      <td>70</td>
      <td>100</td>
    </tr>
    <tr>
      <th>id-4</th>
      <td>60</td>
      <td>60</td>
    </tr>
    <tr>
      <th>id-5</th>
      <td>90</td>
      <td>40</td>
    </tr>
  </tbody>
</table>
</div>




```python
grade.reset_index(inplace=True) # index name을 column(값)으로 뺀다.
grade
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ID</th>
      <th>KOREAN</th>
      <th>ENGLISH</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>id-1</td>
      <td>100</td>
      <td>90</td>
    </tr>
    <tr>
      <th>1</th>
      <td>id-2</td>
      <td>50</td>
      <td>80</td>
    </tr>
    <tr>
      <th>2</th>
      <td>id-3</td>
      <td>70</td>
      <td>100</td>
    </tr>
    <tr>
      <th>3</th>
      <td>id-4</td>
      <td>60</td>
      <td>60</td>
    </tr>
    <tr>
      <th>4</th>
      <td>id-5</td>
      <td>90</td>
      <td>40</td>
    </tr>
  </tbody>
</table>
</div>




```python
grade8 = grade.iloc[[4,2,3,1,0]] # 행조회(index-순번-으로 조회)
grade8.reset_index(drop=False) # index 이름을 제거 -> index이름은 순번으로 변경
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ID</th>
      <th>KOREAN</th>
      <th>ENGLISH</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>id-5</td>
      <td>90</td>
      <td>40</td>
    </tr>
    <tr>
      <th>1</th>
      <td>id-3</td>
      <td>70</td>
      <td>100</td>
    </tr>
    <tr>
      <th>2</th>
      <td>id-4</td>
      <td>60</td>
      <td>60</td>
    </tr>
    <tr>
      <th>3</th>
      <td>id-2</td>
      <td>50</td>
      <td>80</td>
    </tr>
    <tr>
      <th>4</th>
      <td>id-1</td>
      <td>100</td>
      <td>90</td>
    </tr>
  </tbody>
</table>
</div>



# 행과 열의 값 변경

## 특정 행 또는 열 삭제
- DataFrame객체.drop(columns, index, inplace=False)
    - columns : 삭제할 열이름 또는 열이름 리스트
    - index : 삭제할 index명 또는 index 리스트
    - inplace: 원본을 변경할지 여부(boolean)


```python
grade
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ID</th>
      <th>KOREAN</th>
      <th>ENGLISH</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>id-1</td>
      <td>100</td>
      <td>90</td>
    </tr>
    <tr>
      <th>1</th>
      <td>id-2</td>
      <td>50</td>
      <td>80</td>
    </tr>
    <tr>
      <th>2</th>
      <td>id-3</td>
      <td>70</td>
      <td>100</td>
    </tr>
    <tr>
      <th>3</th>
      <td>id-4</td>
      <td>60</td>
      <td>60</td>
    </tr>
    <tr>
      <th>4</th>
      <td>id-5</td>
      <td>90</td>
      <td>40</td>
    </tr>
  </tbody>
</table>
</div>




```python
grade.drop(columns='KOREAN')
grade.drop(columns=['KOREAN', 'ENGLISH'])
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ID</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>id-1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>id-2</td>
    </tr>
    <tr>
      <th>2</th>
      <td>id-3</td>
    </tr>
    <tr>
      <th>3</th>
      <td>id-4</td>
    </tr>
    <tr>
      <th>4</th>
      <td>id-5</td>
    </tr>
  </tbody>
</table>
</div>




```python
grade7.drop(index='id-1')
grade7.drop(index=['id-1','id-3'])
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>KOREAN</th>
      <th>ENGLISH</th>
    </tr>
    <tr>
      <th>ID</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>id-2</th>
      <td>50</td>
      <td>80</td>
    </tr>
    <tr>
      <th>id-4</th>
      <td>60</td>
      <td>60</td>
    </tr>
    <tr>
      <th>id-5</th>
      <td>90</td>
      <td>40</td>
    </tr>
  </tbody>
</table>
</div>




```python
grade7.drop(labels="KOREAN", axis=1) # 열 삭제
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ENGLISH</th>
    </tr>
    <tr>
      <th>ID</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>id-1</th>
      <td>90</td>
    </tr>
    <tr>
      <th>id-2</th>
      <td>80</td>
    </tr>
    <tr>
      <th>id-3</th>
      <td>100</td>
    </tr>
    <tr>
      <th>id-4</th>
      <td>60</td>
    </tr>
    <tr>
      <th>id-5</th>
      <td>40</td>
    </tr>
  </tbody>
</table>
</div>




```python
grade7.drop(labels=["id-3", "id-1"], axis=0) # 행 삭제
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>KOREAN</th>
      <th>ENGLISH</th>
    </tr>
    <tr>
      <th>ID</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>id-2</th>
      <td>50</td>
      <td>80</td>
    </tr>
    <tr>
      <th>id-4</th>
      <td>60</td>
      <td>60</td>
    </tr>
    <tr>
      <th>id-5</th>
      <td>90</td>
      <td>40</td>
    </tr>
  </tbody>
</table>
</div>




```python
grade.shape
```




    (5, 3)



## 열 추가
- 새로운 열을 지정 후 값을 대입하면 새로운 열을 추가할 수 있다.
    - 보통 **파생변수**를 만들 때 사용한다.
- **열 추가**
    - `df['새열명'] = 값`
    - 마지막 열로 추가된다.
    - 하나의 값을 대입하면 모든 행에 그 값이 대입된다.
    - 다른 값을 주려면 배열에 담아서 대입한다.
- **열 삽입**
    - `df.insert(삽입할 위치 index, 삽입할 열이름, 값)`    
- **파생변수생성**
    - 기존 열들의 값을 이용해서 만든 열을 파생변수라고 한다.
    - 벡터화 연산을 이용하여 값 대입한다.
    - df\['새열이름'\] = 기존 열들을 이용한 연산


```python
import pandas as pd
grade = pd.read_csv('saved_data/grade7.csv')
grade.reset_index(drop=False)
grade
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ID</th>
      <th>KOREAN</th>
      <th>ENGLISH</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>id-1</td>
      <td>100</td>
      <td>90</td>
    </tr>
    <tr>
      <th>1</th>
      <td>id-2</td>
      <td>50</td>
      <td>80</td>
    </tr>
    <tr>
      <th>2</th>
      <td>id-3</td>
      <td>70</td>
      <td>100</td>
    </tr>
    <tr>
      <th>3</th>
      <td>id-4</td>
      <td>60</td>
      <td>60</td>
    </tr>
    <tr>
      <th>4</th>
      <td>id-5</td>
      <td>90</td>
      <td>40</td>
    </tr>
  </tbody>
</table>
</div>




```python
grade
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ID</th>
      <th>KOREAN</th>
      <th>ENGLISH</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>id-1</td>
      <td>100</td>
      <td>90</td>
    </tr>
    <tr>
      <th>1</th>
      <td>id-2</td>
      <td>50</td>
      <td>80</td>
    </tr>
    <tr>
      <th>2</th>
      <td>id-3</td>
      <td>70</td>
      <td>100</td>
    </tr>
    <tr>
      <th>3</th>
      <td>id-4</td>
      <td>60</td>
      <td>60</td>
    </tr>
    <tr>
      <th>4</th>
      <td>id-5</td>
      <td>90</td>
      <td>40</td>
    </tr>
  </tbody>
</table>
</div>




```python
# 컬럼값 조회
# grade['MATH'] => 값이 없어 에러 발생

# 컬럼값 변경 df['컬럼명'] = 값, (없는 column 추가, 없으면 변경)
grade['MATH'] = 90
grade
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ID</th>
      <th>KOREAN</th>
      <th>ENGLISH</th>
      <th>MATH</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>id-1</td>
      <td>100</td>
      <td>90</td>
      <td>90</td>
    </tr>
    <tr>
      <th>1</th>
      <td>id-2</td>
      <td>50</td>
      <td>80</td>
      <td>90</td>
    </tr>
    <tr>
      <th>2</th>
      <td>id-3</td>
      <td>70</td>
      <td>100</td>
      <td>90</td>
    </tr>
    <tr>
      <th>3</th>
      <td>id-4</td>
      <td>60</td>
      <td>60</td>
      <td>90</td>
    </tr>
    <tr>
      <th>4</th>
      <td>id-5</td>
      <td>90</td>
      <td>40</td>
      <td>90</td>
    </tr>
  </tbody>
</table>
</div>




```python
grade['PYTHON'] = [100, 90, 70, 80, 100]
grade
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ID</th>
      <th>KOREAN</th>
      <th>ENGLISH</th>
      <th>MATH</th>
      <th>PYTHON</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>id-1</td>
      <td>100</td>
      <td>90</td>
      <td>90</td>
      <td>100</td>
    </tr>
    <tr>
      <th>1</th>
      <td>id-2</td>
      <td>50</td>
      <td>80</td>
      <td>90</td>
      <td>90</td>
    </tr>
    <tr>
      <th>2</th>
      <td>id-3</td>
      <td>70</td>
      <td>100</td>
      <td>90</td>
      <td>70</td>
    </tr>
    <tr>
      <th>3</th>
      <td>id-4</td>
      <td>60</td>
      <td>60</td>
      <td>90</td>
      <td>80</td>
    </tr>
    <tr>
      <th>4</th>
      <td>id-5</td>
      <td>90</td>
      <td>40</td>
      <td>90</td>
      <td>100</td>
    </tr>
  </tbody>
</table>
</div>




```python
# 열의 값들을 조회
# 한 개 column 조회 -> Series로 반환
grade['KOREAN']
```




    0    100
    1     50
    2     70
    3     60
    4     90
    Name: KOREAN, dtype: int64



```
index name => 조회 DataFrame의 index name
0 행의 index 값이 나옴                       100  => 0행의 KOREAN 값 100
1                                             50
2                                             70
3                                             60
4                                             90
Name: KOREAN, dtype: int64
Name -> 조회한 정보
```


```python
grade['총점'] = grade['KOREAN'] + grade['MATH'] + grade['ENGLISH'] + grade['PYTHON'] # Series로 반환되기 때문에 백터화 가능
```


```python
grade['평균'] = grade['총점'] / 4
```


```python
grade
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ID</th>
      <th>KOREAN</th>
      <th>ENGLISH</th>
      <th>MATH</th>
      <th>PYTHON</th>
      <th>총점</th>
      <th>평균</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>id-1</td>
      <td>100</td>
      <td>90</td>
      <td>90</td>
      <td>100</td>
      <td>380</td>
      <td>95.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>id-2</td>
      <td>50</td>
      <td>80</td>
      <td>90</td>
      <td>90</td>
      <td>310</td>
      <td>77.5</td>
    </tr>
    <tr>
      <th>2</th>
      <td>id-3</td>
      <td>70</td>
      <td>100</td>
      <td>90</td>
      <td>70</td>
      <td>330</td>
      <td>82.5</td>
    </tr>
    <tr>
      <th>3</th>
      <td>id-4</td>
      <td>60</td>
      <td>60</td>
      <td>90</td>
      <td>80</td>
      <td>290</td>
      <td>72.5</td>
    </tr>
    <tr>
      <th>4</th>
      <td>id-5</td>
      <td>90</td>
      <td>40</td>
      <td>90</td>
      <td>100</td>
      <td>320</td>
      <td>80.0</td>
    </tr>
  </tbody>
</table>
</div>




```python
g = grade.set_index("ID")
g
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>KOREAN</th>
      <th>ENGLISH</th>
      <th>MATH</th>
      <th>PYTHON</th>
      <th>총점</th>
      <th>평균</th>
    </tr>
    <tr>
      <th>ID</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>id-1</th>
      <td>100</td>
      <td>90</td>
      <td>90</td>
      <td>100</td>
      <td>380</td>
      <td>95.0</td>
    </tr>
    <tr>
      <th>id-2</th>
      <td>50</td>
      <td>80</td>
      <td>90</td>
      <td>90</td>
      <td>310</td>
      <td>77.5</td>
    </tr>
    <tr>
      <th>id-3</th>
      <td>70</td>
      <td>100</td>
      <td>90</td>
      <td>70</td>
      <td>330</td>
      <td>82.5</td>
    </tr>
    <tr>
      <th>id-4</th>
      <td>60</td>
      <td>60</td>
      <td>90</td>
      <td>80</td>
      <td>290</td>
      <td>72.5</td>
    </tr>
    <tr>
      <th>id-5</th>
      <td>90</td>
      <td>40</td>
      <td>90</td>
      <td>100</td>
      <td>320</td>
      <td>80.0</td>
    </tr>
  </tbody>
</table>
</div>




```python
g['KOREAN']  # 행의 index로 반환
```




    ID
    id-1    100
    id-2     50
    id-3     70
    id-4     60
    id-5     90
    Name: KOREAN, dtype: int64




```python
g2 = g.drop(labels=['총점', '평균'], axis=1)
g2
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>KOREAN</th>
      <th>ENGLISH</th>
      <th>MATH</th>
      <th>PYTHON</th>
    </tr>
    <tr>
      <th>ID</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>id-1</th>
      <td>100</td>
      <td>90</td>
      <td>90</td>
      <td>100</td>
    </tr>
    <tr>
      <th>id-2</th>
      <td>50</td>
      <td>80</td>
      <td>90</td>
      <td>90</td>
    </tr>
    <tr>
      <th>id-3</th>
      <td>70</td>
      <td>100</td>
      <td>90</td>
      <td>70</td>
    </tr>
    <tr>
      <th>id-4</th>
      <td>60</td>
      <td>60</td>
      <td>90</td>
      <td>80</td>
    </tr>
    <tr>
      <th>id-5</th>
      <td>90</td>
      <td>40</td>
      <td>90</td>
      <td>100</td>
    </tr>
  </tbody>
</table>
</div>




```python
g2.sum()
```




    KOREAN     370
    ENGLISH    370
    MATH       450
    PYTHON     440
    dtype: int64




```python
total = g2.sum(axis=1)
```


```python
g2.mean()
```




    KOREAN     74.0
    ENGLISH    74.0
    MATH       90.0
    PYTHON     88.0
    dtype: float64




```python
avg = g2.mean(axis=1)
```


```python
g2['총점'] = total
g2['평균'] = avg
g2
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>KOREAN</th>
      <th>ENGLISH</th>
      <th>MATH</th>
      <th>PYTHON</th>
      <th>총점</th>
      <th>평균</th>
    </tr>
    <tr>
      <th>ID</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>id-1</th>
      <td>100</td>
      <td>90</td>
      <td>90</td>
      <td>100</td>
      <td>380</td>
      <td>95.0</td>
    </tr>
    <tr>
      <th>id-2</th>
      <td>50</td>
      <td>80</td>
      <td>90</td>
      <td>90</td>
      <td>310</td>
      <td>77.5</td>
    </tr>
    <tr>
      <th>id-3</th>
      <td>70</td>
      <td>100</td>
      <td>90</td>
      <td>70</td>
      <td>330</td>
      <td>82.5</td>
    </tr>
    <tr>
      <th>id-4</th>
      <td>60</td>
      <td>60</td>
      <td>90</td>
      <td>80</td>
      <td>290</td>
      <td>72.5</td>
    </tr>
    <tr>
      <th>id-5</th>
      <td>90</td>
      <td>40</td>
      <td>90</td>
      <td>100</td>
      <td>320</td>
      <td>80.0</td>
    </tr>
  </tbody>
</table>
</div>




```python
g2.to_csv('saved_data/grade.csv')
```


```python
g2.sum()
g2.mean()
```




    KOREAN      74.0
    ENGLISH     74.0
    MATH        90.0
    PYTHON      88.0
    총점         326.0
    평균          81.5
    dtype: float64




```python
# 행 조회
g2.loc['id-5']  # 행 이름 조회
g2.iloc[0] # 행 순번으로 조회
```




    KOREAN     100.0
    ENGLISH     90.0
    MATH        90.0
    PYTHON     100.0
    총점         380.0
    평균          95.0
    Name: id-1, dtype: float64




```python
# 행 추가
g2.loc['평균'] = g2.mean()
g2
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>KOREAN</th>
      <th>ENGLISH</th>
      <th>MATH</th>
      <th>PYTHON</th>
      <th>총점</th>
      <th>평균</th>
    </tr>
    <tr>
      <th>ID</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>id-1</th>
      <td>100.0</td>
      <td>90.0</td>
      <td>90.0</td>
      <td>100.0</td>
      <td>380.0</td>
      <td>95.0</td>
    </tr>
    <tr>
      <th>id-2</th>
      <td>50.0</td>
      <td>80.0</td>
      <td>90.0</td>
      <td>90.0</td>
      <td>310.0</td>
      <td>77.5</td>
    </tr>
    <tr>
      <th>id-3</th>
      <td>70.0</td>
      <td>100.0</td>
      <td>90.0</td>
      <td>70.0</td>
      <td>330.0</td>
      <td>82.5</td>
    </tr>
    <tr>
      <th>id-4</th>
      <td>60.0</td>
      <td>60.0</td>
      <td>90.0</td>
      <td>80.0</td>
      <td>290.0</td>
      <td>72.5</td>
    </tr>
    <tr>
      <th>id-5</th>
      <td>90.0</td>
      <td>40.0</td>
      <td>90.0</td>
      <td>100.0</td>
      <td>320.0</td>
      <td>80.0</td>
    </tr>
    <tr>
      <th>평균</th>
      <td>74.0</td>
      <td>74.0</td>
      <td>90.0</td>
      <td>88.0</td>
      <td>326.0</td>
      <td>81.5</td>
    </tr>
  </tbody>
</table>
</div>



<b style='font-size:2.2em'>TODO</b>
- 패스 여부를 boolean값으로 저장하는 파생변수 열을 추가
    - 열이름: pass
    - 평균점수가 80미만이면 False,이상이면 True가 나오도록 처리


```python
g2 = pd.read_csv('saved_data/grade.csv')
g2 = g2.set_index("ID")
g2
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>KOREAN</th>
      <th>ENGLISH</th>
      <th>MATH</th>
      <th>PYTHON</th>
      <th>총점</th>
      <th>평균</th>
    </tr>
    <tr>
      <th>ID</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>id-1</th>
      <td>100</td>
      <td>90</td>
      <td>90</td>
      <td>100</td>
      <td>380</td>
      <td>95.0</td>
    </tr>
    <tr>
      <th>id-2</th>
      <td>50</td>
      <td>80</td>
      <td>90</td>
      <td>90</td>
      <td>310</td>
      <td>77.5</td>
    </tr>
    <tr>
      <th>id-3</th>
      <td>70</td>
      <td>100</td>
      <td>90</td>
      <td>70</td>
      <td>330</td>
      <td>82.5</td>
    </tr>
    <tr>
      <th>id-4</th>
      <td>60</td>
      <td>60</td>
      <td>90</td>
      <td>80</td>
      <td>290</td>
      <td>72.5</td>
    </tr>
    <tr>
      <th>id-5</th>
      <td>90</td>
      <td>40</td>
      <td>90</td>
      <td>100</td>
      <td>320</td>
      <td>80.0</td>
    </tr>
  </tbody>
</table>
</div>




```python
# pass column 생성

g2['PASS'] = g2['평균'] >= 80
g2
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>KOREAN</th>
      <th>ENGLISH</th>
      <th>MATH</th>
      <th>PYTHON</th>
      <th>총점</th>
      <th>평균</th>
      <th>PASS</th>
    </tr>
    <tr>
      <th>ID</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>id-1</th>
      <td>100</td>
      <td>90</td>
      <td>90</td>
      <td>100</td>
      <td>380</td>
      <td>95.0</td>
      <td>True</td>
    </tr>
    <tr>
      <th>id-2</th>
      <td>50</td>
      <td>80</td>
      <td>90</td>
      <td>90</td>
      <td>310</td>
      <td>77.5</td>
      <td>False</td>
    </tr>
    <tr>
      <th>id-3</th>
      <td>70</td>
      <td>100</td>
      <td>90</td>
      <td>70</td>
      <td>330</td>
      <td>82.5</td>
      <td>True</td>
    </tr>
    <tr>
      <th>id-4</th>
      <td>60</td>
      <td>60</td>
      <td>90</td>
      <td>80</td>
      <td>290</td>
      <td>72.5</td>
      <td>False</td>
    </tr>
    <tr>
      <th>id-5</th>
      <td>90</td>
      <td>40</td>
      <td>90</td>
      <td>100</td>
      <td>320</td>
      <td>80.0</td>
      <td>True</td>
    </tr>
  </tbody>
</table>
</div>




```python
import numpy as np

g2['PASS2']=np.where(g2['평균']>=80, '통과', '낙제') # True: 통과, False: 낙제
g2
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>KOREAN</th>
      <th>ENGLISH</th>
      <th>MATH</th>
      <th>PYTHON</th>
      <th>총점</th>
      <th>평균</th>
      <th>PASS</th>
      <th>PASS2</th>
    </tr>
    <tr>
      <th>ID</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>id-1</th>
      <td>100</td>
      <td>90</td>
      <td>90</td>
      <td>100</td>
      <td>380</td>
      <td>95.0</td>
      <td>True</td>
      <td>통과</td>
    </tr>
    <tr>
      <th>id-2</th>
      <td>50</td>
      <td>80</td>
      <td>90</td>
      <td>90</td>
      <td>310</td>
      <td>77.5</td>
      <td>False</td>
      <td>낙제</td>
    </tr>
    <tr>
      <th>id-3</th>
      <td>70</td>
      <td>100</td>
      <td>90</td>
      <td>70</td>
      <td>330</td>
      <td>82.5</td>
      <td>True</td>
      <td>통과</td>
    </tr>
    <tr>
      <th>id-4</th>
      <td>60</td>
      <td>60</td>
      <td>90</td>
      <td>80</td>
      <td>290</td>
      <td>72.5</td>
      <td>False</td>
      <td>낙제</td>
    </tr>
    <tr>
      <th>id-5</th>
      <td>90</td>
      <td>40</td>
      <td>90</td>
      <td>100</td>
      <td>320</td>
      <td>80.0</td>
      <td>True</td>
      <td>통과</td>
    </tr>
  </tbody>
</table>
</div>



# 행, 열의 값 조회
- indexer 연산자를 이용한다.
    - 행은 loc indexer, iloc indexer를 사용한다.
- 열은 indexing만 되고 slicing은 안된다.
- 행은 indexing, slicing 모두 지원한다.

## 열의 값 조회 
- **df['열이름']**
    - 열이름의 열 조회
- **df.열이름**
    - 열이름이 Python 식별자 규칙에 맞으면 **. 표기법**을 사용할 수 있다.
- **Fancy indexing**
    - 여러개의 열들을 한번에 조회할 경우 열이름들을 리스트로 묶어서 전달한다.
- **주의**
    - 열은 **순번으로는 조회할 수 없다.**
    - 열 조회 indexer에서 슬라이싱을 하면 **행 조회 Slicing이다.**
        - **만약 indexing이나 slicing을 이용해 열들을 조회하려면 columns 속성을 이용한다.**
            - `df[df.columns[:3]]`


```python
g2['KOREAN']
g2.KOREAN
```




    ID
    id-1    100
    id-2     50
    id-3     70
    id-4     60
    id-5     90
    Name: KOREAN, dtype: int64




```python
g2[['KOREAN', 'MATH']]  # 여러 컬럼 조회할때는 리스트로 묶어서 전달 -> fancy indexing
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>KOREAN</th>
      <th>MATH</th>
    </tr>
    <tr>
      <th>ID</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>id-1</th>
      <td>100</td>
      <td>90</td>
    </tr>
    <tr>
      <th>id-2</th>
      <td>50</td>
      <td>90</td>
    </tr>
    <tr>
      <th>id-3</th>
      <td>70</td>
      <td>90</td>
    </tr>
    <tr>
      <th>id-4</th>
      <td>60</td>
      <td>90</td>
    </tr>
    <tr>
      <th>id-5</th>
      <td>90</td>
      <td>90</td>
    </tr>
  </tbody>
</table>
</div>




```python
# 에러 코드
# g2['korean'] # 대소문자 구분  -> KeyError: 'korean'
# g2[0]  # 컬럼 순번으로는 조회할 수 없다.  -> KeyError: '0'
```


```python
g2.columns[1:4]
```




    Index(['ENGLISH', 'MATH', 'PYTHON'], dtype='object')




```python
col = g2.columns
g2[col[1:4]]  # 컬럼 순번으로 조회하려면 columns를 이용
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ENGLISH</th>
      <th>MATH</th>
      <th>PYTHON</th>
    </tr>
    <tr>
      <th>ID</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>id-1</th>
      <td>90</td>
      <td>90</td>
      <td>100</td>
    </tr>
    <tr>
      <th>id-2</th>
      <td>80</td>
      <td>90</td>
      <td>90</td>
    </tr>
    <tr>
      <th>id-3</th>
      <td>100</td>
      <td>90</td>
      <td>70</td>
    </tr>
    <tr>
      <th>id-4</th>
      <td>60</td>
      <td>90</td>
      <td>80</td>
    </tr>
    <tr>
      <th>id-5</th>
      <td>40</td>
      <td>90</td>
      <td>100</td>
    </tr>
  </tbody>
</table>
</div>




```python
g2[1:4]  # 행 slicing, iloc 인덱싱으로 하는 것이 더 가독성이 높다.
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>KOREAN</th>
      <th>ENGLISH</th>
      <th>MATH</th>
      <th>PYTHON</th>
      <th>총점</th>
      <th>평균</th>
      <th>PASS</th>
      <th>PASS2</th>
    </tr>
    <tr>
      <th>ID</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>id-2</th>
      <td>50</td>
      <td>80</td>
      <td>90</td>
      <td>90</td>
      <td>310</td>
      <td>77.5</td>
      <td>False</td>
      <td>낙제</td>
    </tr>
    <tr>
      <th>id-3</th>
      <td>70</td>
      <td>100</td>
      <td>90</td>
      <td>70</td>
      <td>330</td>
      <td>82.5</td>
      <td>True</td>
      <td>통과</td>
    </tr>
    <tr>
      <th>id-4</th>
      <td>60</td>
      <td>60</td>
      <td>90</td>
      <td>80</td>
      <td>290</td>
      <td>72.5</td>
      <td>False</td>
      <td>낙제</td>
    </tr>
  </tbody>
</table>
</div>



<b style='font-size:2.2em'>TODO</b>
- 다음 movie dataframe을 이용해 코드를 작성


```python
import pandas as pd
import numpy as np

movie = pd.read_csv("data/movie.csv")
movie
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>color</th>
      <th>director_name</th>
      <th>num_critic_for_reviews</th>
      <th>duration</th>
      <th>director_facebook_likes</th>
      <th>actor_3_facebook_likes</th>
      <th>actor_2_name</th>
      <th>actor_1_facebook_likes</th>
      <th>gross</th>
      <th>genres</th>
      <th>...</th>
      <th>num_user_for_reviews</th>
      <th>language</th>
      <th>country</th>
      <th>content_rating</th>
      <th>budget</th>
      <th>title_year</th>
      <th>actor_2_facebook_likes</th>
      <th>imdb_score</th>
      <th>aspect_ratio</th>
      <th>movie_facebook_likes</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Color</td>
      <td>James Cameron</td>
      <td>723.0</td>
      <td>178.0</td>
      <td>0.0</td>
      <td>855.0</td>
      <td>Joel David Moore</td>
      <td>1000.0</td>
      <td>760505847.0</td>
      <td>Action|Adventure|Fantasy|Sci-Fi</td>
      <td>...</td>
      <td>3054.0</td>
      <td>English</td>
      <td>USA</td>
      <td>PG-13</td>
      <td>237000000.0</td>
      <td>2009.0</td>
      <td>936.0</td>
      <td>7.9</td>
      <td>1.78</td>
      <td>33000</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Color</td>
      <td>Gore Verbinski</td>
      <td>302.0</td>
      <td>169.0</td>
      <td>563.0</td>
      <td>1000.0</td>
      <td>Orlando Bloom</td>
      <td>40000.0</td>
      <td>309404152.0</td>
      <td>Action|Adventure|Fantasy</td>
      <td>...</td>
      <td>1238.0</td>
      <td>English</td>
      <td>USA</td>
      <td>PG-13</td>
      <td>300000000.0</td>
      <td>2007.0</td>
      <td>5000.0</td>
      <td>7.1</td>
      <td>2.35</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Color</td>
      <td>Sam Mendes</td>
      <td>602.0</td>
      <td>148.0</td>
      <td>0.0</td>
      <td>161.0</td>
      <td>Rory Kinnear</td>
      <td>11000.0</td>
      <td>200074175.0</td>
      <td>Action|Adventure|Thriller</td>
      <td>...</td>
      <td>994.0</td>
      <td>English</td>
      <td>UK</td>
      <td>PG-13</td>
      <td>245000000.0</td>
      <td>2015.0</td>
      <td>393.0</td>
      <td>6.8</td>
      <td>2.35</td>
      <td>85000</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Color</td>
      <td>Christopher Nolan</td>
      <td>813.0</td>
      <td>164.0</td>
      <td>22000.0</td>
      <td>23000.0</td>
      <td>Christian Bale</td>
      <td>27000.0</td>
      <td>448130642.0</td>
      <td>Action|Thriller</td>
      <td>...</td>
      <td>2701.0</td>
      <td>English</td>
      <td>USA</td>
      <td>PG-13</td>
      <td>250000000.0</td>
      <td>2012.0</td>
      <td>23000.0</td>
      <td>8.5</td>
      <td>2.35</td>
      <td>164000</td>
    </tr>
    <tr>
      <th>4</th>
      <td>NaN</td>
      <td>Doug Walker</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>131.0</td>
      <td>NaN</td>
      <td>Rob Walker</td>
      <td>131.0</td>
      <td>NaN</td>
      <td>Documentary</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>12.0</td>
      <td>7.1</td>
      <td>NaN</td>
      <td>0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>4911</th>
      <td>Color</td>
      <td>Scott Smith</td>
      <td>1.0</td>
      <td>87.0</td>
      <td>2.0</td>
      <td>318.0</td>
      <td>Daphne Zuniga</td>
      <td>637.0</td>
      <td>NaN</td>
      <td>Comedy|Drama</td>
      <td>...</td>
      <td>6.0</td>
      <td>English</td>
      <td>Canada</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>2013.0</td>
      <td>470.0</td>
      <td>7.7</td>
      <td>NaN</td>
      <td>84</td>
    </tr>
    <tr>
      <th>4912</th>
      <td>Color</td>
      <td>NaN</td>
      <td>43.0</td>
      <td>43.0</td>
      <td>NaN</td>
      <td>319.0</td>
      <td>Valorie Curry</td>
      <td>841.0</td>
      <td>NaN</td>
      <td>Crime|Drama|Mystery|Thriller</td>
      <td>...</td>
      <td>359.0</td>
      <td>English</td>
      <td>USA</td>
      <td>TV-14</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>593.0</td>
      <td>7.5</td>
      <td>16.00</td>
      <td>32000</td>
    </tr>
    <tr>
      <th>4913</th>
      <td>Color</td>
      <td>Benjamin Roberds</td>
      <td>13.0</td>
      <td>76.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>Maxwell Moody</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>Drama|Horror|Thriller</td>
      <td>...</td>
      <td>3.0</td>
      <td>English</td>
      <td>USA</td>
      <td>NaN</td>
      <td>1400.0</td>
      <td>2013.0</td>
      <td>0.0</td>
      <td>6.3</td>
      <td>NaN</td>
      <td>16</td>
    </tr>
    <tr>
      <th>4914</th>
      <td>Color</td>
      <td>Daniel Hsia</td>
      <td>14.0</td>
      <td>100.0</td>
      <td>0.0</td>
      <td>489.0</td>
      <td>Daniel Henney</td>
      <td>946.0</td>
      <td>10443.0</td>
      <td>Comedy|Drama|Romance</td>
      <td>...</td>
      <td>9.0</td>
      <td>English</td>
      <td>USA</td>
      <td>PG-13</td>
      <td>NaN</td>
      <td>2012.0</td>
      <td>719.0</td>
      <td>6.3</td>
      <td>2.35</td>
      <td>660</td>
    </tr>
    <tr>
      <th>4915</th>
      <td>Color</td>
      <td>Jon Gunn</td>
      <td>43.0</td>
      <td>90.0</td>
      <td>16.0</td>
      <td>16.0</td>
      <td>Brian Herzlinger</td>
      <td>86.0</td>
      <td>85222.0</td>
      <td>Documentary</td>
      <td>...</td>
      <td>84.0</td>
      <td>English</td>
      <td>USA</td>
      <td>PG</td>
      <td>1100.0</td>
      <td>2004.0</td>
      <td>23.0</td>
      <td>6.6</td>
      <td>1.85</td>
      <td>456</td>
    </tr>
  </tbody>
</table>
<p>4916 rows × 28 columns</p>
</div>




```python
# 1.  director_name 컬럼의 값들 조회

movie['director_name']  # = movie.director_name
```




    0           James Cameron
    1          Gore Verbinski
    2              Sam Mendes
    3       Christopher Nolan
    4             Doug Walker
                  ...        
    4911          Scott Smith
    4912                  NaN
    4913     Benjamin Roberds
    4914          Daniel Hsia
    4915             Jon Gunn
    Name: director_name, Length: 4916, dtype: object




```python
# 2. actor_1_name, actor_2_name, actor_3_name 컬럼의 값들 
movie[['actor_1_name', 'actor_2_name', 'actor_3_name']] # = movie.filter(regex=r"actor_[123]_name")
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>actor_1_name</th>
      <th>actor_2_name</th>
      <th>actor_3_name</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>CCH Pounder</td>
      <td>Joel David Moore</td>
      <td>Wes Studi</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Johnny Depp</td>
      <td>Orlando Bloom</td>
      <td>Jack Davenport</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Christoph Waltz</td>
      <td>Rory Kinnear</td>
      <td>Stephanie Sigman</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Tom Hardy</td>
      <td>Christian Bale</td>
      <td>Joseph Gordon-Levitt</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Doug Walker</td>
      <td>Rob Walker</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>4911</th>
      <td>Eric Mabius</td>
      <td>Daphne Zuniga</td>
      <td>Crystal Lowe</td>
    </tr>
    <tr>
      <th>4912</th>
      <td>Natalie Zea</td>
      <td>Valorie Curry</td>
      <td>Sam Underwood</td>
    </tr>
    <tr>
      <th>4913</th>
      <td>Eva Boehnke</td>
      <td>Maxwell Moody</td>
      <td>David Chandler</td>
    </tr>
    <tr>
      <th>4914</th>
      <td>Alan Ruck</td>
      <td>Daniel Henney</td>
      <td>Eliza Coupe</td>
    </tr>
    <tr>
      <th>4915</th>
      <td>John August</td>
      <td>Brian Herzlinger</td>
      <td>Jon Gunn</td>
    </tr>
  </tbody>
</table>
<p>4916 rows × 3 columns</p>
</div>




```python
# 3. 1, 3, 4, 7 번 컬럼 조회('director_name', 'duration', 'director_facebook_likes', 'actor_1_facebook_likes')

movie[movie.columns[[1,3,4,7]]] # = movie[['director_name', 'duration', 'director_facebook_likes', 'actor_1_facebook_likes']]
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>color</th>
      <th>num_critic_for_reviews</th>
      <th>duration</th>
      <th>actor_2_name</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Color</td>
      <td>723.0</td>
      <td>178.0</td>
      <td>Joel David Moore</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Color</td>
      <td>302.0</td>
      <td>169.0</td>
      <td>Orlando Bloom</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Color</td>
      <td>602.0</td>
      <td>148.0</td>
      <td>Rory Kinnear</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Color</td>
      <td>813.0</td>
      <td>164.0</td>
      <td>Christian Bale</td>
    </tr>
    <tr>
      <th>4</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Rob Walker</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>4911</th>
      <td>Color</td>
      <td>1.0</td>
      <td>87.0</td>
      <td>Daphne Zuniga</td>
    </tr>
    <tr>
      <th>4912</th>
      <td>Color</td>
      <td>43.0</td>
      <td>43.0</td>
      <td>Valorie Curry</td>
    </tr>
    <tr>
      <th>4913</th>
      <td>Color</td>
      <td>13.0</td>
      <td>76.0</td>
      <td>Maxwell Moody</td>
    </tr>
    <tr>
      <th>4914</th>
      <td>Color</td>
      <td>14.0</td>
      <td>100.0</td>
      <td>Daniel Henney</td>
    </tr>
    <tr>
      <th>4915</th>
      <td>Color</td>
      <td>43.0</td>
      <td>90.0</td>
      <td>Brian Herzlinger</td>
    </tr>
  </tbody>
</table>
<p>4916 rows × 4 columns</p>
</div>




```python
# 4. 1 ~ 5 번 컬럼 조회('director_name', 'num_critic_for_reviews', 'duration', director_facebook_likes', 'actor_3_facebook_likes')
movie[movie.columns[1:6]]
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>director_name</th>
      <th>num_critic_for_reviews</th>
      <th>duration</th>
      <th>director_facebook_likes</th>
      <th>actor_3_facebook_likes</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>James Cameron</td>
      <td>723.0</td>
      <td>178.0</td>
      <td>0.0</td>
      <td>855.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Gore Verbinski</td>
      <td>302.0</td>
      <td>169.0</td>
      <td>563.0</td>
      <td>1000.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Sam Mendes</td>
      <td>602.0</td>
      <td>148.0</td>
      <td>0.0</td>
      <td>161.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Christopher Nolan</td>
      <td>813.0</td>
      <td>164.0</td>
      <td>22000.0</td>
      <td>23000.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Doug Walker</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>131.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>4911</th>
      <td>Scott Smith</td>
      <td>1.0</td>
      <td>87.0</td>
      <td>2.0</td>
      <td>318.0</td>
    </tr>
    <tr>
      <th>4912</th>
      <td>NaN</td>
      <td>43.0</td>
      <td>43.0</td>
      <td>NaN</td>
      <td>319.0</td>
    </tr>
    <tr>
      <th>4913</th>
      <td>Benjamin Roberds</td>
      <td>13.0</td>
      <td>76.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>4914</th>
      <td>Daniel Hsia</td>
      <td>14.0</td>
      <td>100.0</td>
      <td>0.0</td>
      <td>489.0</td>
    </tr>
    <tr>
      <th>4915</th>
      <td>Jon Gunn</td>
      <td>43.0</td>
      <td>90.0</td>
      <td>16.0</td>
      <td>16.0</td>
    </tr>
  </tbody>
</table>
<p>4916 rows × 5 columns</p>
</div>



### 다양한 열선택 기능을 제공하는 메소드들
- **`select_dtypes(include=[데이터타입,..], exclude=[데이터타입,..])`**
    - 전달한 데이터 타입의 열들을 조회. 
    - include : 조회할 열 데이터 타입
    - exclude : 제외하고 조회할 열 데이터 타입
- **`filter (items=[], like='', regex='')`**
   - 매개변수에 전달하는 열의 이름에 따라 조회
    - 각 매개변수중 하나만 사용할 수 있다.
    - **items = \[컬럼명들, ..\]**
        - 리스트와 일치하는 열들 조회
        - 이름이 일치 하지 않아도 Error 발생안함.
    - **like = '부분일치문자열'**
        - 전달한 문자열이 들어간 열들 조회
        - 부분일치 개념
    - **regex = '정규표현식'**
        - 정규 표현식을 이용해 열명의 패턴으로 조회


```python
g2.info()
```

    <class 'pandas.core.frame.DataFrame'>
    Index: 5 entries, id-1 to id-5
    Data columns (total 8 columns):
     #   Column   Non-Null Count  Dtype  
    ---  ------   --------------  -----  
     0   KOREAN   5 non-null      int64  
     1   ENGLISH  5 non-null      int64  
     2   MATH     5 non-null      int64  
     3   PYTHON   5 non-null      int64  
     4   총점       5 non-null      int64  
     5   평균       5 non-null      float64
     6   PASS     5 non-null      bool   
     7   PASS2    5 non-null      object 
    dtypes: bool(1), float64(1), int64(5), object(1)
    memory usage: 497.0+ bytes
    


```python
g2.select_dtypes(include='float64')
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>평균</th>
    </tr>
    <tr>
      <th>ID</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>id-1</th>
      <td>95.0</td>
    </tr>
    <tr>
      <th>id-2</th>
      <td>77.5</td>
    </tr>
    <tr>
      <th>id-3</th>
      <td>82.5</td>
    </tr>
    <tr>
      <th>id-4</th>
      <td>72.5</td>
    </tr>
    <tr>
      <th>id-5</th>
      <td>80.0</td>
    </tr>
  </tbody>
</table>
</div>




```python
# 컬럼(Series)의 data type을 변경
g2['MATH'] = g2['MATH'].astype('int32') # 원본은 바꾸지 않는다.
g2.info()
```

    <class 'pandas.core.frame.DataFrame'>
    Index: 5 entries, id-1 to id-5
    Data columns (total 8 columns):
     #   Column   Non-Null Count  Dtype  
    ---  ------   --------------  -----  
     0   KOREAN   5 non-null      int64  
     1   ENGLISH  5 non-null      int64  
     2   MATH     5 non-null      int32  
     3   PYTHON   5 non-null      int64  
     4   총점       5 non-null      int64  
     5   평균       5 non-null      float64
     6   PASS     5 non-null      bool   
     7   PASS2    5 non-null      object 
    dtypes: bool(1), float64(1), int32(1), int64(4), object(1)
    memory usage: 477.0+ bytes
    


```python
# 조회하려는 타입을 지정
g2.select_dtypes(include='float64')
g2.select_dtypes(include=['float64', 'int32'])
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>MATH</th>
      <th>평균</th>
    </tr>
    <tr>
      <th>ID</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>id-1</th>
      <td>90</td>
      <td>95.0</td>
    </tr>
    <tr>
      <th>id-2</th>
      <td>90</td>
      <td>77.5</td>
    </tr>
    <tr>
      <th>id-3</th>
      <td>90</td>
      <td>82.5</td>
    </tr>
    <tr>
      <th>id-4</th>
      <td>90</td>
      <td>72.5</td>
    </tr>
    <tr>
      <th>id-5</th>
      <td>90</td>
      <td>80.0</td>
    </tr>
  </tbody>
</table>
</div>




```python
# 조회대상에서 제외하려는 타입을 지정
g2.select_dtypes(exclude='int64')
g2.select_dtypes(exclude=['int32', 'int64'])
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>평균</th>
      <th>PASS</th>
      <th>PASS2</th>
    </tr>
    <tr>
      <th>ID</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>id-1</th>
      <td>95.0</td>
      <td>True</td>
      <td>통과</td>
    </tr>
    <tr>
      <th>id-2</th>
      <td>77.5</td>
      <td>False</td>
      <td>낙제</td>
    </tr>
    <tr>
      <th>id-3</th>
      <td>82.5</td>
      <td>True</td>
      <td>통과</td>
    </tr>
    <tr>
      <th>id-4</th>
      <td>72.5</td>
      <td>False</td>
      <td>낙제</td>
    </tr>
    <tr>
      <th>id-5</th>
      <td>80.0</td>
      <td>True</td>
      <td>통과</td>
    </tr>
  </tbody>
</table>
</div>




```python
# filter()
# g2['KOR'] # indexer는 없는 컬럼 조회시 Exception 발생(KeyError)
g2.filter(items='KOR') # 없는 컬럼 조회하면 Exception 발생하지 않고 무시
g2.filter(items=['KOREAN', 'ENGLISH', 'MUSIC', 'PAINTING'])  # 없는 것을 굳이 조회하지 않기 때문에 에러가 나는 편이 더 좋음
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>KOREAN</th>
      <th>ENGLISH</th>
    </tr>
    <tr>
      <th>ID</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>id-1</th>
      <td>100</td>
      <td>90</td>
    </tr>
    <tr>
      <th>id-2</th>
      <td>50</td>
      <td>80</td>
    </tr>
    <tr>
      <th>id-3</th>
      <td>70</td>
      <td>100</td>
    </tr>
    <tr>
      <th>id-4</th>
      <td>60</td>
      <td>60</td>
    </tr>
    <tr>
      <th>id-5</th>
      <td>90</td>
      <td>40</td>
    </tr>
  </tbody>
</table>
</div>




```python
# g2[['PASS', 'PASS2']]
g2.filter(like='PASS') # 칼럼명에 PASS가 들어간 컬럼을 조회, filter중에서 가장 많이 씀(나머진 별로 안씀)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>PASS</th>
      <th>PASS2</th>
    </tr>
    <tr>
      <th>ID</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>id-1</th>
      <td>True</td>
      <td>통과</td>
    </tr>
    <tr>
      <th>id-2</th>
      <td>False</td>
      <td>낙제</td>
    </tr>
    <tr>
      <th>id-3</th>
      <td>True</td>
      <td>통과</td>
    </tr>
    <tr>
      <th>id-4</th>
      <td>False</td>
      <td>낙제</td>
    </tr>
    <tr>
      <th>id-5</th>
      <td>True</td>
      <td>통과</td>
    </tr>
  </tbody>
</table>
</div>




```python
g2.filter(regex="\w{5,}")  # 컬럼 명이 5글자 이상인 컬럼들을 조회
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>KOREAN</th>
      <th>ENGLISH</th>
      <th>PYTHON</th>
      <th>PASS2</th>
    </tr>
    <tr>
      <th>ID</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>id-1</th>
      <td>100</td>
      <td>90</td>
      <td>100</td>
      <td>통과</td>
    </tr>
    <tr>
      <th>id-2</th>
      <td>50</td>
      <td>80</td>
      <td>90</td>
      <td>낙제</td>
    </tr>
    <tr>
      <th>id-3</th>
      <td>70</td>
      <td>100</td>
      <td>70</td>
      <td>통과</td>
    </tr>
    <tr>
      <th>id-4</th>
      <td>60</td>
      <td>60</td>
      <td>80</td>
      <td>낙제</td>
    </tr>
    <tr>
      <th>id-5</th>
      <td>90</td>
      <td>40</td>
      <td>100</td>
      <td>통과</td>
    </tr>
  </tbody>
</table>
</div>



<b style='font-size:2.2em'>TODO</b>

다음은 movie dataframe을 이용해 아래 코드를 작성하시오.


```python
movie.info()
```

    <class 'pandas.core.frame.DataFrame'>
    RangeIndex: 4916 entries, 0 to 4915
    Data columns (total 28 columns):
     #   Column                     Non-Null Count  Dtype  
    ---  ------                     --------------  -----  
     0   movie_title                4916 non-null   object 
     1   color                      4897 non-null   object 
     2   director_name              4814 non-null   object 
     3   num_critic_for_reviews     4867 non-null   float64
     4   duration                   4901 non-null   float64
     5   director_facebook_likes    4814 non-null   float64
     6   actor_3_facebook_likes     4893 non-null   float64
     7   actor_2_name               4903 non-null   object 
     8   actor_1_facebook_likes     4909 non-null   float64
     9   gross                      4054 non-null   float64
     10  genres                     4916 non-null   object 
     11  actor_1_name               4909 non-null   object 
     12  num_voted_users            4916 non-null   int64  
     13  cast_total_facebook_likes  4916 non-null   int64  
     14  actor_3_name               4893 non-null   object 
     15  facenumber_in_poster       4903 non-null   float64
     16  plot_keywords              4764 non-null   object 
     17  movie_imdb_link            4916 non-null   object 
     18  num_user_for_reviews       4895 non-null   float64
     19  language                   4904 non-null   object 
     20  country                    4911 non-null   object 
     21  content_rating             4616 non-null   object 
     22  budget                     4432 non-null   float64
     23  title_year                 4810 non-null   float64
     24  actor_2_facebook_likes     4903 non-null   float64
     25  imdb_score                 4916 non-null   float64
     26  aspect_ratio               4590 non-null   float64
     27  movie_facebook_likes       4916 non-null   int64  
    dtypes: float64(13), int64(3), object(12)
    memory usage: 1.1+ MB
    


```python
# 1. 정수형(int64) 컬럼만 조회
movie.select_dtypes(include = 'int64')
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>num_voted_users</th>
      <th>cast_total_facebook_likes</th>
      <th>movie_facebook_likes</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>886204</td>
      <td>4834</td>
      <td>33000</td>
    </tr>
    <tr>
      <th>1</th>
      <td>471220</td>
      <td>48350</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>275868</td>
      <td>11700</td>
      <td>85000</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1144337</td>
      <td>106759</td>
      <td>164000</td>
    </tr>
    <tr>
      <th>4</th>
      <td>8</td>
      <td>143</td>
      <td>0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>4911</th>
      <td>629</td>
      <td>2283</td>
      <td>84</td>
    </tr>
    <tr>
      <th>4912</th>
      <td>73839</td>
      <td>1753</td>
      <td>32000</td>
    </tr>
    <tr>
      <th>4913</th>
      <td>38</td>
      <td>0</td>
      <td>16</td>
    </tr>
    <tr>
      <th>4914</th>
      <td>1255</td>
      <td>2386</td>
      <td>660</td>
    </tr>
    <tr>
      <th>4915</th>
      <td>4285</td>
      <td>163</td>
      <td>456</td>
    </tr>
  </tbody>
</table>
<p>4916 rows × 3 columns</p>
</div>




```python
# 2. 정수형(int64)과 실수형(float64) 타입을 제외한 컬럼들만 조회
movie.select_dtypes(exclude = ['int64', 'float64'])
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>movie_title</th>
      <th>color</th>
      <th>director_name</th>
      <th>actor_2_name</th>
      <th>genres</th>
      <th>actor_1_name</th>
      <th>actor_3_name</th>
      <th>plot_keywords</th>
      <th>movie_imdb_link</th>
      <th>language</th>
      <th>country</th>
      <th>content_rating</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Avatar</td>
      <td>Color</td>
      <td>James Cameron</td>
      <td>Joel David Moore</td>
      <td>Action|Adventure|Fantasy|Sci-Fi</td>
      <td>CCH Pounder</td>
      <td>Wes Studi</td>
      <td>avatar|future|marine|native|paraplegic</td>
      <td>http://www.imdb.com/title/tt0499549/?ref_=fn_t...</td>
      <td>English</td>
      <td>USA</td>
      <td>PG-13</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Pirates of the Caribbean: At World's End</td>
      <td>Color</td>
      <td>Gore Verbinski</td>
      <td>Orlando Bloom</td>
      <td>Action|Adventure|Fantasy</td>
      <td>Johnny Depp</td>
      <td>Jack Davenport</td>
      <td>goddess|marriage ceremony|marriage proposal|pi...</td>
      <td>http://www.imdb.com/title/tt0449088/?ref_=fn_t...</td>
      <td>English</td>
      <td>USA</td>
      <td>PG-13</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Spectre</td>
      <td>Color</td>
      <td>Sam Mendes</td>
      <td>Rory Kinnear</td>
      <td>Action|Adventure|Thriller</td>
      <td>Christoph Waltz</td>
      <td>Stephanie Sigman</td>
      <td>bomb|espionage|sequel|spy|terrorist</td>
      <td>http://www.imdb.com/title/tt2379713/?ref_=fn_t...</td>
      <td>English</td>
      <td>UK</td>
      <td>PG-13</td>
    </tr>
    <tr>
      <th>3</th>
      <td>The Dark Knight Rises</td>
      <td>Color</td>
      <td>Christopher Nolan</td>
      <td>Christian Bale</td>
      <td>Action|Thriller</td>
      <td>Tom Hardy</td>
      <td>Joseph Gordon-Levitt</td>
      <td>deception|imprisonment|lawlessness|police offi...</td>
      <td>http://www.imdb.com/title/tt1345836/?ref_=fn_t...</td>
      <td>English</td>
      <td>USA</td>
      <td>PG-13</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Star Wars: Episode VII - The Force Awakens</td>
      <td>NaN</td>
      <td>Doug Walker</td>
      <td>Rob Walker</td>
      <td>Documentary</td>
      <td>Doug Walker</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>http://www.imdb.com/title/tt5289954/?ref_=fn_t...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>4911</th>
      <td>Signed Sealed Delivered</td>
      <td>Color</td>
      <td>Scott Smith</td>
      <td>Daphne Zuniga</td>
      <td>Comedy|Drama</td>
      <td>Eric Mabius</td>
      <td>Crystal Lowe</td>
      <td>fraud|postal worker|prison|theft|trial</td>
      <td>http://www.imdb.com/title/tt3000844/?ref_=fn_t...</td>
      <td>English</td>
      <td>Canada</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4912</th>
      <td>The Following</td>
      <td>Color</td>
      <td>NaN</td>
      <td>Valorie Curry</td>
      <td>Crime|Drama|Mystery|Thriller</td>
      <td>Natalie Zea</td>
      <td>Sam Underwood</td>
      <td>cult|fbi|hideout|prison escape|serial killer</td>
      <td>http://www.imdb.com/title/tt2071645/?ref_=fn_t...</td>
      <td>English</td>
      <td>USA</td>
      <td>TV-14</td>
    </tr>
    <tr>
      <th>4913</th>
      <td>A Plague So Pleasant</td>
      <td>Color</td>
      <td>Benjamin Roberds</td>
      <td>Maxwell Moody</td>
      <td>Drama|Horror|Thriller</td>
      <td>Eva Boehnke</td>
      <td>David Chandler</td>
      <td>NaN</td>
      <td>http://www.imdb.com/title/tt2107644/?ref_=fn_t...</td>
      <td>English</td>
      <td>USA</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4914</th>
      <td>Shanghai Calling</td>
      <td>Color</td>
      <td>Daniel Hsia</td>
      <td>Daniel Henney</td>
      <td>Comedy|Drama|Romance</td>
      <td>Alan Ruck</td>
      <td>Eliza Coupe</td>
      <td>NaN</td>
      <td>http://www.imdb.com/title/tt2070597/?ref_=fn_t...</td>
      <td>English</td>
      <td>USA</td>
      <td>PG-13</td>
    </tr>
    <tr>
      <th>4915</th>
      <td>My Date with Drew</td>
      <td>Color</td>
      <td>Jon Gunn</td>
      <td>Brian Herzlinger</td>
      <td>Documentary</td>
      <td>John August</td>
      <td>Jon Gunn</td>
      <td>actress name in title|crush|date|four word tit...</td>
      <td>http://www.imdb.com/title/tt0378407/?ref_=fn_t...</td>
      <td>English</td>
      <td>USA</td>
      <td>PG</td>
    </tr>
  </tbody>
</table>
<p>4916 rows × 12 columns</p>
</div>




```python
# 3. actor_1_name, actor_2_name, actor_3_name 컬럼의 값을 조회
movie.filter(regex = r'actor_[123]_name')
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>actor_2_name</th>
      <th>actor_1_name</th>
      <th>actor_3_name</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Joel David Moore</td>
      <td>CCH Pounder</td>
      <td>Wes Studi</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Orlando Bloom</td>
      <td>Johnny Depp</td>
      <td>Jack Davenport</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Rory Kinnear</td>
      <td>Christoph Waltz</td>
      <td>Stephanie Sigman</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Christian Bale</td>
      <td>Tom Hardy</td>
      <td>Joseph Gordon-Levitt</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Rob Walker</td>
      <td>Doug Walker</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>4911</th>
      <td>Daphne Zuniga</td>
      <td>Eric Mabius</td>
      <td>Crystal Lowe</td>
    </tr>
    <tr>
      <th>4912</th>
      <td>Valorie Curry</td>
      <td>Natalie Zea</td>
      <td>Sam Underwood</td>
    </tr>
    <tr>
      <th>4913</th>
      <td>Maxwell Moody</td>
      <td>Eva Boehnke</td>
      <td>David Chandler</td>
    </tr>
    <tr>
      <th>4914</th>
      <td>Daniel Henney</td>
      <td>Alan Ruck</td>
      <td>Eliza Coupe</td>
    </tr>
    <tr>
      <th>4915</th>
      <td>Brian Herzlinger</td>
      <td>John August</td>
      <td>Jon Gunn</td>
    </tr>
  </tbody>
</table>
<p>4916 rows × 3 columns</p>
</div>




```python
# 4. actor_1_facebook_likes, actor_1_name 컬럼의 값을 조회

movie.filter(like='actor_1') # movie.filter(regex = 'actor_1_[facebook_likes, name]')
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>actor_1_facebook_likes</th>
      <th>actor_1_name</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1000.0</td>
      <td>CCH Pounder</td>
    </tr>
    <tr>
      <th>1</th>
      <td>40000.0</td>
      <td>Johnny Depp</td>
    </tr>
    <tr>
      <th>2</th>
      <td>11000.0</td>
      <td>Christoph Waltz</td>
    </tr>
    <tr>
      <th>3</th>
      <td>27000.0</td>
      <td>Tom Hardy</td>
    </tr>
    <tr>
      <th>4</th>
      <td>131.0</td>
      <td>Doug Walker</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>4911</th>
      <td>637.0</td>
      <td>Eric Mabius</td>
    </tr>
    <tr>
      <th>4912</th>
      <td>841.0</td>
      <td>Natalie Zea</td>
    </tr>
    <tr>
      <th>4913</th>
      <td>0.0</td>
      <td>Eva Boehnke</td>
    </tr>
    <tr>
      <th>4914</th>
      <td>946.0</td>
      <td>Alan Ruck</td>
    </tr>
    <tr>
      <th>4915</th>
      <td>86.0</td>
      <td>John August</td>
    </tr>
  </tbody>
</table>
<p>4916 rows × 2 columns</p>
</div>




```python
# 5. color, director 컬럼을 조회. 없는 컬럼명이라도 에러가 안나도록 조회하시오.
movie.filter(items=['color', 'director'])
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>color</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Color</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Color</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Color</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Color</td>
    </tr>
    <tr>
      <th>4</th>
      <td>NaN</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
    </tr>
    <tr>
      <th>4911</th>
      <td>Color</td>
    </tr>
    <tr>
      <th>4912</th>
      <td>Color</td>
    </tr>
    <tr>
      <th>4913</th>
      <td>Color</td>
    </tr>
    <tr>
      <th>4914</th>
      <td>Color</td>
    </tr>
    <tr>
      <th>4915</th>
      <td>Color</td>
    </tr>
  </tbody>
</table>
<p>4916 rows × 1 columns</p>
</div>




```python
# 6. movie가 들어가는 컬럼들을 조회.
movie.filter(like='movie')
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>movie_title</th>
      <th>movie_imdb_link</th>
      <th>movie_facebook_likes</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Avatar</td>
      <td>http://www.imdb.com/title/tt0499549/?ref_=fn_t...</td>
      <td>33000</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Pirates of the Caribbean: At World's End</td>
      <td>http://www.imdb.com/title/tt0449088/?ref_=fn_t...</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Spectre</td>
      <td>http://www.imdb.com/title/tt2379713/?ref_=fn_t...</td>
      <td>85000</td>
    </tr>
    <tr>
      <th>3</th>
      <td>The Dark Knight Rises</td>
      <td>http://www.imdb.com/title/tt1345836/?ref_=fn_t...</td>
      <td>164000</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Star Wars: Episode VII - The Force Awakens</td>
      <td>http://www.imdb.com/title/tt5289954/?ref_=fn_t...</td>
      <td>0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>4911</th>
      <td>Signed Sealed Delivered</td>
      <td>http://www.imdb.com/title/tt3000844/?ref_=fn_t...</td>
      <td>84</td>
    </tr>
    <tr>
      <th>4912</th>
      <td>The Following</td>
      <td>http://www.imdb.com/title/tt2071645/?ref_=fn_t...</td>
      <td>32000</td>
    </tr>
    <tr>
      <th>4913</th>
      <td>A Plague So Pleasant</td>
      <td>http://www.imdb.com/title/tt2107644/?ref_=fn_t...</td>
      <td>16</td>
    </tr>
    <tr>
      <th>4914</th>
      <td>Shanghai Calling</td>
      <td>http://www.imdb.com/title/tt2070597/?ref_=fn_t...</td>
      <td>660</td>
    </tr>
    <tr>
      <th>4915</th>
      <td>My Date with Drew</td>
      <td>http://www.imdb.com/title/tt0378407/?ref_=fn_t...</td>
      <td>456</td>
    </tr>
  </tbody>
</table>
<p>4916 rows × 3 columns</p>
</div>



## 행 조회

- **loc** :  index 이름으로 조회
- **iloc** : 행 순번으로 조회


### loc indexer
- index name으로 조회
- **`DF.loc[ index이름 ]`**
    - 한 행 조회.
    - 조회할 행 index 이름(레이블) 전달
    - 이름이 문자열이면 " " 문자열표기법으로 전달. 정수이며 정수표기법으로 전달한다.
- **`DF.loc[ index이름 리스트 ]`**
    - 여러 행 조회. 
    - 팬시 인덱스
    - 조회할 행 index 이름(레이블) 리스트 전달
- **`DF.loc[start index이름 : end index이름: step]`**
    - 슬라이싱 지원
    - end index 이름의 행까지 포함한다.
- **`DF.loc[index이름 , 컬럼이름]`**  -> `(= DF[index이름][컬럼이름])`
    - 행과 열 조회
    - 둘다 이름으로 지정해야 함.


```python
g2.loc['id-2']
"""
index이름 ---------------------열이름

KOREAN                         50
ENGLISH                        80
MATH                           90
PYTHON                         90
총점                           310
평균                           77.5
PASS                           False
PASS2                          낙제
Name: id-2(조회 행 name), dtype: object

type의 크기: bool < int < float < str -> 큰 타입: 값이 안바뀌는 타입 ex) int -> float 값이 안바뀜 / float -> int 값이 바뀜
"""
```




    KOREAN        50
    ENGLISH       80
    MATH          90
    PYTHON        90
    총점           310
    평균          77.5
    PASS       False
    PASS2         낙제
    Name: id-2, dtype: object




```python
g2.loc[['id-2', 'id-3']]  # 같은 항목의 여러개를 정의할 경우 리스트 형식으로 뭉쳐서 지원한다.
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>KOREAN</th>
      <th>ENGLISH</th>
      <th>MATH</th>
      <th>PYTHON</th>
      <th>총점</th>
      <th>평균</th>
      <th>PASS</th>
      <th>PASS2</th>
    </tr>
    <tr>
      <th>ID</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>id-2</th>
      <td>50</td>
      <td>80</td>
      <td>90</td>
      <td>90</td>
      <td>310</td>
      <td>77.5</td>
      <td>False</td>
      <td>낙제</td>
    </tr>
    <tr>
      <th>id-3</th>
      <td>70</td>
      <td>100</td>
      <td>90</td>
      <td>70</td>
      <td>330</td>
      <td>82.5</td>
      <td>True</td>
      <td>통과</td>
    </tr>
  </tbody>
</table>
</div>




```python
# 행조회는 slicing을 지원
g2.loc['id-2':'id-5']  # stop index도 포함
g2.loc['id-2':'id-5':2]
g2.loc['id-2':] # stop 생략 => 마지막 행까지 다 조회
g2.loc[:'id-3'] # start 생략 => 시작 행(0번 행)부터 조회
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>KOREAN</th>
      <th>ENGLISH</th>
      <th>MATH</th>
      <th>PYTHON</th>
      <th>총점</th>
      <th>평균</th>
      <th>PASS</th>
      <th>PASS2</th>
    </tr>
    <tr>
      <th>ID</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>id-1</th>
      <td>100</td>
      <td>90</td>
      <td>90</td>
      <td>100</td>
      <td>380</td>
      <td>95.0</td>
      <td>True</td>
      <td>통과</td>
    </tr>
    <tr>
      <th>id-2</th>
      <td>50</td>
      <td>80</td>
      <td>90</td>
      <td>90</td>
      <td>310</td>
      <td>77.5</td>
      <td>False</td>
      <td>낙제</td>
    </tr>
    <tr>
      <th>id-3</th>
      <td>70</td>
      <td>100</td>
      <td>90</td>
      <td>70</td>
      <td>330</td>
      <td>82.5</td>
      <td>True</td>
      <td>통과</td>
    </tr>
  </tbody>
</table>
</div>




```python
# g2.loc['id-2']['KOREAN']  # 내부적으로 2번 조회
g2.loc['id-2', 'KOREAN'] # 순서를 바꾸면 안됨
# df.loc[ 행조회, 열조회 ] ==> 행/열 모두 이름, fancy slicing 등 행조회나 열조회 할 수 있는 거를 다 넣을 수 있다.
```




    50




```python
g2.loc[['id-2', 'id-3', 'id-5'], '총점']  # 행: fancy indexing, 열: 하나를 지정
g2.loc[['id-2', 'id-3', 'id-5'], ['총점', '평균']] # 행: fancy indexing, 열: fancy indexing
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>총점</th>
      <th>평균</th>
    </tr>
    <tr>
      <th>ID</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>id-2</th>
      <td>310</td>
      <td>77.5</td>
    </tr>
    <tr>
      <th>id-3</th>
      <td>330</td>
      <td>82.5</td>
    </tr>
    <tr>
      <th>id-5</th>
      <td>320</td>
      <td>80.0</td>
    </tr>
  </tbody>
</table>
</div>




```python
g2.loc['id-2', :'PYTHON'] # 행: 하나를 지정, 열: slicing (loc에서는 열도 slicing 가능)
```




    KOREAN     50
    ENGLISH    80
    MATH       90
    PYTHON     90
    Name: id-2, dtype: object




```python
g2
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>KOREAN</th>
      <th>ENGLISH</th>
      <th>MATH</th>
      <th>PYTHON</th>
      <th>총점</th>
      <th>평균</th>
      <th>PASS</th>
      <th>PASS2</th>
    </tr>
    <tr>
      <th>ID</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>id-1</th>
      <td>100</td>
      <td>90</td>
      <td>90</td>
      <td>100</td>
      <td>380</td>
      <td>95.0</td>
      <td>True</td>
      <td>통과</td>
    </tr>
    <tr>
      <th>id-2</th>
      <td>50</td>
      <td>80</td>
      <td>90</td>
      <td>90</td>
      <td>310</td>
      <td>77.5</td>
      <td>False</td>
      <td>낙제</td>
    </tr>
    <tr>
      <th>id-3</th>
      <td>70</td>
      <td>100</td>
      <td>90</td>
      <td>70</td>
      <td>330</td>
      <td>82.5</td>
      <td>True</td>
      <td>통과</td>
    </tr>
    <tr>
      <th>id-4</th>
      <td>60</td>
      <td>60</td>
      <td>90</td>
      <td>80</td>
      <td>290</td>
      <td>72.5</td>
      <td>False</td>
      <td>낙제</td>
    </tr>
    <tr>
      <th>id-5</th>
      <td>90</td>
      <td>40</td>
      <td>90</td>
      <td>100</td>
      <td>320</td>
      <td>80.0</td>
      <td>True</td>
      <td>통과</td>
    </tr>
  </tbody>
</table>
</div>




```python
g2.loc['id-2':'id-4', 'ENGLISH':'평균']  # 행/열 모두 slicing
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ENGLISH</th>
      <th>MATH</th>
      <th>PYTHON</th>
      <th>총점</th>
      <th>평균</th>
    </tr>
    <tr>
      <th>ID</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>id-2</th>
      <td>80</td>
      <td>90</td>
      <td>90</td>
      <td>310</td>
      <td>77.5</td>
    </tr>
    <tr>
      <th>id-3</th>
      <td>100</td>
      <td>90</td>
      <td>70</td>
      <td>330</td>
      <td>82.5</td>
    </tr>
    <tr>
      <th>id-4</th>
      <td>60</td>
      <td>90</td>
      <td>80</td>
      <td>290</td>
      <td>72.5</td>
    </tr>
  </tbody>
</table>
</div>




```python
g2.loc['id-2', 0] # 컬럼명이 0인 컬럼조회, loc index는 행/열 모두 이름으로 조회
```


    ---------------------------------------------------------------------------

    KeyError                                  Traceback (most recent call last)

    File ~\anaconda3\envs\ml\lib\site-packages\pandas\core\indexes\base.py:3803, in Index.get_loc(self, key, method, tolerance)
       3802 try:
    -> 3803     return self._engine.get_loc(casted_key)
       3804 except KeyError as err:
    

    File ~\anaconda3\envs\ml\lib\site-packages\pandas\_libs\index.pyx:138, in pandas._libs.index.IndexEngine.get_loc()
    

    File ~\anaconda3\envs\ml\lib\site-packages\pandas\_libs\index.pyx:165, in pandas._libs.index.IndexEngine.get_loc()
    

    File pandas\_libs\hashtable_class_helper.pxi:5745, in pandas._libs.hashtable.PyObjectHashTable.get_item()
    

    File pandas\_libs\hashtable_class_helper.pxi:5753, in pandas._libs.hashtable.PyObjectHashTable.get_item()
    

    KeyError: 0

    
    The above exception was the direct cause of the following exception:
    

    KeyError                                  Traceback (most recent call last)

    Cell In[178], line 1
    ----> 1 g2.loc['id-2', 0] # 컬럼명이 0인 컬럼조회
    

    File ~\anaconda3\envs\ml\lib\site-packages\pandas\core\indexing.py:1066, in _LocationIndexer.__getitem__(self, key)
       1064     key = tuple(com.apply_if_callable(x, self.obj) for x in key)
       1065     if self._is_scalar_access(key):
    -> 1066         return self.obj._get_value(*key, takeable=self._takeable)
       1067     return self._getitem_tuple(key)
       1068 else:
       1069     # we by definition only have the 0th axis
    

    File ~\anaconda3\envs\ml\lib\site-packages\pandas\core\frame.py:3915, in DataFrame._get_value(self, index, col, takeable)
       3912     series = self._ixs(col, axis=1)
       3913     return series._values[index]
    -> 3915 series = self._get_item_cache(col)
       3916 engine = self.index._engine
       3918 if not isinstance(self.index, MultiIndex):
       3919     # CategoricalIndex: Trying to use the engine fastpath may give incorrect
       3920     #  results if our categories are integers that dont match our codes
       3921     # IntervalIndex: IntervalTree has no get_loc
    

    File ~\anaconda3\envs\ml\lib\site-packages\pandas\core\frame.py:4279, in DataFrame._get_item_cache(self, item)
       4274 res = cache.get(item)
       4275 if res is None:
       4276     # All places that call _get_item_cache have unique columns,
       4277     #  pending resolution of GH#33047
    -> 4279     loc = self.columns.get_loc(item)
       4280     res = self._ixs(loc, axis=1)
       4282     cache[item] = res
    

    File ~\anaconda3\envs\ml\lib\site-packages\pandas\core\indexes\base.py:3805, in Index.get_loc(self, key, method, tolerance)
       3803     return self._engine.get_loc(casted_key)
       3804 except KeyError as err:
    -> 3805     raise KeyError(key) from err
       3806 except TypeError:
       3807     # If we have a listlike key, _check_indexing_error will raise
       3808     #  InvalidIndexError. Otherwise we fall through and re-raise
       3809     #  the TypeError.
       3810     self._check_indexing_error(key)
    

    KeyError: 0


### iloc 
- index(행 순번)으로 조회
- **`DF.iloc[행번호]`**
    - 한 행 조회.
    - 조회할 행 번호 전달
- **`DF.iloc[ 행번호 리스트 ]`**
    - 여러 행 조회.
    - 조회할 행 번호 리스트 전달
- **`DF.iloc[start 행번호: stop 행번호: step]`**
    - 슬라이싱 지원
    - stop 행번호 포함 안함.
- **`DF.iloc[행번호 , 열번호]`**
    - 행과 열 조회
    - 행열 모두 순번으로 지정


```python
# g2[2] # 컬럼 이름이 2인 열을 조회
# g2.loc[2] # 행(index) 이름이 2인 행을 조회
g2.iloc[2] # index(순번)가 2인 행을 조회
```




    KOREAN       70
    ENGLISH     100
    MATH         90
    PYTHON       70
    총점          330
    평균         82.5
    PASS       True
    PASS2        통과
    Name: id-3, dtype: object




```python
g2.iloc[[2,1,4]] # fancy indexing : list로 묶어서 전달
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>KOREAN</th>
      <th>ENGLISH</th>
      <th>MATH</th>
      <th>PYTHON</th>
      <th>총점</th>
      <th>평균</th>
      <th>PASS</th>
      <th>PASS2</th>
    </tr>
    <tr>
      <th>ID</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>id-3</th>
      <td>70</td>
      <td>100</td>
      <td>90</td>
      <td>70</td>
      <td>330</td>
      <td>82.5</td>
      <td>True</td>
      <td>통과</td>
    </tr>
    <tr>
      <th>id-2</th>
      <td>50</td>
      <td>80</td>
      <td>90</td>
      <td>90</td>
      <td>310</td>
      <td>77.5</td>
      <td>False</td>
      <td>낙제</td>
    </tr>
    <tr>
      <th>id-5</th>
      <td>90</td>
      <td>40</td>
      <td>90</td>
      <td>100</td>
      <td>320</td>
      <td>80.0</td>
      <td>True</td>
      <td>통과</td>
    </tr>
  </tbody>
</table>
</div>




```python
g2.iloc[1:4] # iloc의 slicing은 stop index에 포함안함
g2.iloc[-3:] # 뒤에서 3번째 행 ~ 끝까지
# g2.tail(3)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>KOREAN</th>
      <th>ENGLISH</th>
      <th>MATH</th>
      <th>PYTHON</th>
      <th>총점</th>
      <th>평균</th>
      <th>PASS</th>
      <th>PASS2</th>
    </tr>
    <tr>
      <th>ID</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>id-3</th>
      <td>70</td>
      <td>100</td>
      <td>90</td>
      <td>70</td>
      <td>330</td>
      <td>82.5</td>
      <td>True</td>
      <td>통과</td>
    </tr>
    <tr>
      <th>id-4</th>
      <td>60</td>
      <td>60</td>
      <td>90</td>
      <td>80</td>
      <td>290</td>
      <td>72.5</td>
      <td>False</td>
      <td>낙제</td>
    </tr>
    <tr>
      <th>id-5</th>
      <td>90</td>
      <td>40</td>
      <td>90</td>
      <td>100</td>
      <td>320</td>
      <td>80.0</td>
      <td>True</td>
      <td>통과</td>
    </tr>
  </tbody>
</table>
</div>




```python
g2.iloc[::-1]
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>KOREAN</th>
      <th>ENGLISH</th>
      <th>MATH</th>
      <th>PYTHON</th>
      <th>총점</th>
      <th>평균</th>
      <th>PASS</th>
      <th>PASS2</th>
    </tr>
    <tr>
      <th>ID</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>id-5</th>
      <td>90</td>
      <td>40</td>
      <td>90</td>
      <td>100</td>
      <td>320</td>
      <td>80.0</td>
      <td>True</td>
      <td>통과</td>
    </tr>
    <tr>
      <th>id-4</th>
      <td>60</td>
      <td>60</td>
      <td>90</td>
      <td>80</td>
      <td>290</td>
      <td>72.5</td>
      <td>False</td>
      <td>낙제</td>
    </tr>
    <tr>
      <th>id-3</th>
      <td>70</td>
      <td>100</td>
      <td>90</td>
      <td>70</td>
      <td>330</td>
      <td>82.5</td>
      <td>True</td>
      <td>통과</td>
    </tr>
    <tr>
      <th>id-2</th>
      <td>50</td>
      <td>80</td>
      <td>90</td>
      <td>90</td>
      <td>310</td>
      <td>77.5</td>
      <td>False</td>
      <td>낙제</td>
    </tr>
    <tr>
      <th>id-1</th>
      <td>100</td>
      <td>90</td>
      <td>90</td>
      <td>100</td>
      <td>380</td>
      <td>95.0</td>
      <td>True</td>
      <td>통과</td>
    </tr>
  </tbody>
</table>
</div>




```python
# g2.iloc[3, 'ENGLISH'] # iloc[행 순번, 열 순번] 
                        # 둘 다 순번을 이용해서 지정.(indexing, slicing, fancy indexing 문법 사용가능)
g2.iloc[3, 1]
g2.iloc[[1,3],[2,5]]
g2.iloc[[1,3], :4]
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>KOREAN</th>
      <th>ENGLISH</th>
      <th>MATH</th>
      <th>PYTHON</th>
    </tr>
    <tr>
      <th>ID</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>id-2</th>
      <td>50</td>
      <td>80</td>
      <td>90</td>
      <td>90</td>
    </tr>
    <tr>
      <th>id-4</th>
      <td>60</td>
      <td>60</td>
      <td>90</td>
      <td>80</td>
    </tr>
  </tbody>
</table>
</div>



<b style='font-size:2.2em'>TODO</b>
- movie dataframe을 이용해 loc과 iloc관련해 다음을 작성


```python
# 1.  movie_title 컬럼을 index명으로 지정
movie.set_index('movie_title', inplace=True)
movie
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>color</th>
      <th>director_name</th>
      <th>num_critic_for_reviews</th>
      <th>duration</th>
      <th>director_facebook_likes</th>
      <th>actor_3_facebook_likes</th>
      <th>actor_2_name</th>
      <th>actor_1_facebook_likes</th>
      <th>gross</th>
      <th>genres</th>
      <th>...</th>
      <th>num_user_for_reviews</th>
      <th>language</th>
      <th>country</th>
      <th>content_rating</th>
      <th>budget</th>
      <th>title_year</th>
      <th>actor_2_facebook_likes</th>
      <th>imdb_score</th>
      <th>aspect_ratio</th>
      <th>movie_facebook_likes</th>
    </tr>
    <tr>
      <th>movie_title</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Avatar</th>
      <td>Color</td>
      <td>James Cameron</td>
      <td>723.0</td>
      <td>178.0</td>
      <td>0.0</td>
      <td>855.0</td>
      <td>Joel David Moore</td>
      <td>1000.0</td>
      <td>760505847.0</td>
      <td>Action|Adventure|Fantasy|Sci-Fi</td>
      <td>...</td>
      <td>3054.0</td>
      <td>English</td>
      <td>USA</td>
      <td>PG-13</td>
      <td>237000000.0</td>
      <td>2009.0</td>
      <td>936.0</td>
      <td>7.9</td>
      <td>1.78</td>
      <td>33000</td>
    </tr>
    <tr>
      <th>Pirates of the Caribbean: At World's End</th>
      <td>Color</td>
      <td>Gore Verbinski</td>
      <td>302.0</td>
      <td>169.0</td>
      <td>563.0</td>
      <td>1000.0</td>
      <td>Orlando Bloom</td>
      <td>40000.0</td>
      <td>309404152.0</td>
      <td>Action|Adventure|Fantasy</td>
      <td>...</td>
      <td>1238.0</td>
      <td>English</td>
      <td>USA</td>
      <td>PG-13</td>
      <td>300000000.0</td>
      <td>2007.0</td>
      <td>5000.0</td>
      <td>7.1</td>
      <td>2.35</td>
      <td>0</td>
    </tr>
    <tr>
      <th>Spectre</th>
      <td>Color</td>
      <td>Sam Mendes</td>
      <td>602.0</td>
      <td>148.0</td>
      <td>0.0</td>
      <td>161.0</td>
      <td>Rory Kinnear</td>
      <td>11000.0</td>
      <td>200074175.0</td>
      <td>Action|Adventure|Thriller</td>
      <td>...</td>
      <td>994.0</td>
      <td>English</td>
      <td>UK</td>
      <td>PG-13</td>
      <td>245000000.0</td>
      <td>2015.0</td>
      <td>393.0</td>
      <td>6.8</td>
      <td>2.35</td>
      <td>85000</td>
    </tr>
    <tr>
      <th>The Dark Knight Rises</th>
      <td>Color</td>
      <td>Christopher Nolan</td>
      <td>813.0</td>
      <td>164.0</td>
      <td>22000.0</td>
      <td>23000.0</td>
      <td>Christian Bale</td>
      <td>27000.0</td>
      <td>448130642.0</td>
      <td>Action|Thriller</td>
      <td>...</td>
      <td>2701.0</td>
      <td>English</td>
      <td>USA</td>
      <td>PG-13</td>
      <td>250000000.0</td>
      <td>2012.0</td>
      <td>23000.0</td>
      <td>8.5</td>
      <td>2.35</td>
      <td>164000</td>
    </tr>
    <tr>
      <th>Star Wars: Episode VII - The Force Awakens</th>
      <td>NaN</td>
      <td>Doug Walker</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>131.0</td>
      <td>NaN</td>
      <td>Rob Walker</td>
      <td>131.0</td>
      <td>NaN</td>
      <td>Documentary</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>12.0</td>
      <td>7.1</td>
      <td>NaN</td>
      <td>0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>Signed Sealed Delivered</th>
      <td>Color</td>
      <td>Scott Smith</td>
      <td>1.0</td>
      <td>87.0</td>
      <td>2.0</td>
      <td>318.0</td>
      <td>Daphne Zuniga</td>
      <td>637.0</td>
      <td>NaN</td>
      <td>Comedy|Drama</td>
      <td>...</td>
      <td>6.0</td>
      <td>English</td>
      <td>Canada</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>2013.0</td>
      <td>470.0</td>
      <td>7.7</td>
      <td>NaN</td>
      <td>84</td>
    </tr>
    <tr>
      <th>The Following</th>
      <td>Color</td>
      <td>NaN</td>
      <td>43.0</td>
      <td>43.0</td>
      <td>NaN</td>
      <td>319.0</td>
      <td>Valorie Curry</td>
      <td>841.0</td>
      <td>NaN</td>
      <td>Crime|Drama|Mystery|Thriller</td>
      <td>...</td>
      <td>359.0</td>
      <td>English</td>
      <td>USA</td>
      <td>TV-14</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>593.0</td>
      <td>7.5</td>
      <td>16.00</td>
      <td>32000</td>
    </tr>
    <tr>
      <th>A Plague So Pleasant</th>
      <td>Color</td>
      <td>Benjamin Roberds</td>
      <td>13.0</td>
      <td>76.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>Maxwell Moody</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>Drama|Horror|Thriller</td>
      <td>...</td>
      <td>3.0</td>
      <td>English</td>
      <td>USA</td>
      <td>NaN</td>
      <td>1400.0</td>
      <td>2013.0</td>
      <td>0.0</td>
      <td>6.3</td>
      <td>NaN</td>
      <td>16</td>
    </tr>
    <tr>
      <th>Shanghai Calling</th>
      <td>Color</td>
      <td>Daniel Hsia</td>
      <td>14.0</td>
      <td>100.0</td>
      <td>0.0</td>
      <td>489.0</td>
      <td>Daniel Henney</td>
      <td>946.0</td>
      <td>10443.0</td>
      <td>Comedy|Drama|Romance</td>
      <td>...</td>
      <td>9.0</td>
      <td>English</td>
      <td>USA</td>
      <td>PG-13</td>
      <td>NaN</td>
      <td>2012.0</td>
      <td>719.0</td>
      <td>6.3</td>
      <td>2.35</td>
      <td>660</td>
    </tr>
    <tr>
      <th>My Date with Drew</th>
      <td>Color</td>
      <td>Jon Gunn</td>
      <td>43.0</td>
      <td>90.0</td>
      <td>16.0</td>
      <td>16.0</td>
      <td>Brian Herzlinger</td>
      <td>86.0</td>
      <td>85222.0</td>
      <td>Documentary</td>
      <td>...</td>
      <td>84.0</td>
      <td>English</td>
      <td>USA</td>
      <td>PG</td>
      <td>1100.0</td>
      <td>2004.0</td>
      <td>23.0</td>
      <td>6.6</td>
      <td>1.85</td>
      <td>456</td>
    </tr>
  </tbody>
</table>
<p>4916 rows × 27 columns</p>
</div>




```python
# 2.  행이름이 Avatar인 행 조회
movie.loc['Avatar']
```




    color                                                                    Color
    director_name                                                    James Cameron
    num_critic_for_reviews                                                   723.0
    duration                                                                 178.0
    director_facebook_likes                                                    0.0
    actor_3_facebook_likes                                                   855.0
    actor_2_name                                                  Joel David Moore
    actor_1_facebook_likes                                                  1000.0
    gross                                                              760505847.0
    genres                                         Action|Adventure|Fantasy|Sci-Fi
    actor_1_name                                                       CCH Pounder
    num_voted_users                                                         886204
    cast_total_facebook_likes                                                 4834
    actor_3_name                                                         Wes Studi
    facenumber_in_poster                                                       0.0
    plot_keywords                           avatar|future|marine|native|paraplegic
    movie_imdb_link              http://www.imdb.com/title/tt0499549/?ref_=fn_t...
    num_user_for_reviews                                                    3054.0
    language                                                               English
    country                                                                    USA
    content_rating                                                           PG-13
    budget                                                             237000000.0
    title_year                                                              2009.0
    actor_2_facebook_likes                                                   936.0
    imdb_score                                                                 7.9
    aspect_ratio                                                              1.78
    movie_facebook_likes                                                     33000
    Name: Avatar, dtype: object




```python
# 3.  행이름이 Spider-Man 3, The Avengers, Titanic 인 행 조회
movie.loc[['Spider-Man 3', 'The Avengers', 'Titanic']]
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>color</th>
      <th>director_name</th>
      <th>num_critic_for_reviews</th>
      <th>duration</th>
      <th>director_facebook_likes</th>
      <th>actor_3_facebook_likes</th>
      <th>actor_2_name</th>
      <th>actor_1_facebook_likes</th>
      <th>gross</th>
      <th>genres</th>
      <th>...</th>
      <th>num_user_for_reviews</th>
      <th>language</th>
      <th>country</th>
      <th>content_rating</th>
      <th>budget</th>
      <th>title_year</th>
      <th>actor_2_facebook_likes</th>
      <th>imdb_score</th>
      <th>aspect_ratio</th>
      <th>movie_facebook_likes</th>
    </tr>
    <tr>
      <th>movie_title</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Spider-Man 3</th>
      <td>Color</td>
      <td>Sam Raimi</td>
      <td>392.0</td>
      <td>156.0</td>
      <td>0.0</td>
      <td>4000.0</td>
      <td>James Franco</td>
      <td>24000.0</td>
      <td>336530303.0</td>
      <td>Action|Adventure|Romance</td>
      <td>...</td>
      <td>1902.0</td>
      <td>English</td>
      <td>USA</td>
      <td>PG-13</td>
      <td>258000000.0</td>
      <td>2007.0</td>
      <td>11000.0</td>
      <td>6.2</td>
      <td>2.35</td>
      <td>0</td>
    </tr>
    <tr>
      <th>The Avengers</th>
      <td>Color</td>
      <td>Joss Whedon</td>
      <td>703.0</td>
      <td>173.0</td>
      <td>0.0</td>
      <td>19000.0</td>
      <td>Robert Downey Jr.</td>
      <td>26000.0</td>
      <td>623279547.0</td>
      <td>Action|Adventure|Sci-Fi</td>
      <td>...</td>
      <td>1722.0</td>
      <td>English</td>
      <td>USA</td>
      <td>PG-13</td>
      <td>220000000.0</td>
      <td>2012.0</td>
      <td>21000.0</td>
      <td>8.1</td>
      <td>1.85</td>
      <td>123000</td>
    </tr>
    <tr>
      <th>Titanic</th>
      <td>Color</td>
      <td>James Cameron</td>
      <td>315.0</td>
      <td>194.0</td>
      <td>0.0</td>
      <td>794.0</td>
      <td>Kate Winslet</td>
      <td>29000.0</td>
      <td>658672302.0</td>
      <td>Drama|Romance</td>
      <td>...</td>
      <td>2528.0</td>
      <td>English</td>
      <td>USA</td>
      <td>PG-13</td>
      <td>200000000.0</td>
      <td>1997.0</td>
      <td>14000.0</td>
      <td>7.7</td>
      <td>2.35</td>
      <td>26000</td>
    </tr>
  </tbody>
</table>
<p>3 rows × 27 columns</p>
</div>




```python
# 4.  행이름 Spectre ~ Robin Hood 까지 범위로 조회
movie.loc['Spectre':'Robin Hood']
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>color</th>
      <th>director_name</th>
      <th>num_critic_for_reviews</th>
      <th>duration</th>
      <th>director_facebook_likes</th>
      <th>actor_3_facebook_likes</th>
      <th>actor_2_name</th>
      <th>actor_1_facebook_likes</th>
      <th>gross</th>
      <th>genres</th>
      <th>...</th>
      <th>num_user_for_reviews</th>
      <th>language</th>
      <th>country</th>
      <th>content_rating</th>
      <th>budget</th>
      <th>title_year</th>
      <th>actor_2_facebook_likes</th>
      <th>imdb_score</th>
      <th>aspect_ratio</th>
      <th>movie_facebook_likes</th>
    </tr>
    <tr>
      <th>movie_title</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Spectre</th>
      <td>Color</td>
      <td>Sam Mendes</td>
      <td>602.0</td>
      <td>148.0</td>
      <td>0.0</td>
      <td>161.0</td>
      <td>Rory Kinnear</td>
      <td>11000.0</td>
      <td>200074175.0</td>
      <td>Action|Adventure|Thriller</td>
      <td>...</td>
      <td>994.0</td>
      <td>English</td>
      <td>UK</td>
      <td>PG-13</td>
      <td>245000000.0</td>
      <td>2015.0</td>
      <td>393.0</td>
      <td>6.8</td>
      <td>2.35</td>
      <td>85000</td>
    </tr>
    <tr>
      <th>The Dark Knight Rises</th>
      <td>Color</td>
      <td>Christopher Nolan</td>
      <td>813.0</td>
      <td>164.0</td>
      <td>22000.0</td>
      <td>23000.0</td>
      <td>Christian Bale</td>
      <td>27000.0</td>
      <td>448130642.0</td>
      <td>Action|Thriller</td>
      <td>...</td>
      <td>2701.0</td>
      <td>English</td>
      <td>USA</td>
      <td>PG-13</td>
      <td>250000000.0</td>
      <td>2012.0</td>
      <td>23000.0</td>
      <td>8.5</td>
      <td>2.35</td>
      <td>164000</td>
    </tr>
    <tr>
      <th>Star Wars: Episode VII - The Force Awakens</th>
      <td>NaN</td>
      <td>Doug Walker</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>131.0</td>
      <td>NaN</td>
      <td>Rob Walker</td>
      <td>131.0</td>
      <td>NaN</td>
      <td>Documentary</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>12.0</td>
      <td>7.1</td>
      <td>NaN</td>
      <td>0</td>
    </tr>
    <tr>
      <th>John Carter</th>
      <td>Color</td>
      <td>Andrew Stanton</td>
      <td>462.0</td>
      <td>132.0</td>
      <td>475.0</td>
      <td>530.0</td>
      <td>Samantha Morton</td>
      <td>640.0</td>
      <td>73058679.0</td>
      <td>Action|Adventure|Sci-Fi</td>
      <td>...</td>
      <td>738.0</td>
      <td>English</td>
      <td>USA</td>
      <td>PG-13</td>
      <td>263700000.0</td>
      <td>2012.0</td>
      <td>632.0</td>
      <td>6.6</td>
      <td>2.35</td>
      <td>24000</td>
    </tr>
    <tr>
      <th>Spider-Man 3</th>
      <td>Color</td>
      <td>Sam Raimi</td>
      <td>392.0</td>
      <td>156.0</td>
      <td>0.0</td>
      <td>4000.0</td>
      <td>James Franco</td>
      <td>24000.0</td>
      <td>336530303.0</td>
      <td>Action|Adventure|Romance</td>
      <td>...</td>
      <td>1902.0</td>
      <td>English</td>
      <td>USA</td>
      <td>PG-13</td>
      <td>258000000.0</td>
      <td>2007.0</td>
      <td>11000.0</td>
      <td>6.2</td>
      <td>2.35</td>
      <td>0</td>
    </tr>
    <tr>
      <th>Tangled</th>
      <td>Color</td>
      <td>Nathan Greno</td>
      <td>324.0</td>
      <td>100.0</td>
      <td>15.0</td>
      <td>284.0</td>
      <td>Donna Murphy</td>
      <td>799.0</td>
      <td>200807262.0</td>
      <td>Adventure|Animation|Comedy|Family|Fantasy|Musi...</td>
      <td>...</td>
      <td>387.0</td>
      <td>English</td>
      <td>USA</td>
      <td>PG</td>
      <td>260000000.0</td>
      <td>2010.0</td>
      <td>553.0</td>
      <td>7.8</td>
      <td>1.85</td>
      <td>29000</td>
    </tr>
    <tr>
      <th>Avengers: Age of Ultron</th>
      <td>Color</td>
      <td>Joss Whedon</td>
      <td>635.0</td>
      <td>141.0</td>
      <td>0.0</td>
      <td>19000.0</td>
      <td>Robert Downey Jr.</td>
      <td>26000.0</td>
      <td>458991599.0</td>
      <td>Action|Adventure|Sci-Fi</td>
      <td>...</td>
      <td>1117.0</td>
      <td>English</td>
      <td>USA</td>
      <td>PG-13</td>
      <td>250000000.0</td>
      <td>2015.0</td>
      <td>21000.0</td>
      <td>7.5</td>
      <td>2.35</td>
      <td>118000</td>
    </tr>
    <tr>
      <th>Harry Potter and the Half-Blood Prince</th>
      <td>Color</td>
      <td>David Yates</td>
      <td>375.0</td>
      <td>153.0</td>
      <td>282.0</td>
      <td>10000.0</td>
      <td>Daniel Radcliffe</td>
      <td>25000.0</td>
      <td>301956980.0</td>
      <td>Adventure|Family|Fantasy|Mystery</td>
      <td>...</td>
      <td>973.0</td>
      <td>English</td>
      <td>UK</td>
      <td>PG</td>
      <td>250000000.0</td>
      <td>2009.0</td>
      <td>11000.0</td>
      <td>7.5</td>
      <td>2.35</td>
      <td>10000</td>
    </tr>
    <tr>
      <th>Batman v Superman: Dawn of Justice</th>
      <td>Color</td>
      <td>Zack Snyder</td>
      <td>673.0</td>
      <td>183.0</td>
      <td>0.0</td>
      <td>2000.0</td>
      <td>Lauren Cohan</td>
      <td>15000.0</td>
      <td>330249062.0</td>
      <td>Action|Adventure|Sci-Fi</td>
      <td>...</td>
      <td>3018.0</td>
      <td>English</td>
      <td>USA</td>
      <td>PG-13</td>
      <td>250000000.0</td>
      <td>2016.0</td>
      <td>4000.0</td>
      <td>6.9</td>
      <td>2.35</td>
      <td>197000</td>
    </tr>
    <tr>
      <th>Superman Returns</th>
      <td>Color</td>
      <td>Bryan Singer</td>
      <td>434.0</td>
      <td>169.0</td>
      <td>0.0</td>
      <td>903.0</td>
      <td>Marlon Brando</td>
      <td>18000.0</td>
      <td>200069408.0</td>
      <td>Action|Adventure|Sci-Fi</td>
      <td>...</td>
      <td>2367.0</td>
      <td>English</td>
      <td>USA</td>
      <td>PG-13</td>
      <td>209000000.0</td>
      <td>2006.0</td>
      <td>10000.0</td>
      <td>6.1</td>
      <td>2.35</td>
      <td>0</td>
    </tr>
    <tr>
      <th>Quantum of Solace</th>
      <td>Color</td>
      <td>Marc Forster</td>
      <td>403.0</td>
      <td>106.0</td>
      <td>395.0</td>
      <td>393.0</td>
      <td>Mathieu Amalric</td>
      <td>451.0</td>
      <td>168368427.0</td>
      <td>Action|Adventure</td>
      <td>...</td>
      <td>1243.0</td>
      <td>English</td>
      <td>UK</td>
      <td>PG-13</td>
      <td>200000000.0</td>
      <td>2008.0</td>
      <td>412.0</td>
      <td>6.7</td>
      <td>2.35</td>
      <td>0</td>
    </tr>
    <tr>
      <th>Pirates of the Caribbean: Dead Man's Chest</th>
      <td>Color</td>
      <td>Gore Verbinski</td>
      <td>313.0</td>
      <td>151.0</td>
      <td>563.0</td>
      <td>1000.0</td>
      <td>Orlando Bloom</td>
      <td>40000.0</td>
      <td>423032628.0</td>
      <td>Action|Adventure|Fantasy</td>
      <td>...</td>
      <td>1832.0</td>
      <td>English</td>
      <td>USA</td>
      <td>PG-13</td>
      <td>225000000.0</td>
      <td>2006.0</td>
      <td>5000.0</td>
      <td>7.3</td>
      <td>2.35</td>
      <td>5000</td>
    </tr>
    <tr>
      <th>The Lone Ranger</th>
      <td>Color</td>
      <td>Gore Verbinski</td>
      <td>450.0</td>
      <td>150.0</td>
      <td>563.0</td>
      <td>1000.0</td>
      <td>Ruth Wilson</td>
      <td>40000.0</td>
      <td>89289910.0</td>
      <td>Action|Adventure|Western</td>
      <td>...</td>
      <td>711.0</td>
      <td>English</td>
      <td>USA</td>
      <td>PG-13</td>
      <td>215000000.0</td>
      <td>2013.0</td>
      <td>2000.0</td>
      <td>6.5</td>
      <td>2.35</td>
      <td>48000</td>
    </tr>
    <tr>
      <th>Man of Steel</th>
      <td>Color</td>
      <td>Zack Snyder</td>
      <td>733.0</td>
      <td>143.0</td>
      <td>0.0</td>
      <td>748.0</td>
      <td>Christopher Meloni</td>
      <td>15000.0</td>
      <td>291021565.0</td>
      <td>Action|Adventure|Fantasy|Sci-Fi</td>
      <td>...</td>
      <td>2536.0</td>
      <td>English</td>
      <td>USA</td>
      <td>PG-13</td>
      <td>225000000.0</td>
      <td>2013.0</td>
      <td>3000.0</td>
      <td>7.2</td>
      <td>2.35</td>
      <td>118000</td>
    </tr>
    <tr>
      <th>The Chronicles of Narnia: Prince Caspian</th>
      <td>Color</td>
      <td>Andrew Adamson</td>
      <td>258.0</td>
      <td>150.0</td>
      <td>80.0</td>
      <td>201.0</td>
      <td>Pierfrancesco Favino</td>
      <td>22000.0</td>
      <td>141614023.0</td>
      <td>Action|Adventure|Family|Fantasy</td>
      <td>...</td>
      <td>438.0</td>
      <td>English</td>
      <td>USA</td>
      <td>PG</td>
      <td>225000000.0</td>
      <td>2008.0</td>
      <td>216.0</td>
      <td>6.6</td>
      <td>2.35</td>
      <td>0</td>
    </tr>
    <tr>
      <th>The Avengers</th>
      <td>Color</td>
      <td>Joss Whedon</td>
      <td>703.0</td>
      <td>173.0</td>
      <td>0.0</td>
      <td>19000.0</td>
      <td>Robert Downey Jr.</td>
      <td>26000.0</td>
      <td>623279547.0</td>
      <td>Action|Adventure|Sci-Fi</td>
      <td>...</td>
      <td>1722.0</td>
      <td>English</td>
      <td>USA</td>
      <td>PG-13</td>
      <td>220000000.0</td>
      <td>2012.0</td>
      <td>21000.0</td>
      <td>8.1</td>
      <td>1.85</td>
      <td>123000</td>
    </tr>
    <tr>
      <th>Pirates of the Caribbean: On Stranger Tides</th>
      <td>Color</td>
      <td>Rob Marshall</td>
      <td>448.0</td>
      <td>136.0</td>
      <td>252.0</td>
      <td>1000.0</td>
      <td>Sam Claflin</td>
      <td>40000.0</td>
      <td>241063875.0</td>
      <td>Action|Adventure|Fantasy</td>
      <td>...</td>
      <td>484.0</td>
      <td>English</td>
      <td>USA</td>
      <td>PG-13</td>
      <td>250000000.0</td>
      <td>2011.0</td>
      <td>11000.0</td>
      <td>6.7</td>
      <td>2.35</td>
      <td>58000</td>
    </tr>
    <tr>
      <th>Men in Black 3</th>
      <td>Color</td>
      <td>Barry Sonnenfeld</td>
      <td>451.0</td>
      <td>106.0</td>
      <td>188.0</td>
      <td>718.0</td>
      <td>Michael Stuhlbarg</td>
      <td>10000.0</td>
      <td>179020854.0</td>
      <td>Action|Adventure|Comedy|Family|Fantasy|Sci-Fi</td>
      <td>...</td>
      <td>341.0</td>
      <td>English</td>
      <td>USA</td>
      <td>PG-13</td>
      <td>225000000.0</td>
      <td>2012.0</td>
      <td>816.0</td>
      <td>6.8</td>
      <td>1.85</td>
      <td>40000</td>
    </tr>
    <tr>
      <th>The Hobbit: The Battle of the Five Armies</th>
      <td>Color</td>
      <td>Peter Jackson</td>
      <td>422.0</td>
      <td>164.0</td>
      <td>0.0</td>
      <td>773.0</td>
      <td>Adam Brown</td>
      <td>5000.0</td>
      <td>255108370.0</td>
      <td>Adventure|Fantasy</td>
      <td>...</td>
      <td>802.0</td>
      <td>English</td>
      <td>New Zealand</td>
      <td>PG-13</td>
      <td>250000000.0</td>
      <td>2014.0</td>
      <td>972.0</td>
      <td>7.5</td>
      <td>2.35</td>
      <td>65000</td>
    </tr>
    <tr>
      <th>The Amazing Spider-Man</th>
      <td>Color</td>
      <td>Marc Webb</td>
      <td>599.0</td>
      <td>153.0</td>
      <td>464.0</td>
      <td>963.0</td>
      <td>Andrew Garfield</td>
      <td>15000.0</td>
      <td>262030663.0</td>
      <td>Action|Adventure|Fantasy</td>
      <td>...</td>
      <td>1225.0</td>
      <td>English</td>
      <td>USA</td>
      <td>PG-13</td>
      <td>230000000.0</td>
      <td>2012.0</td>
      <td>10000.0</td>
      <td>7.0</td>
      <td>2.35</td>
      <td>56000</td>
    </tr>
    <tr>
      <th>Robin Hood</th>
      <td>Color</td>
      <td>Ridley Scott</td>
      <td>343.0</td>
      <td>156.0</td>
      <td>0.0</td>
      <td>738.0</td>
      <td>William Hurt</td>
      <td>891.0</td>
      <td>105219735.0</td>
      <td>Action|Adventure|Drama|History</td>
      <td>...</td>
      <td>546.0</td>
      <td>English</td>
      <td>USA</td>
      <td>PG-13</td>
      <td>200000000.0</td>
      <td>2010.0</td>
      <td>882.0</td>
      <td>6.7</td>
      <td>2.35</td>
      <td>17000</td>
    </tr>
  </tbody>
</table>
<p>21 rows × 27 columns</p>
</div>




```python
# 5.  행이름이 John Carter 이고 열이름이 director_name 인 값 조회 - John Carter의 감독이름
movie.loc['John Carter', 'director_name']
```




    'Andrew Stanton'




```python
# 6.  1번행 조회
movie.iloc[0] # 첫번째 행
```




    color                                                                    Color
    director_name                                                    James Cameron
    num_critic_for_reviews                                                   723.0
    duration                                                                 178.0
    director_facebook_likes                                                    0.0
    actor_3_facebook_likes                                                   855.0
    actor_2_name                                                  Joel David Moore
    actor_1_facebook_likes                                                  1000.0
    gross                                                              760505847.0
    genres                                         Action|Adventure|Fantasy|Sci-Fi
    actor_1_name                                                       CCH Pounder
    num_voted_users                                                         886204
    cast_total_facebook_likes                                                 4834
    actor_3_name                                                         Wes Studi
    facenumber_in_poster                                                       0.0
    plot_keywords                           avatar|future|marine|native|paraplegic
    movie_imdb_link              http://www.imdb.com/title/tt0499549/?ref_=fn_t...
    num_user_for_reviews                                                    3054.0
    language                                                               English
    country                                                                    USA
    content_rating                                                           PG-13
    budget                                                             237000000.0
    title_year                                                              2009.0
    actor_2_facebook_likes                                                   936.0
    imdb_score                                                                 7.9
    aspect_ratio                                                              1.78
    movie_facebook_likes                                                     33000
    Name: Avatar, dtype: object




```python
# 7.  마지막 행 조회
movie.iloc[len(movie)-1]
```




    color                                                                    Color
    director_name                                                         Jon Gunn
    num_critic_for_reviews                                                    43.0
    duration                                                                  90.0
    director_facebook_likes                                                   16.0
    actor_3_facebook_likes                                                    16.0
    actor_2_name                                                  Brian Herzlinger
    actor_1_facebook_likes                                                    86.0
    gross                                                                  85222.0
    genres                                                             Documentary
    actor_1_name                                                       John August
    num_voted_users                                                           4285
    cast_total_facebook_likes                                                  163
    actor_3_name                                                          Jon Gunn
    facenumber_in_poster                                                       0.0
    plot_keywords                actress name in title|crush|date|four word tit...
    movie_imdb_link              http://www.imdb.com/title/tt0378407/?ref_=fn_t...
    num_user_for_reviews                                                      84.0
    language                                                               English
    country                                                                    USA
    content_rating                                                              PG
    budget                                                                  1100.0
    title_year                                                              2004.0
    actor_2_facebook_likes                                                    23.0
    imdb_score                                                                 6.6
    aspect_ratio                                                              1.85
    movie_facebook_likes                                                       456
    Name: My Date with Drew, dtype: object




```python
# 8.  1, 2, 5, 6, 9 번행 조회
movie.iloc[[1, 2, 5, 6, 9]]
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>color</th>
      <th>director_name</th>
      <th>num_critic_for_reviews</th>
      <th>duration</th>
      <th>director_facebook_likes</th>
      <th>actor_3_facebook_likes</th>
      <th>actor_2_name</th>
      <th>actor_1_facebook_likes</th>
      <th>gross</th>
      <th>genres</th>
      <th>...</th>
      <th>num_user_for_reviews</th>
      <th>language</th>
      <th>country</th>
      <th>content_rating</th>
      <th>budget</th>
      <th>title_year</th>
      <th>actor_2_facebook_likes</th>
      <th>imdb_score</th>
      <th>aspect_ratio</th>
      <th>movie_facebook_likes</th>
    </tr>
    <tr>
      <th>movie_title</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Pirates of the Caribbean: At World's End</th>
      <td>Color</td>
      <td>Gore Verbinski</td>
      <td>302.0</td>
      <td>169.0</td>
      <td>563.0</td>
      <td>1000.0</td>
      <td>Orlando Bloom</td>
      <td>40000.0</td>
      <td>309404152.0</td>
      <td>Action|Adventure|Fantasy</td>
      <td>...</td>
      <td>1238.0</td>
      <td>English</td>
      <td>USA</td>
      <td>PG-13</td>
      <td>300000000.0</td>
      <td>2007.0</td>
      <td>5000.0</td>
      <td>7.1</td>
      <td>2.35</td>
      <td>0</td>
    </tr>
    <tr>
      <th>Spectre</th>
      <td>Color</td>
      <td>Sam Mendes</td>
      <td>602.0</td>
      <td>148.0</td>
      <td>0.0</td>
      <td>161.0</td>
      <td>Rory Kinnear</td>
      <td>11000.0</td>
      <td>200074175.0</td>
      <td>Action|Adventure|Thriller</td>
      <td>...</td>
      <td>994.0</td>
      <td>English</td>
      <td>UK</td>
      <td>PG-13</td>
      <td>245000000.0</td>
      <td>2015.0</td>
      <td>393.0</td>
      <td>6.8</td>
      <td>2.35</td>
      <td>85000</td>
    </tr>
    <tr>
      <th>John Carter</th>
      <td>Color</td>
      <td>Andrew Stanton</td>
      <td>462.0</td>
      <td>132.0</td>
      <td>475.0</td>
      <td>530.0</td>
      <td>Samantha Morton</td>
      <td>640.0</td>
      <td>73058679.0</td>
      <td>Action|Adventure|Sci-Fi</td>
      <td>...</td>
      <td>738.0</td>
      <td>English</td>
      <td>USA</td>
      <td>PG-13</td>
      <td>263700000.0</td>
      <td>2012.0</td>
      <td>632.0</td>
      <td>6.6</td>
      <td>2.35</td>
      <td>24000</td>
    </tr>
    <tr>
      <th>Spider-Man 3</th>
      <td>Color</td>
      <td>Sam Raimi</td>
      <td>392.0</td>
      <td>156.0</td>
      <td>0.0</td>
      <td>4000.0</td>
      <td>James Franco</td>
      <td>24000.0</td>
      <td>336530303.0</td>
      <td>Action|Adventure|Romance</td>
      <td>...</td>
      <td>1902.0</td>
      <td>English</td>
      <td>USA</td>
      <td>PG-13</td>
      <td>258000000.0</td>
      <td>2007.0</td>
      <td>11000.0</td>
      <td>6.2</td>
      <td>2.35</td>
      <td>0</td>
    </tr>
    <tr>
      <th>Harry Potter and the Half-Blood Prince</th>
      <td>Color</td>
      <td>David Yates</td>
      <td>375.0</td>
      <td>153.0</td>
      <td>282.0</td>
      <td>10000.0</td>
      <td>Daniel Radcliffe</td>
      <td>25000.0</td>
      <td>301956980.0</td>
      <td>Adventure|Family|Fantasy|Mystery</td>
      <td>...</td>
      <td>973.0</td>
      <td>English</td>
      <td>UK</td>
      <td>PG</td>
      <td>250000000.0</td>
      <td>2009.0</td>
      <td>11000.0</td>
      <td>7.5</td>
      <td>2.35</td>
      <td>10000</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 27 columns</p>
</div>




```python
# 9.  10 ~ 20 행 조회
movie.iloc[9:20]
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>color</th>
      <th>director_name</th>
      <th>num_critic_for_reviews</th>
      <th>duration</th>
      <th>director_facebook_likes</th>
      <th>actor_3_facebook_likes</th>
      <th>actor_2_name</th>
      <th>actor_1_facebook_likes</th>
      <th>gross</th>
      <th>genres</th>
      <th>...</th>
      <th>num_user_for_reviews</th>
      <th>language</th>
      <th>country</th>
      <th>content_rating</th>
      <th>budget</th>
      <th>title_year</th>
      <th>actor_2_facebook_likes</th>
      <th>imdb_score</th>
      <th>aspect_ratio</th>
      <th>movie_facebook_likes</th>
    </tr>
    <tr>
      <th>movie_title</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Harry Potter and the Half-Blood Prince</th>
      <td>Color</td>
      <td>David Yates</td>
      <td>375.0</td>
      <td>153.0</td>
      <td>282.0</td>
      <td>10000.0</td>
      <td>Daniel Radcliffe</td>
      <td>25000.0</td>
      <td>301956980.0</td>
      <td>Adventure|Family|Fantasy|Mystery</td>
      <td>...</td>
      <td>973.0</td>
      <td>English</td>
      <td>UK</td>
      <td>PG</td>
      <td>250000000.0</td>
      <td>2009.0</td>
      <td>11000.0</td>
      <td>7.5</td>
      <td>2.35</td>
      <td>10000</td>
    </tr>
    <tr>
      <th>Batman v Superman: Dawn of Justice</th>
      <td>Color</td>
      <td>Zack Snyder</td>
      <td>673.0</td>
      <td>183.0</td>
      <td>0.0</td>
      <td>2000.0</td>
      <td>Lauren Cohan</td>
      <td>15000.0</td>
      <td>330249062.0</td>
      <td>Action|Adventure|Sci-Fi</td>
      <td>...</td>
      <td>3018.0</td>
      <td>English</td>
      <td>USA</td>
      <td>PG-13</td>
      <td>250000000.0</td>
      <td>2016.0</td>
      <td>4000.0</td>
      <td>6.9</td>
      <td>2.35</td>
      <td>197000</td>
    </tr>
    <tr>
      <th>Superman Returns</th>
      <td>Color</td>
      <td>Bryan Singer</td>
      <td>434.0</td>
      <td>169.0</td>
      <td>0.0</td>
      <td>903.0</td>
      <td>Marlon Brando</td>
      <td>18000.0</td>
      <td>200069408.0</td>
      <td>Action|Adventure|Sci-Fi</td>
      <td>...</td>
      <td>2367.0</td>
      <td>English</td>
      <td>USA</td>
      <td>PG-13</td>
      <td>209000000.0</td>
      <td>2006.0</td>
      <td>10000.0</td>
      <td>6.1</td>
      <td>2.35</td>
      <td>0</td>
    </tr>
    <tr>
      <th>Quantum of Solace</th>
      <td>Color</td>
      <td>Marc Forster</td>
      <td>403.0</td>
      <td>106.0</td>
      <td>395.0</td>
      <td>393.0</td>
      <td>Mathieu Amalric</td>
      <td>451.0</td>
      <td>168368427.0</td>
      <td>Action|Adventure</td>
      <td>...</td>
      <td>1243.0</td>
      <td>English</td>
      <td>UK</td>
      <td>PG-13</td>
      <td>200000000.0</td>
      <td>2008.0</td>
      <td>412.0</td>
      <td>6.7</td>
      <td>2.35</td>
      <td>0</td>
    </tr>
    <tr>
      <th>Pirates of the Caribbean: Dead Man's Chest</th>
      <td>Color</td>
      <td>Gore Verbinski</td>
      <td>313.0</td>
      <td>151.0</td>
      <td>563.0</td>
      <td>1000.0</td>
      <td>Orlando Bloom</td>
      <td>40000.0</td>
      <td>423032628.0</td>
      <td>Action|Adventure|Fantasy</td>
      <td>...</td>
      <td>1832.0</td>
      <td>English</td>
      <td>USA</td>
      <td>PG-13</td>
      <td>225000000.0</td>
      <td>2006.0</td>
      <td>5000.0</td>
      <td>7.3</td>
      <td>2.35</td>
      <td>5000</td>
    </tr>
    <tr>
      <th>The Lone Ranger</th>
      <td>Color</td>
      <td>Gore Verbinski</td>
      <td>450.0</td>
      <td>150.0</td>
      <td>563.0</td>
      <td>1000.0</td>
      <td>Ruth Wilson</td>
      <td>40000.0</td>
      <td>89289910.0</td>
      <td>Action|Adventure|Western</td>
      <td>...</td>
      <td>711.0</td>
      <td>English</td>
      <td>USA</td>
      <td>PG-13</td>
      <td>215000000.0</td>
      <td>2013.0</td>
      <td>2000.0</td>
      <td>6.5</td>
      <td>2.35</td>
      <td>48000</td>
    </tr>
    <tr>
      <th>Man of Steel</th>
      <td>Color</td>
      <td>Zack Snyder</td>
      <td>733.0</td>
      <td>143.0</td>
      <td>0.0</td>
      <td>748.0</td>
      <td>Christopher Meloni</td>
      <td>15000.0</td>
      <td>291021565.0</td>
      <td>Action|Adventure|Fantasy|Sci-Fi</td>
      <td>...</td>
      <td>2536.0</td>
      <td>English</td>
      <td>USA</td>
      <td>PG-13</td>
      <td>225000000.0</td>
      <td>2013.0</td>
      <td>3000.0</td>
      <td>7.2</td>
      <td>2.35</td>
      <td>118000</td>
    </tr>
    <tr>
      <th>The Chronicles of Narnia: Prince Caspian</th>
      <td>Color</td>
      <td>Andrew Adamson</td>
      <td>258.0</td>
      <td>150.0</td>
      <td>80.0</td>
      <td>201.0</td>
      <td>Pierfrancesco Favino</td>
      <td>22000.0</td>
      <td>141614023.0</td>
      <td>Action|Adventure|Family|Fantasy</td>
      <td>...</td>
      <td>438.0</td>
      <td>English</td>
      <td>USA</td>
      <td>PG</td>
      <td>225000000.0</td>
      <td>2008.0</td>
      <td>216.0</td>
      <td>6.6</td>
      <td>2.35</td>
      <td>0</td>
    </tr>
    <tr>
      <th>The Avengers</th>
      <td>Color</td>
      <td>Joss Whedon</td>
      <td>703.0</td>
      <td>173.0</td>
      <td>0.0</td>
      <td>19000.0</td>
      <td>Robert Downey Jr.</td>
      <td>26000.0</td>
      <td>623279547.0</td>
      <td>Action|Adventure|Sci-Fi</td>
      <td>...</td>
      <td>1722.0</td>
      <td>English</td>
      <td>USA</td>
      <td>PG-13</td>
      <td>220000000.0</td>
      <td>2012.0</td>
      <td>21000.0</td>
      <td>8.1</td>
      <td>1.85</td>
      <td>123000</td>
    </tr>
    <tr>
      <th>Pirates of the Caribbean: On Stranger Tides</th>
      <td>Color</td>
      <td>Rob Marshall</td>
      <td>448.0</td>
      <td>136.0</td>
      <td>252.0</td>
      <td>1000.0</td>
      <td>Sam Claflin</td>
      <td>40000.0</td>
      <td>241063875.0</td>
      <td>Action|Adventure|Fantasy</td>
      <td>...</td>
      <td>484.0</td>
      <td>English</td>
      <td>USA</td>
      <td>PG-13</td>
      <td>250000000.0</td>
      <td>2011.0</td>
      <td>11000.0</td>
      <td>6.7</td>
      <td>2.35</td>
      <td>58000</td>
    </tr>
    <tr>
      <th>Men in Black 3</th>
      <td>Color</td>
      <td>Barry Sonnenfeld</td>
      <td>451.0</td>
      <td>106.0</td>
      <td>188.0</td>
      <td>718.0</td>
      <td>Michael Stuhlbarg</td>
      <td>10000.0</td>
      <td>179020854.0</td>
      <td>Action|Adventure|Comedy|Family|Fantasy|Sci-Fi</td>
      <td>...</td>
      <td>341.0</td>
      <td>English</td>
      <td>USA</td>
      <td>PG-13</td>
      <td>225000000.0</td>
      <td>2012.0</td>
      <td>816.0</td>
      <td>6.8</td>
      <td>1.85</td>
      <td>40000</td>
    </tr>
  </tbody>
</table>
<p>11 rows × 27 columns</p>
</div>




```python
# 10.  movie dataframe에서 5 ~ 10 행의 color, director_name, num_critic_for_reviews 컬럼(0,1,2번째 컬럼)을 iloc을 이용해 조회
movie.iloc[4:10, :3]
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>color</th>
      <th>director_name</th>
      <th>num_critic_for_reviews</th>
    </tr>
    <tr>
      <th>movie_title</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Star Wars: Episode VII - The Force Awakens</th>
      <td>NaN</td>
      <td>Doug Walker</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>John Carter</th>
      <td>Color</td>
      <td>Andrew Stanton</td>
      <td>462.0</td>
    </tr>
    <tr>
      <th>Spider-Man 3</th>
      <td>Color</td>
      <td>Sam Raimi</td>
      <td>392.0</td>
    </tr>
    <tr>
      <th>Tangled</th>
      <td>Color</td>
      <td>Nathan Greno</td>
      <td>324.0</td>
    </tr>
    <tr>
      <th>Avengers: Age of Ultron</th>
      <td>Color</td>
      <td>Joss Whedon</td>
      <td>635.0</td>
    </tr>
    <tr>
      <th>Harry Potter and the Half-Blood Prince</th>
      <td>Color</td>
      <td>David Yates</td>
      <td>375.0</td>
    </tr>
  </tbody>
</table>
</div>



## Boolean indexing을 이용한 조회
- 원하는 조건을 만족하는 행, 열을 조회한다.

- **`DataFrame객체[조건], DataFrame객체.loc[조건]`**
    - 조건이 True인 행만 조회
    - 열까지 선택시
        - `DataFrame객체[조건][열]`
        - `DataFrame객체.loc[조건, 열]`
        - **iloc indexer**는 boolean indexing을 **지원하지 않는다.**

> - 논리연산자
> |논리연산자|설명|
> |:-:|-|
> |&|and연산|
> |\||or연산|
> |~|not연산|

> - 논리연산자의 피연산자들은 반드시 ( )로 묶어준다.
> - 파이썬과는 다르게 `and`, `or`, `not` 예약어는 사용할 수 없다.


```python
g2
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>KOREAN</th>
      <th>ENGLISH</th>
      <th>MATH</th>
      <th>PYTHON</th>
      <th>총점</th>
      <th>평균</th>
      <th>PASS</th>
      <th>PASS2</th>
    </tr>
    <tr>
      <th>ID</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>id-1</th>
      <td>100</td>
      <td>90</td>
      <td>90</td>
      <td>100</td>
      <td>380</td>
      <td>95.0</td>
      <td>True</td>
      <td>통과</td>
    </tr>
    <tr>
      <th>id-2</th>
      <td>50</td>
      <td>80</td>
      <td>90</td>
      <td>90</td>
      <td>310</td>
      <td>77.5</td>
      <td>False</td>
      <td>낙제</td>
    </tr>
    <tr>
      <th>id-3</th>
      <td>70</td>
      <td>100</td>
      <td>90</td>
      <td>70</td>
      <td>330</td>
      <td>82.5</td>
      <td>True</td>
      <td>통과</td>
    </tr>
    <tr>
      <th>id-4</th>
      <td>60</td>
      <td>60</td>
      <td>90</td>
      <td>80</td>
      <td>290</td>
      <td>72.5</td>
      <td>False</td>
      <td>낙제</td>
    </tr>
    <tr>
      <th>id-5</th>
      <td>90</td>
      <td>40</td>
      <td>90</td>
      <td>100</td>
      <td>320</td>
      <td>80.0</td>
      <td>True</td>
      <td>통과</td>
    </tr>
  </tbody>
</table>
</div>




```python
g2[[True, False, False, False, True]]  # 행 조회 id-1과 id-5 만 조회
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>KOREAN</th>
      <th>ENGLISH</th>
      <th>MATH</th>
      <th>PYTHON</th>
      <th>총점</th>
      <th>평균</th>
      <th>PASS</th>
      <th>PASS2</th>
    </tr>
    <tr>
      <th>ID</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>id-1</th>
      <td>100</td>
      <td>90</td>
      <td>90</td>
      <td>100</td>
      <td>380</td>
      <td>95.0</td>
      <td>True</td>
      <td>통과</td>
    </tr>
    <tr>
      <th>id-5</th>
      <td>90</td>
      <td>40</td>
      <td>90</td>
      <td>100</td>
      <td>320</td>
      <td>80.0</td>
      <td>True</td>
      <td>통과</td>
    </tr>
  </tbody>
</table>
</div>




```python
# 국어 점수가 80 이상인 행
g2[g2['KOREAN'] > 80]
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>KOREAN</th>
      <th>ENGLISH</th>
      <th>MATH</th>
      <th>PYTHON</th>
      <th>총점</th>
      <th>평균</th>
      <th>PASS</th>
      <th>PASS2</th>
    </tr>
    <tr>
      <th>ID</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>id-1</th>
      <td>100</td>
      <td>90</td>
      <td>90</td>
      <td>100</td>
      <td>380</td>
      <td>95.0</td>
      <td>True</td>
      <td>통과</td>
    </tr>
    <tr>
      <th>id-5</th>
      <td>90</td>
      <td>40</td>
      <td>90</td>
      <td>100</td>
      <td>320</td>
      <td>80.0</td>
      <td>True</td>
      <td>통과</td>
    </tr>
  </tbody>
</table>
</div>


- 표

a|b|c
-|-|-
1|2|3
4|5|6



```python
# 국어가 60 ~ 80 사이인 행들
g2[(g2['KOREAN']>=60)&(g2['KOREAN']<= 80)]
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>KOREAN</th>
      <th>ENGLISH</th>
      <th>MATH</th>
      <th>PYTHON</th>
      <th>총점</th>
      <th>평균</th>
      <th>PASS</th>
      <th>PASS2</th>
    </tr>
    <tr>
      <th>ID</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>id-3</th>
      <td>70</td>
      <td>100</td>
      <td>90</td>
      <td>70</td>
      <td>330</td>
      <td>82.5</td>
      <td>True</td>
      <td>통과</td>
    </tr>
    <tr>
      <th>id-4</th>
      <td>60</td>
      <td>60</td>
      <td>90</td>
      <td>80</td>
      <td>290</td>
      <td>72.5</td>
      <td>False</td>
      <td>낙제</td>
    </tr>
  </tbody>
</table>
</div>




```python
g2[g2['KOREAN'].between(60, 80)]
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>KOREAN</th>
      <th>ENGLISH</th>
      <th>MATH</th>
      <th>PYTHON</th>
      <th>총점</th>
      <th>평균</th>
      <th>PASS</th>
      <th>PASS2</th>
    </tr>
    <tr>
      <th>ID</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>id-3</th>
      <td>70</td>
      <td>100</td>
      <td>90</td>
      <td>70</td>
      <td>330</td>
      <td>82.5</td>
      <td>True</td>
      <td>통과</td>
    </tr>
    <tr>
      <th>id-4</th>
      <td>60</td>
      <td>60</td>
      <td>90</td>
      <td>80</td>
      <td>290</td>
      <td>72.5</td>
      <td>False</td>
      <td>낙제</td>
    </tr>
  </tbody>
</table>
</div>




```python
# 국어가 60 ~ 80 사이이고 영어가 100점인 행 확인
g2[g2['KOREAN'].between(60, 80) & (g2['ENGLISH'] == 100)]  # 연산식이 아니라 함수 이기 때문에 괄호를 앞에꺼는 안쳐도 됨
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>KOREAN</th>
      <th>ENGLISH</th>
      <th>MATH</th>
      <th>PYTHON</th>
      <th>총점</th>
      <th>평균</th>
      <th>PASS</th>
      <th>PASS2</th>
    </tr>
    <tr>
      <th>ID</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>id-3</th>
      <td>70</td>
      <td>100</td>
      <td>90</td>
      <td>70</td>
      <td>330</td>
      <td>82.5</td>
      <td>True</td>
      <td>통과</td>
    </tr>
  </tbody>
</table>
</div>




```python
# 국어가 60 ~ 80 사이이고 영어가 100점인 행들의 국어, 영어, 평균 점수를 확인
g2[g2['KOREAN'].between(60, 80) & (g2['ENGLISH'] == 100)][['KOREAN', 'ENGLISH', '평균']]
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>KOREAN</th>
      <th>ENGLISH</th>
      <th>평균</th>
    </tr>
    <tr>
      <th>ID</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>id-3</th>
      <td>70</td>
      <td>100</td>
      <td>82.5</td>
    </tr>
  </tbody>
</table>
</div>




```python
# df.loc[행->boolean index, 열]
g2.loc[g2['KOREAN'].between(60, 80) & (g2['ENGLISH'] == 100), ['KOREAN', 'ENGLISH', '평균']]
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>KOREAN</th>
      <th>ENGLISH</th>
      <th>평균</th>
    </tr>
    <tr>
      <th>ID</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>id-3</th>
      <td>70</td>
      <td>100</td>
      <td>82.5</td>
    </tr>
  </tbody>
</table>
</div>



<b style='font-size:2.2em'>TODO</b>


```python
# movie dataframe의 index명을 컬럼 설정한다.
movie.reset_index(inplace=True)
movie
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>movie_title</th>
      <th>color</th>
      <th>director_name</th>
      <th>num_critic_for_reviews</th>
      <th>duration</th>
      <th>director_facebook_likes</th>
      <th>actor_3_facebook_likes</th>
      <th>actor_2_name</th>
      <th>actor_1_facebook_likes</th>
      <th>gross</th>
      <th>...</th>
      <th>num_user_for_reviews</th>
      <th>language</th>
      <th>country</th>
      <th>content_rating</th>
      <th>budget</th>
      <th>title_year</th>
      <th>actor_2_facebook_likes</th>
      <th>imdb_score</th>
      <th>aspect_ratio</th>
      <th>movie_facebook_likes</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Avatar</td>
      <td>Color</td>
      <td>James Cameron</td>
      <td>723.0</td>
      <td>178.0</td>
      <td>0.0</td>
      <td>855.0</td>
      <td>Joel David Moore</td>
      <td>1000.0</td>
      <td>760505847.0</td>
      <td>...</td>
      <td>3054.0</td>
      <td>English</td>
      <td>USA</td>
      <td>PG-13</td>
      <td>237000000.0</td>
      <td>2009.0</td>
      <td>936.0</td>
      <td>7.9</td>
      <td>1.78</td>
      <td>33000</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Pirates of the Caribbean: At World's End</td>
      <td>Color</td>
      <td>Gore Verbinski</td>
      <td>302.0</td>
      <td>169.0</td>
      <td>563.0</td>
      <td>1000.0</td>
      <td>Orlando Bloom</td>
      <td>40000.0</td>
      <td>309404152.0</td>
      <td>...</td>
      <td>1238.0</td>
      <td>English</td>
      <td>USA</td>
      <td>PG-13</td>
      <td>300000000.0</td>
      <td>2007.0</td>
      <td>5000.0</td>
      <td>7.1</td>
      <td>2.35</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Spectre</td>
      <td>Color</td>
      <td>Sam Mendes</td>
      <td>602.0</td>
      <td>148.0</td>
      <td>0.0</td>
      <td>161.0</td>
      <td>Rory Kinnear</td>
      <td>11000.0</td>
      <td>200074175.0</td>
      <td>...</td>
      <td>994.0</td>
      <td>English</td>
      <td>UK</td>
      <td>PG-13</td>
      <td>245000000.0</td>
      <td>2015.0</td>
      <td>393.0</td>
      <td>6.8</td>
      <td>2.35</td>
      <td>85000</td>
    </tr>
    <tr>
      <th>3</th>
      <td>The Dark Knight Rises</td>
      <td>Color</td>
      <td>Christopher Nolan</td>
      <td>813.0</td>
      <td>164.0</td>
      <td>22000.0</td>
      <td>23000.0</td>
      <td>Christian Bale</td>
      <td>27000.0</td>
      <td>448130642.0</td>
      <td>...</td>
      <td>2701.0</td>
      <td>English</td>
      <td>USA</td>
      <td>PG-13</td>
      <td>250000000.0</td>
      <td>2012.0</td>
      <td>23000.0</td>
      <td>8.5</td>
      <td>2.35</td>
      <td>164000</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Star Wars: Episode VII - The Force Awakens</td>
      <td>NaN</td>
      <td>Doug Walker</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>131.0</td>
      <td>NaN</td>
      <td>Rob Walker</td>
      <td>131.0</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>12.0</td>
      <td>7.1</td>
      <td>NaN</td>
      <td>0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>4911</th>
      <td>Signed Sealed Delivered</td>
      <td>Color</td>
      <td>Scott Smith</td>
      <td>1.0</td>
      <td>87.0</td>
      <td>2.0</td>
      <td>318.0</td>
      <td>Daphne Zuniga</td>
      <td>637.0</td>
      <td>NaN</td>
      <td>...</td>
      <td>6.0</td>
      <td>English</td>
      <td>Canada</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>2013.0</td>
      <td>470.0</td>
      <td>7.7</td>
      <td>NaN</td>
      <td>84</td>
    </tr>
    <tr>
      <th>4912</th>
      <td>The Following</td>
      <td>Color</td>
      <td>NaN</td>
      <td>43.0</td>
      <td>43.0</td>
      <td>NaN</td>
      <td>319.0</td>
      <td>Valorie Curry</td>
      <td>841.0</td>
      <td>NaN</td>
      <td>...</td>
      <td>359.0</td>
      <td>English</td>
      <td>USA</td>
      <td>TV-14</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>593.0</td>
      <td>7.5</td>
      <td>16.00</td>
      <td>32000</td>
    </tr>
    <tr>
      <th>4913</th>
      <td>A Plague So Pleasant</td>
      <td>Color</td>
      <td>Benjamin Roberds</td>
      <td>13.0</td>
      <td>76.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>Maxwell Moody</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>...</td>
      <td>3.0</td>
      <td>English</td>
      <td>USA</td>
      <td>NaN</td>
      <td>1400.0</td>
      <td>2013.0</td>
      <td>0.0</td>
      <td>6.3</td>
      <td>NaN</td>
      <td>16</td>
    </tr>
    <tr>
      <th>4914</th>
      <td>Shanghai Calling</td>
      <td>Color</td>
      <td>Daniel Hsia</td>
      <td>14.0</td>
      <td>100.0</td>
      <td>0.0</td>
      <td>489.0</td>
      <td>Daniel Henney</td>
      <td>946.0</td>
      <td>10443.0</td>
      <td>...</td>
      <td>9.0</td>
      <td>English</td>
      <td>USA</td>
      <td>PG-13</td>
      <td>NaN</td>
      <td>2012.0</td>
      <td>719.0</td>
      <td>6.3</td>
      <td>2.35</td>
      <td>660</td>
    </tr>
    <tr>
      <th>4915</th>
      <td>My Date with Drew</td>
      <td>Color</td>
      <td>Jon Gunn</td>
      <td>43.0</td>
      <td>90.0</td>
      <td>16.0</td>
      <td>16.0</td>
      <td>Brian Herzlinger</td>
      <td>86.0</td>
      <td>85222.0</td>
      <td>...</td>
      <td>84.0</td>
      <td>English</td>
      <td>USA</td>
      <td>PG</td>
      <td>1100.0</td>
      <td>2004.0</td>
      <td>23.0</td>
      <td>6.6</td>
      <td>1.85</td>
      <td>456</td>
    </tr>
  </tbody>
</table>
<p>4916 rows × 28 columns</p>
</div>




```python
# 1.  상영시간 (duration)이 300 이상인 영화들 조회
movie[movie['duration']>=300]
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>movie_title</th>
      <th>color</th>
      <th>director_name</th>
      <th>num_critic_for_reviews</th>
      <th>duration</th>
      <th>director_facebook_likes</th>
      <th>actor_3_facebook_likes</th>
      <th>actor_2_name</th>
      <th>actor_1_facebook_likes</th>
      <th>gross</th>
      <th>...</th>
      <th>num_user_for_reviews</th>
      <th>language</th>
      <th>country</th>
      <th>content_rating</th>
      <th>budget</th>
      <th>title_year</th>
      <th>actor_2_facebook_likes</th>
      <th>imdb_score</th>
      <th>aspect_ratio</th>
      <th>movie_facebook_likes</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1134</th>
      <td>Heaven's Gate</td>
      <td>Color</td>
      <td>Michael Cimino</td>
      <td>102.0</td>
      <td>325.0</td>
      <td>517.0</td>
      <td>678.0</td>
      <td>Sam Waterston</td>
      <td>12000.0</td>
      <td>1500000.0</td>
      <td>...</td>
      <td>189.0</td>
      <td>English</td>
      <td>USA</td>
      <td>R</td>
      <td>44000000.0</td>
      <td>1980.0</td>
      <td>849.0</td>
      <td>6.8</td>
      <td>2.35</td>
      <td>1000</td>
    </tr>
    <tr>
      <th>1487</th>
      <td>Blood In, Blood Out</td>
      <td>Color</td>
      <td>Taylor Hackford</td>
      <td>12.0</td>
      <td>330.0</td>
      <td>138.0</td>
      <td>672.0</td>
      <td>Jesse Borrego</td>
      <td>848.0</td>
      <td>4496583.0</td>
      <td>...</td>
      <td>129.0</td>
      <td>English</td>
      <td>USA</td>
      <td>R</td>
      <td>35000000.0</td>
      <td>1993.0</td>
      <td>674.0</td>
      <td>8.0</td>
      <td>1.66</td>
      <td>6000</td>
    </tr>
    <tr>
      <th>1694</th>
      <td>Trapped</td>
      <td>Color</td>
      <td>NaN</td>
      <td>16.0</td>
      <td>511.0</td>
      <td>NaN</td>
      <td>51.0</td>
      <td>Ingvar Eggert Sigurðsson</td>
      <td>147.0</td>
      <td>NaN</td>
      <td>...</td>
      <td>19.0</td>
      <td>Icelandic</td>
      <td>Iceland</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>63.0</td>
      <td>8.2</td>
      <td>16.00</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2436</th>
      <td>Carlos</td>
      <td>Color</td>
      <td>NaN</td>
      <td>108.0</td>
      <td>334.0</td>
      <td>NaN</td>
      <td>30.0</td>
      <td>Nora von Waldstätten</td>
      <td>897.0</td>
      <td>145118.0</td>
      <td>...</td>
      <td>36.0</td>
      <td>English</td>
      <td>France</td>
      <td>Not Rated</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>30.0</td>
      <td>7.7</td>
      <td>2.35</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3254</th>
      <td>The Legend of Suriyothai</td>
      <td>Color</td>
      <td>Chatrichalerm Yukol</td>
      <td>31.0</td>
      <td>300.0</td>
      <td>6.0</td>
      <td>6.0</td>
      <td>Chatchai Plengpanich</td>
      <td>7.0</td>
      <td>454255.0</td>
      <td>...</td>
      <td>47.0</td>
      <td>Thai</td>
      <td>Thailand</td>
      <td>R</td>
      <td>400000000.0</td>
      <td>2001.0</td>
      <td>6.0</td>
      <td>6.6</td>
      <td>1.85</td>
      <td>124</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 28 columns</p>
</div>




```python
# 2.  상영시간 (duration)이 300 이상인 영화들의 영화제목(movie_title)과 감독이름(director_name) 조회
movie.loc[movie['duration']>300, ['movie_title', 'director_name']]
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>movie_title</th>
      <th>director_name</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1134</th>
      <td>Heaven's Gate</td>
      <td>Michael Cimino</td>
    </tr>
    <tr>
      <th>1487</th>
      <td>Blood In, Blood Out</td>
      <td>Taylor Hackford</td>
    </tr>
    <tr>
      <th>1694</th>
      <td>Trapped</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2436</th>
      <td>Carlos</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>




```python
# 3.  감독이름(director_name)이 'Quentin Tarantino' 의 영화들만 조회
movie[movie['director_name']=='Quentin Tarantino']
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>movie_title</th>
      <th>color</th>
      <th>director_name</th>
      <th>num_critic_for_reviews</th>
      <th>duration</th>
      <th>director_facebook_likes</th>
      <th>actor_3_facebook_likes</th>
      <th>actor_2_name</th>
      <th>actor_1_facebook_likes</th>
      <th>gross</th>
      <th>...</th>
      <th>num_user_for_reviews</th>
      <th>language</th>
      <th>country</th>
      <th>content_rating</th>
      <th>budget</th>
      <th>title_year</th>
      <th>actor_2_facebook_likes</th>
      <th>imdb_score</th>
      <th>aspect_ratio</th>
      <th>movie_facebook_likes</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>293</th>
      <td>Django Unchained</td>
      <td>Color</td>
      <td>Quentin Tarantino</td>
      <td>765.0</td>
      <td>165.0</td>
      <td>16000.0</td>
      <td>265.0</td>
      <td>Christoph Waltz</td>
      <td>29000.0</td>
      <td>162804648.0</td>
      <td>...</td>
      <td>1193.0</td>
      <td>English</td>
      <td>USA</td>
      <td>R</td>
      <td>100000000.0</td>
      <td>2012.0</td>
      <td>11000.0</td>
      <td>8.5</td>
      <td>2.35</td>
      <td>199000</td>
    </tr>
    <tr>
      <th>582</th>
      <td>Inglourious Basterds</td>
      <td>Color</td>
      <td>Quentin Tarantino</td>
      <td>486.0</td>
      <td>153.0</td>
      <td>16000.0</td>
      <td>11000.0</td>
      <td>Brad Pitt</td>
      <td>13000.0</td>
      <td>120523073.0</td>
      <td>...</td>
      <td>1527.0</td>
      <td>English</td>
      <td>USA</td>
      <td>R</td>
      <td>75000000.0</td>
      <td>2009.0</td>
      <td>11000.0</td>
      <td>8.3</td>
      <td>2.35</td>
      <td>42000</td>
    </tr>
    <tr>
      <th>698</th>
      <td>The Hateful Eight</td>
      <td>Color</td>
      <td>Quentin Tarantino</td>
      <td>596.0</td>
      <td>187.0</td>
      <td>16000.0</td>
      <td>1000.0</td>
      <td>Jennifer Jason Leigh</td>
      <td>46000.0</td>
      <td>54116191.0</td>
      <td>...</td>
      <td>1018.0</td>
      <td>English</td>
      <td>USA</td>
      <td>R</td>
      <td>44000000.0</td>
      <td>2015.0</td>
      <td>1000.0</td>
      <td>7.9</td>
      <td>2.76</td>
      <td>114000</td>
    </tr>
    <tr>
      <th>846</th>
      <td>Kill Bill: Vol. 1</td>
      <td>Black and White</td>
      <td>Quentin Tarantino</td>
      <td>354.0</td>
      <td>111.0</td>
      <td>16000.0</td>
      <td>640.0</td>
      <td>Vivica A. Fox</td>
      <td>926.0</td>
      <td>70098138.0</td>
      <td>...</td>
      <td>2105.0</td>
      <td>English</td>
      <td>USA</td>
      <td>R</td>
      <td>30000000.0</td>
      <td>2003.0</td>
      <td>890.0</td>
      <td>8.1</td>
      <td>2.35</td>
      <td>13000</td>
    </tr>
    <tr>
      <th>849</th>
      <td>Kill Bill: Vol. 2</td>
      <td>Black and White</td>
      <td>Quentin Tarantino</td>
      <td>304.0</td>
      <td>137.0</td>
      <td>16000.0</td>
      <td>348.0</td>
      <td>Michael Parks</td>
      <td>890.0</td>
      <td>66207920.0</td>
      <td>...</td>
      <td>935.0</td>
      <td>English</td>
      <td>USA</td>
      <td>R</td>
      <td>30000000.0</td>
      <td>2004.0</td>
      <td>387.0</td>
      <td>8.0</td>
      <td>2.35</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2883</th>
      <td>Jackie Brown</td>
      <td>Color</td>
      <td>Quentin Tarantino</td>
      <td>140.0</td>
      <td>154.0</td>
      <td>16000.0</td>
      <td>889.0</td>
      <td>Sid Haig</td>
      <td>22000.0</td>
      <td>39647595.0</td>
      <td>...</td>
      <td>462.0</td>
      <td>English</td>
      <td>USA</td>
      <td>R</td>
      <td>12000000.0</td>
      <td>1997.0</td>
      <td>1000.0</td>
      <td>7.5</td>
      <td>1.85</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3295</th>
      <td>Pulp Fiction</td>
      <td>Color</td>
      <td>Quentin Tarantino</td>
      <td>215.0</td>
      <td>178.0</td>
      <td>16000.0</td>
      <td>857.0</td>
      <td>Eric Stoltz</td>
      <td>13000.0</td>
      <td>107930000.0</td>
      <td>...</td>
      <td>2195.0</td>
      <td>English</td>
      <td>USA</td>
      <td>R</td>
      <td>8000000.0</td>
      <td>1994.0</td>
      <td>902.0</td>
      <td>8.9</td>
      <td>2.35</td>
      <td>45000</td>
    </tr>
    <tr>
      <th>4395</th>
      <td>Reservoir Dogs</td>
      <td>Color</td>
      <td>Quentin Tarantino</td>
      <td>173.0</td>
      <td>99.0</td>
      <td>16000.0</td>
      <td>455.0</td>
      <td>Steve Buscemi</td>
      <td>16000.0</td>
      <td>2812029.0</td>
      <td>...</td>
      <td>931.0</td>
      <td>English</td>
      <td>USA</td>
      <td>R</td>
      <td>1200000.0</td>
      <td>1992.0</td>
      <td>12000.0</td>
      <td>8.4</td>
      <td>2.35</td>
      <td>19000</td>
    </tr>
  </tbody>
</table>
<p>8 rows × 28 columns</p>
</div>




```python
# 4. James Cameron의 영화중 상영시간이 150분 이상인 영화들의 제목(movie_title), 상영시간(duration), 컬러여부(color) 조회
movie.loc[(movie['director_name']=='James Cameron') &(movie['duration']>=150), ['movie_title', 'duration', 'color']]
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>movie_title</th>
      <th>duration</th>
      <th>color</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Avatar</td>
      <td>178.0</td>
      <td>Color</td>
    </tr>
    <tr>
      <th>26</th>
      <td>Titanic</td>
      <td>194.0</td>
      <td>Color</td>
    </tr>
    <tr>
      <th>285</th>
      <td>Terminator 2: Judgment Day</td>
      <td>153.0</td>
      <td>Color</td>
    </tr>
    <tr>
      <th>599</th>
      <td>The Abyss</td>
      <td>171.0</td>
      <td>Color</td>
    </tr>
    <tr>
      <th>2455</th>
      <td>Aliens</td>
      <td>154.0</td>
      <td>Color</td>
    </tr>
  </tbody>
</table>
</div>



## query() 를 이용한 boolean indexing
- query(조회조건)
    - sql의 where 절의 조건 처럼 문자열의 query statement를 이용해 조건으로 조회
    - boolean index에 비해
        - 장점: 편의성(문자열로 query statement를 만들므로 동적 구문 생성등 다양한 처리가 가능)과 가독성이 좋다.
        - 단점: 속도가 느리다.
- 조회조건 구문
    - `"컬럼명 연산자 비교값"`
- 외부변수를 이용해 query문의 비교값을 지정할 수 있다.
    - query 문자열 안에서 @변수명 사용
    - f string이나 format() 함수를 이용해 query를 만들 수도 있다.

### query 함수 연산자 
- **비교 연산자**
    - ==, \>, \>=, \<, \<=, !=
- **결측치 비교**
    - 컬럼.isna(), isnull()
    - 컬럼.notna(), notnull()       
- **논리 연산자**
    - and, or, not
- **in 연산자**
    - in, ==
    - not in, !=
    - 비교 대상값은 리스트에 넣는다.
- **Index name으로 검색**
    - 행의 index 이름으로 검색
- **문자열 부분검색(sql의 like)**
    - 컬럼명.str.contains(문자열): 문자열을 포함하고 있는 
    - 컬럼명.str.startswith(문자열): 문자열로 시작하는
    - 컬럼명.str.endswith(문자열): 문자열로 끝나는
    - **문자열 부분검색을 할 컬럼에 결측치(NaN)이 있으면 안된다.**


```python
import pandas as pd
import numpy as np
data_dict = {
    'name':['김영수', '박영희', '오준호', '조민경', '박영희', '김영수'],
    'age':[23, 17, 28, 31, 23, 17],
    'email':['kys@gmail.com', 'pyh@gmail.com', 'ojh@daum.net', 'cmk@naver.com', 'pyh@daum.net', np.nan]
}
df = pd.DataFrame(data_dict)
df
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>age</th>
      <th>email</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>김영수</td>
      <td>23</td>
      <td>kys@gmail.com</td>
    </tr>
    <tr>
      <th>1</th>
      <td>박영희</td>
      <td>17</td>
      <td>pyh@gmail.com</td>
    </tr>
    <tr>
      <th>2</th>
      <td>오준호</td>
      <td>28</td>
      <td>ojh@daum.net</td>
    </tr>
    <tr>
      <th>3</th>
      <td>조민경</td>
      <td>31</td>
      <td>cmk@naver.com</td>
    </tr>
    <tr>
      <th>4</th>
      <td>박영희</td>
      <td>23</td>
      <td>pyh@daum.net</td>
    </tr>
    <tr>
      <th>5</th>
      <td>김영수</td>
      <td>17</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>




```python
# 비교연산
# 나이가 17세인 사람
# df[df['age']==17]
df.query('age == 17') # 조회대상데이터프레임.query('컬럼명==비교값')
df.query('age > 25')
df.query('age != 17')
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>age</th>
      <th>email</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>김영수</td>
      <td>23</td>
      <td>kys@gmail.com</td>
    </tr>
    <tr>
      <th>2</th>
      <td>오준호</td>
      <td>28</td>
      <td>ojh@daum.net</td>
    </tr>
    <tr>
      <th>3</th>
      <td>조민경</td>
      <td>31</td>
      <td>cmk@naver.com</td>
    </tr>
    <tr>
      <th>4</th>
      <td>박영희</td>
      <td>23</td>
      <td>pyh@daum.net</td>
    </tr>
  </tbody>
</table>
</div>




```python
# 결측치가 있는 행 조회
df.query("email.isna()") # 대상컬럼.isnull(), isna()
df.query("email.isnull()") # 한 행만 나와도 데이터 프레임으로 반환
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>age</th>
      <th>email</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>5</th>
      <td>김영수</td>
      <td>17</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>




```python
# 결측치가 없는 행 조회
df.query("email.notna()")
df.query("email.notnull()")
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>age</th>
      <th>email</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>김영수</td>
      <td>23</td>
      <td>kys@gmail.com</td>
    </tr>
    <tr>
      <th>1</th>
      <td>박영희</td>
      <td>17</td>
      <td>pyh@gmail.com</td>
    </tr>
    <tr>
      <th>2</th>
      <td>오준호</td>
      <td>28</td>
      <td>ojh@daum.net</td>
    </tr>
    <tr>
      <th>3</th>
      <td>조민경</td>
      <td>31</td>
      <td>cmk@naver.com</td>
    </tr>
    <tr>
      <th>4</th>
      <td>박영희</td>
      <td>23</td>
      <td>pyh@daum.net</td>
    </tr>
  </tbody>
</table>
</div>




```python
# 논리연산 -> and, or, not을 사용가능, (&, |, ~  사용가능)
df.query('not age < 25')
df.query('~(age < 25)')
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>age</th>
      <th>email</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2</th>
      <td>오준호</td>
      <td>28</td>
      <td>ojh@daum.net</td>
    </tr>
    <tr>
      <th>3</th>
      <td>조민경</td>
      <td>31</td>
      <td>cmk@naver.com</td>
    </tr>
  </tbody>
</table>
</div>




```python
df.query('name == "박영희" and age > 20') # 비교값이 문자열(str)일때 따옴표로 묶어준다
df.query('(name == "박영희") & (age > 20)') # query 메소드에서는 기호 바교연산을 할때 ( ) 로 피연산자 안묶어도 된다.
# 그렇지만 연산자를 사용 할 때는 왠만하면 ()로 묶어주자 -> 헷깔림
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>age</th>
      <th>email</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>4</th>
      <td>박영희</td>
      <td>23</td>
      <td>pyh@daum.net</td>
    </tr>
  </tbody>
</table>
</div>




```python
# 나이가 17 이거나 23인 행을 조회
df.query('age==17 or age==23') # 동일한 컬럼으로 여러개의 값과 == 비교
df.query('age==[17, 23]')
df.query('age in [17, 23]')
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>age</th>
      <th>email</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>김영수</td>
      <td>23</td>
      <td>kys@gmail.com</td>
    </tr>
    <tr>
      <th>1</th>
      <td>박영희</td>
      <td>17</td>
      <td>pyh@gmail.com</td>
    </tr>
    <tr>
      <th>4</th>
      <td>박영희</td>
      <td>23</td>
      <td>pyh@daum.net</td>
    </tr>
    <tr>
      <th>5</th>
      <td>김영수</td>
      <td>17</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>




```python
# 나이가 17과 23이 아닌 행을 조회
df.query('age!=17 and age!=23') # 동일한 컬럼으로 여러개의 값과 != 비교
df.query('age!=[17, 23]')
df.query('age not in [17, 23]')
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>age</th>
      <th>email</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2</th>
      <td>오준호</td>
      <td>28</td>
      <td>ojh@daum.net</td>
    </tr>
    <tr>
      <th>3</th>
      <td>조민경</td>
      <td>31</td>
      <td>cmk@naver.com</td>
    </tr>
  </tbody>
</table>
</div>




```python
df
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>age</th>
      <th>email</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>김영수</td>
      <td>23</td>
      <td>kys@gmail.com</td>
    </tr>
    <tr>
      <th>1</th>
      <td>박영희</td>
      <td>17</td>
      <td>pyh@gmail.com</td>
    </tr>
    <tr>
      <th>2</th>
      <td>오준호</td>
      <td>28</td>
      <td>ojh@daum.net</td>
    </tr>
    <tr>
      <th>3</th>
      <td>조민경</td>
      <td>31</td>
      <td>cmk@naver.com</td>
    </tr>
    <tr>
      <th>4</th>
      <td>박영희</td>
      <td>23</td>
      <td>pyh@daum.net</td>
    </tr>
    <tr>
      <th>5</th>
      <td>김영수</td>
      <td>17</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>




```python
# index이름으로 조건 지정
# index 이름이 3인 행 조회
df.query('index == 3') # 한 행만 나와도 데이터 프레임으로 반환
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>age</th>
      <th>email</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>3</th>
      <td>조민경</td>
      <td>31</td>
      <td>cmk@naver.com</td>
    </tr>
  </tbody>
</table>
</div>




```python
df.query('index in [1,3,4]')
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>age</th>
      <th>email</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>박영희</td>
      <td>17</td>
      <td>pyh@gmail.com</td>
    </tr>
    <tr>
      <th>3</th>
      <td>조민경</td>
      <td>31</td>
      <td>cmk@naver.com</td>
    </tr>
    <tr>
      <th>4</th>
      <td>박영희</td>
      <td>23</td>
      <td>pyh@daum.net</td>
    </tr>
  </tbody>
</table>
</div>




```python
# 문자열컬럼값과 부분 일치 조회
# 성이 김씨인 행 조회
df.query("name.str.startswith('김')")  # name 컬럼의 값들 중 "김"으로 시작하는 행
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>age</th>
      <th>email</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>김영수</td>
      <td>23</td>
      <td>kys@gmail.com</td>
    </tr>
    <tr>
      <th>5</th>
      <td>김영수</td>
      <td>17</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>




```python
"abcde".startswith('a')
```




    True




```python
# 이름이 영희 행을 조회
df.query("name.str.endswith('영희')") # name 컬럼의 값들 중 "영희"로 끝나는 행
df.query("name.str.contains('영희')") # name 칼럼의 값들 중 "영희"를 포함한 행
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>age</th>
      <th>email</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>박영희</td>
      <td>17</td>
      <td>pyh@gmail.com</td>
    </tr>
    <tr>
      <th>4</th>
      <td>박영희</td>
      <td>23</td>
      <td>pyh@daum.net</td>
    </tr>
  </tbody>
</table>
</div>




```python
# 이메일주소가 com으로 끝나는 행들
# 문자열 부분일치 조회 -> 결측치가 있는 행은 조회가 안됨(ValueError)
# df.query('email.str.endswith("com")') # ValueError: Cannot mask with non-boolean array containing NA / NaN values

```


```python
# 1. email이 결측치가 아닌행을 조회 -> 2. 조건을 조회
df.query("email.notnull()").query("email.str.endswith('com')") # method chaining: 처리한 것을 바탕으로 또 처리하는 것  (함수 chaining도 있음)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>age</th>
      <th>email</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>김영수</td>
      <td>23</td>
      <td>kys@gmail.com</td>
    </tr>
    <tr>
      <th>1</th>
      <td>박영희</td>
      <td>17</td>
      <td>pyh@gmail.com</td>
    </tr>
    <tr>
      <th>3</th>
      <td>조민경</td>
      <td>31</td>
      <td>cmk@naver.com</td>
    </tr>
  </tbody>
</table>
</div>




```python
df.query('name.str.contains("김") and email.str.endswith("com")')
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>age</th>
      <th>email</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>김영수</td>
      <td>23</td>
      <td>kys@gmail.com</td>
    </tr>
  </tbody>
</table>
</div>




```python
# 외부변수의 값을 이용해서 query statement를 생성.
name = input("조회할 이름:")
# format 문자열
# df.query(f'name == "{name}"')  # name의 값을 따옴표로 감싸줘야함
df.query('name == @name') # name == 변수_name의 값 ==> 문자열일 경우 따옴표 처리를 해준다.
```

    조회할 이름:박영희
    




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>age</th>
      <th>email</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>박영희</td>
      <td>17</td>
      <td>pyh@gmail.com</td>
    </tr>
    <tr>
      <th>4</th>
      <td>박영희</td>
      <td>23</td>
      <td>pyh@daum.net</td>
    </tr>
  </tbody>
</table>
</div>




```python
name = input('조회할 이름:')
age = int(input('조회할 나이:'))  # 숫자형은 숫자(정수, 실수) 타입으로 변환한 뒤 처리.
df.query('name == @name and age > @age') # 정수일 때도 @ 사용 가능
```

    조회할 이름:박영희
    조회할 나이:17
    




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>age</th>
      <th>email</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>4</th>
      <td>박영희</td>
      <td>23</td>
      <td>pyh@daum.net</td>
    </tr>
  </tbody>
</table>
</div>



<b style='font-size:2.2em'>TODO</b>
- movie dataframe을 이용해 query() 메소드를 사용해서 아래 문제를 푸세요. 


```python
# 1. 상영시간이 300분 이상인 영화들만 조회
movie.query('duration>=300')
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>movie_title</th>
      <th>color</th>
      <th>director_name</th>
      <th>num_critic_for_reviews</th>
      <th>duration</th>
      <th>director_facebook_likes</th>
      <th>actor_3_facebook_likes</th>
      <th>actor_2_name</th>
      <th>actor_1_facebook_likes</th>
      <th>gross</th>
      <th>...</th>
      <th>num_user_for_reviews</th>
      <th>language</th>
      <th>country</th>
      <th>content_rating</th>
      <th>budget</th>
      <th>title_year</th>
      <th>actor_2_facebook_likes</th>
      <th>imdb_score</th>
      <th>aspect_ratio</th>
      <th>movie_facebook_likes</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1134</th>
      <td>Heaven's Gate</td>
      <td>Color</td>
      <td>Michael Cimino</td>
      <td>102.0</td>
      <td>325.0</td>
      <td>517.0</td>
      <td>678.0</td>
      <td>Sam Waterston</td>
      <td>12000.0</td>
      <td>1500000.0</td>
      <td>...</td>
      <td>189.0</td>
      <td>English</td>
      <td>USA</td>
      <td>R</td>
      <td>44000000.0</td>
      <td>1980.0</td>
      <td>849.0</td>
      <td>6.8</td>
      <td>2.35</td>
      <td>1000</td>
    </tr>
    <tr>
      <th>1487</th>
      <td>Blood In, Blood Out</td>
      <td>Color</td>
      <td>Taylor Hackford</td>
      <td>12.0</td>
      <td>330.0</td>
      <td>138.0</td>
      <td>672.0</td>
      <td>Jesse Borrego</td>
      <td>848.0</td>
      <td>4496583.0</td>
      <td>...</td>
      <td>129.0</td>
      <td>English</td>
      <td>USA</td>
      <td>R</td>
      <td>35000000.0</td>
      <td>1993.0</td>
      <td>674.0</td>
      <td>8.0</td>
      <td>1.66</td>
      <td>6000</td>
    </tr>
    <tr>
      <th>1694</th>
      <td>Trapped</td>
      <td>Color</td>
      <td>NaN</td>
      <td>16.0</td>
      <td>511.0</td>
      <td>NaN</td>
      <td>51.0</td>
      <td>Ingvar Eggert Sigurðsson</td>
      <td>147.0</td>
      <td>NaN</td>
      <td>...</td>
      <td>19.0</td>
      <td>Icelandic</td>
      <td>Iceland</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>63.0</td>
      <td>8.2</td>
      <td>16.00</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2436</th>
      <td>Carlos</td>
      <td>Color</td>
      <td>NaN</td>
      <td>108.0</td>
      <td>334.0</td>
      <td>NaN</td>
      <td>30.0</td>
      <td>Nora von Waldstätten</td>
      <td>897.0</td>
      <td>145118.0</td>
      <td>...</td>
      <td>36.0</td>
      <td>English</td>
      <td>France</td>
      <td>Not Rated</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>30.0</td>
      <td>7.7</td>
      <td>2.35</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3254</th>
      <td>The Legend of Suriyothai</td>
      <td>Color</td>
      <td>Chatrichalerm Yukol</td>
      <td>31.0</td>
      <td>300.0</td>
      <td>6.0</td>
      <td>6.0</td>
      <td>Chatchai Plengpanich</td>
      <td>7.0</td>
      <td>454255.0</td>
      <td>...</td>
      <td>47.0</td>
      <td>Thai</td>
      <td>Thailand</td>
      <td>R</td>
      <td>400000000.0</td>
      <td>2001.0</td>
      <td>6.0</td>
      <td>6.6</td>
      <td>1.85</td>
      <td>124</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 28 columns</p>
</div>




```python
# 2. 상영시간이 250분 ~ 300분 인 영화들 조회
movie.query('duration<=300 and duration>=250')
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>movie_title</th>
      <th>color</th>
      <th>director_name</th>
      <th>num_critic_for_reviews</th>
      <th>duration</th>
      <th>director_facebook_likes</th>
      <th>actor_3_facebook_likes</th>
      <th>actor_2_name</th>
      <th>actor_1_facebook_likes</th>
      <th>gross</th>
      <th>...</th>
      <th>num_user_for_reviews</th>
      <th>language</th>
      <th>country</th>
      <th>content_rating</th>
      <th>budget</th>
      <th>title_year</th>
      <th>actor_2_facebook_likes</th>
      <th>imdb_score</th>
      <th>aspect_ratio</th>
      <th>movie_facebook_likes</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>874</th>
      <td>Gods and Generals</td>
      <td>Color</td>
      <td>Ron Maxwell</td>
      <td>84.0</td>
      <td>280.0</td>
      <td>33.0</td>
      <td>67.0</td>
      <td>Bruce Boxleitner</td>
      <td>789.0</td>
      <td>12870569.0</td>
      <td>...</td>
      <td>497.0</td>
      <td>English</td>
      <td>USA</td>
      <td>PG-13</td>
      <td>56000000.0</td>
      <td>2003.0</td>
      <td>640.0</td>
      <td>6.3</td>
      <td>2.35</td>
      <td>953</td>
    </tr>
    <tr>
      <th>1150</th>
      <td>Cleopatra</td>
      <td>Color</td>
      <td>Joseph L. Mankiewicz</td>
      <td>72.0</td>
      <td>251.0</td>
      <td>311.0</td>
      <td>595.0</td>
      <td>Richard Burton</td>
      <td>940.0</td>
      <td>57750000.0</td>
      <td>...</td>
      <td>192.0</td>
      <td>English</td>
      <td>UK</td>
      <td>Approved</td>
      <td>31115000.0</td>
      <td>1963.0</td>
      <td>726.0</td>
      <td>7.0</td>
      <td>2.20</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1556</th>
      <td>Apocalypse Now</td>
      <td>Color</td>
      <td>Francis Ford Coppola</td>
      <td>261.0</td>
      <td>289.0</td>
      <td>0.0</td>
      <td>3000.0</td>
      <td>Marlon Brando</td>
      <td>11000.0</td>
      <td>78800000.0</td>
      <td>...</td>
      <td>983.0</td>
      <td>English</td>
      <td>USA</td>
      <td>R</td>
      <td>31500000.0</td>
      <td>1979.0</td>
      <td>10000.0</td>
      <td>8.5</td>
      <td>2.35</td>
      <td>19000</td>
    </tr>
    <tr>
      <th>1698</th>
      <td>Once Upon a Time in America</td>
      <td>Color</td>
      <td>Sergio Leone</td>
      <td>111.0</td>
      <td>251.0</td>
      <td>0.0</td>
      <td>642.0</td>
      <td>Burt Young</td>
      <td>22000.0</td>
      <td>5300000.0</td>
      <td>...</td>
      <td>495.0</td>
      <td>English</td>
      <td>Italy</td>
      <td>R</td>
      <td>30000000.0</td>
      <td>1984.0</td>
      <td>683.0</td>
      <td>8.4</td>
      <td>1.85</td>
      <td>12000</td>
    </tr>
    <tr>
      <th>1963</th>
      <td>Gettysburg</td>
      <td>Color</td>
      <td>Ron Maxwell</td>
      <td>22.0</td>
      <td>271.0</td>
      <td>33.0</td>
      <td>251.0</td>
      <td>William Morgan Sheppard</td>
      <td>854.0</td>
      <td>10769960.0</td>
      <td>...</td>
      <td>256.0</td>
      <td>English</td>
      <td>USA</td>
      <td>PG</td>
      <td>25000000.0</td>
      <td>1993.0</td>
      <td>702.0</td>
      <td>7.7</td>
      <td>1.85</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2527</th>
      <td>Arn: The Knight Templar</td>
      <td>Color</td>
      <td>Peter Flinth</td>
      <td>34.0</td>
      <td>270.0</td>
      <td>5.0</td>
      <td>292.0</td>
      <td>Michael Nyqvist</td>
      <td>908.0</td>
      <td>NaN</td>
      <td>...</td>
      <td>54.0</td>
      <td>Swedish</td>
      <td>Sweden</td>
      <td>NaN</td>
      <td>25000000.0</td>
      <td>2007.0</td>
      <td>690.0</td>
      <td>6.6</td>
      <td>2.35</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2687</th>
      <td>The Company</td>
      <td>Color</td>
      <td>NaN</td>
      <td>9.0</td>
      <td>286.0</td>
      <td>NaN</td>
      <td>527.0</td>
      <td>Tom Hollander</td>
      <td>857.0</td>
      <td>NaN</td>
      <td>...</td>
      <td>39.0</td>
      <td>English</td>
      <td>USA</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>555.0</td>
      <td>7.9</td>
      <td>1.78</td>
      <td>733</td>
    </tr>
    <tr>
      <th>2922</th>
      <td>Das Boot</td>
      <td>Color</td>
      <td>Wolfgang Petersen</td>
      <td>96.0</td>
      <td>293.0</td>
      <td>249.0</td>
      <td>18.0</td>
      <td>Martin Semmelrogge</td>
      <td>362.0</td>
      <td>11433134.0</td>
      <td>...</td>
      <td>426.0</td>
      <td>German</td>
      <td>West Germany</td>
      <td>R</td>
      <td>14000000.0</td>
      <td>1981.0</td>
      <td>21.0</td>
      <td>8.4</td>
      <td>1.85</td>
      <td>11000</td>
    </tr>
    <tr>
      <th>3254</th>
      <td>The Legend of Suriyothai</td>
      <td>Color</td>
      <td>Chatrichalerm Yukol</td>
      <td>31.0</td>
      <td>300.0</td>
      <td>6.0</td>
      <td>6.0</td>
      <td>Chatchai Plengpanich</td>
      <td>7.0</td>
      <td>454255.0</td>
      <td>...</td>
      <td>47.0</td>
      <td>Thai</td>
      <td>Thailand</td>
      <td>R</td>
      <td>400000000.0</td>
      <td>2001.0</td>
      <td>6.0</td>
      <td>6.6</td>
      <td>1.85</td>
      <td>124</td>
    </tr>
  </tbody>
</table>
<p>9 rows × 28 columns</p>
</div>




```python
# 3. 컬러영화가 아닌 영화 조회
movie.query('color!="Color"')
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>movie_title</th>
      <th>color</th>
      <th>director_name</th>
      <th>num_critic_for_reviews</th>
      <th>duration</th>
      <th>director_facebook_likes</th>
      <th>actor_3_facebook_likes</th>
      <th>actor_2_name</th>
      <th>actor_1_facebook_likes</th>
      <th>gross</th>
      <th>...</th>
      <th>num_user_for_reviews</th>
      <th>language</th>
      <th>country</th>
      <th>content_rating</th>
      <th>budget</th>
      <th>title_year</th>
      <th>actor_2_facebook_likes</th>
      <th>imdb_score</th>
      <th>aspect_ratio</th>
      <th>movie_facebook_likes</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>4</th>
      <td>Star Wars: Episode VII - The Force Awakens</td>
      <td>NaN</td>
      <td>Doug Walker</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>131.0</td>
      <td>NaN</td>
      <td>Rob Walker</td>
      <td>131.0</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>12.0</td>
      <td>7.1</td>
      <td>NaN</td>
      <td>0</td>
    </tr>
    <tr>
      <th>111</th>
      <td>Pearl Harbor</td>
      <td>Black and White</td>
      <td>Michael Bay</td>
      <td>191.0</td>
      <td>184.0</td>
      <td>0.0</td>
      <td>691.0</td>
      <td>Jaime King</td>
      <td>3000.0</td>
      <td>198539855.0</td>
      <td>...</td>
      <td>1999.0</td>
      <td>English</td>
      <td>USA</td>
      <td>PG-13</td>
      <td>140000000.0</td>
      <td>2001.0</td>
      <td>961.0</td>
      <td>6.1</td>
      <td>2.35</td>
      <td>0</td>
    </tr>
    <tr>
      <th>148</th>
      <td>Die Another Day</td>
      <td>Black and White</td>
      <td>Lee Tamahori</td>
      <td>264.0</td>
      <td>133.0</td>
      <td>93.0</td>
      <td>746.0</td>
      <td>Colin Salmon</td>
      <td>769.0</td>
      <td>160201106.0</td>
      <td>...</td>
      <td>1185.0</td>
      <td>English</td>
      <td>UK</td>
      <td>PG-13</td>
      <td>142000000.0</td>
      <td>2002.0</td>
      <td>766.0</td>
      <td>6.1</td>
      <td>2.35</td>
      <td>0</td>
    </tr>
    <tr>
      <th>254</th>
      <td>The Aviator</td>
      <td>Black and White</td>
      <td>Martin Scorsese</td>
      <td>267.0</td>
      <td>170.0</td>
      <td>17000.0</td>
      <td>827.0</td>
      <td>Adam Scott</td>
      <td>29000.0</td>
      <td>102608827.0</td>
      <td>...</td>
      <td>799.0</td>
      <td>English</td>
      <td>USA</td>
      <td>PG-13</td>
      <td>110000000.0</td>
      <td>2004.0</td>
      <td>3000.0</td>
      <td>7.5</td>
      <td>2.35</td>
      <td>0</td>
    </tr>
    <tr>
      <th>269</th>
      <td>Ali</td>
      <td>Black and White</td>
      <td>Michael Mann</td>
      <td>174.0</td>
      <td>165.0</td>
      <td>0.0</td>
      <td>780.0</td>
      <td>Jada Pinkett Smith</td>
      <td>10000.0</td>
      <td>58183966.0</td>
      <td>...</td>
      <td>386.0</td>
      <td>English</td>
      <td>USA</td>
      <td>R</td>
      <td>107000000.0</td>
      <td>2001.0</td>
      <td>851.0</td>
      <td>6.8</td>
      <td>2.35</td>
      <td>0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>4882</th>
      <td>Clerks</td>
      <td>Black and White</td>
      <td>Kevin Smith</td>
      <td>136.0</td>
      <td>102.0</td>
      <td>0.0</td>
      <td>216.0</td>
      <td>Brian O'Halloran</td>
      <td>898.0</td>
      <td>3151130.0</td>
      <td>...</td>
      <td>615.0</td>
      <td>English</td>
      <td>USA</td>
      <td>R</td>
      <td>230000.0</td>
      <td>1994.0</td>
      <td>657.0</td>
      <td>7.8</td>
      <td>1.37</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4888</th>
      <td>Slacker</td>
      <td>Black and White</td>
      <td>Richard Linklater</td>
      <td>61.0</td>
      <td>100.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>Richard Linklater</td>
      <td>5.0</td>
      <td>1227508.0</td>
      <td>...</td>
      <td>80.0</td>
      <td>English</td>
      <td>USA</td>
      <td>R</td>
      <td>23000.0</td>
      <td>1991.0</td>
      <td>0.0</td>
      <td>7.1</td>
      <td>1.37</td>
      <td>2000</td>
    </tr>
    <tr>
      <th>4893</th>
      <td>The Ridges</td>
      <td>NaN</td>
      <td>Brandon Landers</td>
      <td>NaN</td>
      <td>143.0</td>
      <td>8.0</td>
      <td>8.0</td>
      <td>Alana Kaniewski</td>
      <td>720.0</td>
      <td>NaN</td>
      <td>...</td>
      <td>8.0</td>
      <td>English</td>
      <td>USA</td>
      <td>NaN</td>
      <td>17350.0</td>
      <td>2011.0</td>
      <td>19.0</td>
      <td>3.0</td>
      <td>NaN</td>
      <td>33</td>
    </tr>
    <tr>
      <th>4895</th>
      <td>Stories of Our Lives</td>
      <td>Black and White</td>
      <td>Jim Chuchu</td>
      <td>6.0</td>
      <td>60.0</td>
      <td>0.0</td>
      <td>4.0</td>
      <td>Olwenya Maina</td>
      <td>147.0</td>
      <td>NaN</td>
      <td>...</td>
      <td>1.0</td>
      <td>Swahili</td>
      <td>Kenya</td>
      <td>NaN</td>
      <td>15000.0</td>
      <td>2014.0</td>
      <td>19.0</td>
      <td>7.4</td>
      <td>NaN</td>
      <td>45</td>
    </tr>
    <tr>
      <th>4901</th>
      <td>Tin Can Man</td>
      <td>Black and White</td>
      <td>Ivan Kavanagh</td>
      <td>12.0</td>
      <td>83.0</td>
      <td>18.0</td>
      <td>0.0</td>
      <td>Michael Parle</td>
      <td>10.0</td>
      <td>NaN</td>
      <td>...</td>
      <td>1.0</td>
      <td>English</td>
      <td>Ireland</td>
      <td>NaN</td>
      <td>10000.0</td>
      <td>2007.0</td>
      <td>5.0</td>
      <td>6.7</td>
      <td>1.33</td>
      <td>105</td>
    </tr>
  </tbody>
</table>
<p>223 rows × 28 columns</p>
</div>




```python
# 4. 이름에 James가 들어가는 감독의 영화조회

movie.query('director_name.notnull()').query('director_name.str.contains("James")')
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>movie_title</th>
      <th>color</th>
      <th>director_name</th>
      <th>num_critic_for_reviews</th>
      <th>duration</th>
      <th>director_facebook_likes</th>
      <th>actor_3_facebook_likes</th>
      <th>actor_2_name</th>
      <th>actor_1_facebook_likes</th>
      <th>gross</th>
      <th>...</th>
      <th>num_user_for_reviews</th>
      <th>language</th>
      <th>country</th>
      <th>content_rating</th>
      <th>budget</th>
      <th>title_year</th>
      <th>actor_2_facebook_likes</th>
      <th>imdb_score</th>
      <th>aspect_ratio</th>
      <th>movie_facebook_likes</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Avatar</td>
      <td>Color</td>
      <td>James Cameron</td>
      <td>723.0</td>
      <td>178.0</td>
      <td>0.0</td>
      <td>855.0</td>
      <td>Joel David Moore</td>
      <td>1000.0</td>
      <td>760505847.0</td>
      <td>...</td>
      <td>3054.0</td>
      <td>English</td>
      <td>USA</td>
      <td>PG-13</td>
      <td>237000000.0</td>
      <td>2009.0</td>
      <td>936.0</td>
      <td>7.9</td>
      <td>1.78</td>
      <td>33000</td>
    </tr>
    <tr>
      <th>26</th>
      <td>Titanic</td>
      <td>Color</td>
      <td>James Cameron</td>
      <td>315.0</td>
      <td>194.0</td>
      <td>0.0</td>
      <td>794.0</td>
      <td>Kate Winslet</td>
      <td>29000.0</td>
      <td>658672302.0</td>
      <td>...</td>
      <td>2528.0</td>
      <td>English</td>
      <td>USA</td>
      <td>PG-13</td>
      <td>200000000.0</td>
      <td>1997.0</td>
      <td>14000.0</td>
      <td>7.7</td>
      <td>2.35</td>
      <td>26000</td>
    </tr>
    <tr>
      <th>45</th>
      <td>Furious 7</td>
      <td>Color</td>
      <td>James Wan</td>
      <td>424.0</td>
      <td>140.0</td>
      <td>0.0</td>
      <td>14000.0</td>
      <td>Paul Walker</td>
      <td>26000.0</td>
      <td>350034110.0</td>
      <td>...</td>
      <td>657.0</td>
      <td>English</td>
      <td>USA</td>
      <td>PG-13</td>
      <td>190000000.0</td>
      <td>2015.0</td>
      <td>23000.0</td>
      <td>7.2</td>
      <td>2.35</td>
      <td>94000</td>
    </tr>
    <tr>
      <th>95</th>
      <td>Guardians of the Galaxy</td>
      <td>Color</td>
      <td>James Gunn</td>
      <td>653.0</td>
      <td>121.0</td>
      <td>571.0</td>
      <td>3000.0</td>
      <td>Vin Diesel</td>
      <td>14000.0</td>
      <td>333130696.0</td>
      <td>...</td>
      <td>1097.0</td>
      <td>English</td>
      <td>USA</td>
      <td>PG-13</td>
      <td>170000000.0</td>
      <td>2014.0</td>
      <td>14000.0</td>
      <td>8.1</td>
      <td>2.35</td>
      <td>96000</td>
    </tr>
    <tr>
      <th>106</th>
      <td>Alice Through the Looking Glass</td>
      <td>Color</td>
      <td>James Bobin</td>
      <td>218.0</td>
      <td>113.0</td>
      <td>33.0</td>
      <td>11000.0</td>
      <td>Alan Rickman</td>
      <td>40000.0</td>
      <td>76846624.0</td>
      <td>...</td>
      <td>131.0</td>
      <td>English</td>
      <td>USA</td>
      <td>PG</td>
      <td>170000000.0</td>
      <td>2016.0</td>
      <td>25000.0</td>
      <td>6.4</td>
      <td>1.85</td>
      <td>30000</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>4539</th>
      <td>Bambi</td>
      <td>Color</td>
      <td>James Algar</td>
      <td>116.0</td>
      <td>70.0</td>
      <td>11.0</td>
      <td>8.0</td>
      <td>Donnie Dunagan</td>
      <td>16.0</td>
      <td>102797150.0</td>
      <td>...</td>
      <td>136.0</td>
      <td>English</td>
      <td>USA</td>
      <td>Approved</td>
      <td>NaN</td>
      <td>1942.0</td>
      <td>12.0</td>
      <td>7.4</td>
      <td>1.33</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4578</th>
      <td>Hoop Dreams</td>
      <td>Color</td>
      <td>Steve James</td>
      <td>53.0</td>
      <td>170.0</td>
      <td>23.0</td>
      <td>2.0</td>
      <td>Arthur Agee</td>
      <td>7.0</td>
      <td>7830611.0</td>
      <td>...</td>
      <td>74.0</td>
      <td>English</td>
      <td>USA</td>
      <td>PG-13</td>
      <td>700000.0</td>
      <td>1994.0</td>
      <td>6.0</td>
      <td>8.3</td>
      <td>1.33</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4771</th>
      <td>Western Religion</td>
      <td>Color</td>
      <td>James O'Brien</td>
      <td>5.0</td>
      <td>105.0</td>
      <td>7.0</td>
      <td>494.0</td>
      <td>Vivian Lamolli</td>
      <td>814.0</td>
      <td>NaN</td>
      <td>...</td>
      <td>4.0</td>
      <td>English</td>
      <td>USA</td>
      <td>NaN</td>
      <td>250000.0</td>
      <td>2015.0</td>
      <td>755.0</td>
      <td>4.0</td>
      <td>NaN</td>
      <td>244</td>
    </tr>
    <tr>
      <th>4797</th>
      <td>Yesterday Was a Lie</td>
      <td>Black and White</td>
      <td>James Kerwin</td>
      <td>25.0</td>
      <td>89.0</td>
      <td>0.0</td>
      <td>31.0</td>
      <td>Chase Masterson</td>
      <td>236.0</td>
      <td>NaN</td>
      <td>...</td>
      <td>10.0</td>
      <td>English</td>
      <td>USA</td>
      <td>PG</td>
      <td>2500000.0</td>
      <td>2008.0</td>
      <td>189.0</td>
      <td>5.4</td>
      <td>1.78</td>
      <td>83</td>
    </tr>
    <tr>
      <th>4883</th>
      <td>Pink Narcissus</td>
      <td>Color</td>
      <td>James Bidgood</td>
      <td>8.0</td>
      <td>65.0</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>Bobby Kendall</td>
      <td>0.0</td>
      <td>8231.0</td>
      <td>...</td>
      <td>16.0</td>
      <td>English</td>
      <td>USA</td>
      <td>Not Rated</td>
      <td>27000.0</td>
      <td>1971.0</td>
      <td>0.0</td>
      <td>6.7</td>
      <td>1.37</td>
      <td>85</td>
    </tr>
  </tbody>
</table>
<p>89 rows × 28 columns</p>
</div>


