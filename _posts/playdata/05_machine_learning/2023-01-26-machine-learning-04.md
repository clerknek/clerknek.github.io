---
title: '[Machine Learning] 04. 데이터 전처리'
date: 23-01-26 15:45:23 +0800
categories: ['Data Analysis', '05. Machine Learning']
tags: [python, machinelearning, preprocessing]     # TAG names should always be lowercase
---

## Data Preprocessing
- 데이터를 가지고 머신러닝을 진행하기 위해서는 좋은 데이터를 가지고 해야 결과값이 잘 나온다.
    - Garbage in, Garbage out
- 비정형 데이터의 경우에는 데이터 구조가 정해져 있지 않기 때문에 오랫동안 발전을 못하다가 딥러닝이 발달되면서 발전이 되기 시작했다.
- 목적
    1. 학습이 가능한 데이터셋을 만들기 위한 전처리
        - 머신러닝 알고리즘은 숫자만 처리할 수 있다.
        - 따라서 결측치, 문자열이 있으면 학습이나 추론을 할 수 없다.
        
    2. 학습이 더 잘되도록 만들기 위한 전처리
        - 공학적 전처리 (Feature Engineering)
        - 도메인 지식에 의한 전처리
            - 쓸데없는 데이터가 많으면 예측 결과 이상해질 수 있다.
## 결측치 처리
- 결측치란
    - Not Available-NA, NaN, None, Null
    - 수집하지 못한 값, 모르는 값
- 처리 방법
    1. 제거 (열단위, 행단위)
        - 행단위를 기본으로 제거한다.
        - 다만 특정 열에 결측치가 너무 많을 경우 열을 제거한다.
        - 문제점
            - 너무 많은 데이터 값이 없어질 수 있다는 문제가 있다.
            - 하나의 결측치를 없애기 위해 행이나 열에 있는 모든 값을 없애야 한다.
    2. 다른 값으로 대체
        - 가장 가능성이 높은 값으로 대체
            - 수치형: 평균, 중앙값
            - 범주형: 최빈값
            - 그 Feature의 결측치를 예측하는 머신러닝 알고리즘을 모델링해서 추론
                - 다른 컬럼 값을 바탕으로 예측
        - 결측치 자체를 표현하는 값으로 대체
            - 나이 : -1, 혈액형 : ? 과 같이 그 Feature가 가질 수 없는 값으로 결측치 값을 변환
        - 문제점
            - 대체한다는 것은 다른 값을 집어넣는 것이기 때문에 잘못된 결과가 나올 수 있다.
                - 결측치 제거를 둘 다 할 수 있는 경우에는 제거를 사용하는 편이 좋다.

## 이상치(Outlier) 처리
- 이상치란
    - Feature를 가지는 대부분의 값들과는 동떨어진 값
- 오류값
    - 잘못 수집된 값
    - 처리 방법
        - 결측치로 변환후 처리
- 극단치(분포에서 벗어난 값)
    - 정상적인 값이지만 다른 값들과 다른 패턴을 가지는 값
    - 일반적으로 극단적으로 크거나 작은 값
    - 처리 방법
        1. 값을 그대로 유지
            - 데이터 양이 많기 때문에 영향을 별로 주지 않다고 판단할 경우
            - 나중에 그 값과 비슷한 경우를 예측해야 될 수 있다고 생각할 경우
        2. 결측치로 변환 후 처리
            - 너무 범위를 극단적으로 벗어났다고 판단 될 경우 
        3. 다른 값으로 대체
            - 보통 그 값이 가질 수 있는 Min/Max 값을 설정한 후 그 값으로 변경
            - 분위수를 통해 계산해서 정상적인 범위를 구한 후 그 범위의 Min/Max로 변경

## Feature 타입 별 전처리
### Feature(변수)의 타입
- **범주형(Categorical) 변수/이산형(Discrete) 변수**
    - 대상 값들이 서로 떨어진 값을 가지는 변수
    - 주로 `문자열`, `정수형`, `Categorical type`으로 구성
    - **명목(Norminal) 변수/비서열(Unordered) 변수**
        - 범주에 속한 값 간에 서열(순위)가 없는 변수
        - 예) 성별, 혈액형
    - **순위(Ordinal) 변수/서열(Ordered) 변수**
        - 범주에 속한 값 간에 서열(순위)가 있는 변수
        - 예) 성적, 직급
- **연속형(Continuous) 변수**
    - 대상값들이 서로 연속된 값을 가지는 변수 
    - 주로 `실수형`으로 구성
    - **등간(Interval) 변수**
        - 측정 대상의 순서와 측정 대상 간의 간격을 알 수 있는 변수로, 그 사이의 간격이 같은 변수를 말한다.
        - 0의 값이 특정의미로 사용된다.
        - 예) 온도 : 온도에서 0은 절대적 0의 값이 아니라 얼음이 어는 빙결점의 온도를 의미한다. 
    - **비율(Ratio) 변수**
        - 측정 대상의 순서와 측정 대상 간의 간격을 알 수 있는 변수로, 그 사이의 간격이 같은 변수를 말한다. (등간변수와 동일)
        - 0이 절대적인 0의 값으로 사용된다.
        - 예) 나이, 무게, 거리, 소득

> - 실수형 데이터로 구성된 Feature는 연속형 값이다.
> - 문자열 데이터로 구성된 Feature는 단순 문자열값이거나 범주형 값이다.
> - 정수형 데이터로 구성된 Feature는 범주형이거나 연속형 값이다.
>     - 몇개의 고유값으로 구성되었는지를 봐야 한다.
    

