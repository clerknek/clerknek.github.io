---
title: '[OpenCV] 03. 도형그리기 & 이미지 이동'
date: 23-02-15 12:02:14 +0800
categories: ['Data Analysis', '06. OpenCV']
tags: [python, opencv]     # TAG names should always be lowercase
---

## 도형그리기
- 각 함수들은 원본 이미지에 도형을 그린다.
- cv2.line(img, pt1, pt2, color, tickness=None, lineType=None, shift):img
    - 선그리기
    - 매개변수
        - img: 그릴 대상 이미지
        - pt1, pt2: 직선의 시작/끝점. 각각 튜플(x, y)
        - color: 선색 또는 밝기 (B,G,R) 튜플 또는 정수
        - thickness: 선 두께. 기본값=1 (픽셀)
        - lineType: 선 타입. cv2.LINE_4, cv2.LINE_8(기본값), cv2.LINE_AA(부드러운 형태) 중 선택. 일직선이 아니면 LINE_AA를 준다.
    - 반환값
       - 선을 그린 image (ndarray) 반환 (모든 도형함수 동일)

- cv2.rectangle(img, pt1, pt2, color, thickness=None, lineType=None):img
- cv2.rectangle(img, rec, color, thickness=None, lineType=None):img
    - 사각형 그리기
    - 매개변수
        - pt1, pt2: 좌측상단, 우측하단 좌표. 튜플 (x, y)
        - rec: 사각형의 위치정보(x, y, w, h) 튜플지정.
        - thickness: 도형에서는 -1을 주면 내부를 채운다. 


- cv2.circle(img, center, radius, color, thickness=None, lineStyle=None): img
    - 원 그리기. 원의 lineType은 LINE_AA (안티 알리애싱)을 주면 부드럽게 그려진다. 
    - 매개변수
        - center: 원의 중심좌표. 튜플 (x,y)
        - radius: 반지름

- CV2.polylines(img, pts, isClosed, color, thinkness=None, lineType=None): img
    - 다각형을 그린다.
    - 매개변수
        - pts: 다각형의 외곽점들의 좌표배열. ndarray 리스트 (ex: \[np.array[[10,10],[50,50], [10,10]])\] => 리스트로 감싸서 넣는다.
        - isClosed: bool. 폐곡선 여부. 시작점과 끝점을 연결할지 여부.

- cv2.putText(img, text, org, fontFace, fontScale, color, thickness=None, lineType=None): img
    - 문자열을 출력. 영문/숫자만 지원(한글 지원안함.)
    - 매개변수
        - text: 출력할 문자열
        - org: 이미지에서 문자열을 출력할 위치. 좌측 하단의 좌표를 튜플로 지정 (x,y)
        - fontFace: 폰트 종류. cv2.FONT_HERSHEY_ 로 시작하는 상수 중 선택
        - fontScale: 폰트 크기 확대/축소 비율. 1이 기본. 1을 기준으로 정한다.
    
## 한글 출력하는 방법
- PIL 라이브러리 사용 -> `pip install pillow`
- 예시
    ```python
    # 한글출력 -> PIL 라이브러리 - pip install pillow
    from PIL import ImageFont, ImageDraw, Image

    font_path = 'C:\\Windows\\Fonts\\malgunsl.ttf'
    font = ImageFont.truetype(font_path, 20) # 폰트 파일 경로, 폰트 크기(default: 10)

    img = np.full((400, 400, 3), fill_value = 255, dtype = 'uint8')
    # ndarray => PIL의 Image 객체로 변환
    img_pil = Image.fromarray(img)
    # Image 객체 그리는 기능 제공하는 객체 - ImageDraw생성
    draw = ImageDraw.Draw(img_pil)

    txt= '안녕하세요. Hello World123'

    draw.text((60, 70), # 시작좌표
            txt,     # text
            fill=(255, 0, 0), # fill=색(RGB)
            font = font # font = font 객체
            )

    img2 = np.array(img_pil) # PIL.Image 객체 -> ndarray
    cv2.imshow('frame', img2[:, :, ::-1])
    cv2.waitKey(0)
    cv2.destroyAllWindows()
    ```

    - 결과
    ![Alt text](../../../assets/img/playdata/06_open_cv/03-01.png)

- 한글 폰트 파일경로 찾는 방법
    ```python
    import matplotlib as mpl
    import matplotlib.font_manager as fm

    font_list = fm.findSystemFonts(fontext='ttf')
    
    malgun_list = [f for f in font_list if "malgun" in f.lower()]
    malgun_list
    ```